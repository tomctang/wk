
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>101 Formulaic Alphas &#8212; Tom Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8dedbda2" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '0alphas-using qstrader有3sources/计算ipynb_case/3_formulaic_alphas';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Tom Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../qc.html">1. Qunat research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb2024.html">2. Notebook 2023-25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb2022.html">3. Notebook &lt;=2022</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/wk" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/0alphas-using qstrader有3sources/计算ipynb_case/3_formulaic_alphas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>101 Formulaic Alphas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-settings">Imports &amp; Settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-section">Cross-section</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series">Time Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-implementation">Pandas Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#most-traded-stocks">500 most-traded stocks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-data">Input Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-alphas">Evaluate Alphas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-001">Alpha 001</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-002">Alpha 002</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-003">Alpha 003</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-004">Alpha 004</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-005">Alpha 005</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-006">Alpha 006</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-007">Alpha 007</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-008">Alpha 008</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-009">Alpha 009</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-010">Alpha 010</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-011">Alpha 011</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-012">Alpha 012</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-013">Alpha 013</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-014">Alpha 014</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-015">Alpha 015</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-016">Alpha 016</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-017">Alpha 017</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-018">Alpha 018</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-019">Alpha 019</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-020">Alpha 020</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-021">Alpha 021</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-022">Alpha 022</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-023">Alpha 023</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-024">Alpha 024</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-025">Alpha 025</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-026">Alpha 026</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-027">Alpha 027</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-028">Alpha 028</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-029">Alpha 029</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-030">Alpha 030</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-031">Alpha 031</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-032">Alpha 032</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-033">Alpha 033</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-034">Alpha 034</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-035">Alpha 035</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-036">Alpha 036</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-037">Alpha 037</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-038">Alpha 038</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-039">Alpha 039</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-040">Alpha 040</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-041">Alpha 041</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-042">Alpha 042</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-043">Alpha 043</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-044">Alpha 044</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-045">Alpha 045</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-046">Alpha 046</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-047">Alpha 047</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-048">Alpha 048</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-049">Alpha 049</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-050">Alpha 050</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-051">Alpha 051</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-052">Alpha 052</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-053">Alpha 053</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-054">Alpha 054</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-055">Alpha 055</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-056">Alpha 056</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-057">Alpha 057</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-058">Alpha 058</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-059">Alpha 059</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-060">Alpha 060</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-061">Alpha 061</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-062">Alpha 062</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-063">Alpha 063</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-064">Alpha 064</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-065">Alpha 065</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-066">Alpha 066</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-067">Alpha 067</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-068">Alpha 068</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-069">Alpha 069</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-070">Alpha 070</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-071">Alpha 071</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-072">Alpha 072</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-073">Alpha 073</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-074">Alpha 074</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-075">Alpha 075</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-076">Alpha 076</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-077">Alpha 077</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-078">Alpha 078</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-079">Alpha 079</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-080">Alpha 080</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-081">Alpha 081</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-082">Alpha 082</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-083">Alpha 083</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-084">Alpha 084</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-085">Alpha 085</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-086">Alpha 086</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-087">Alpha 087</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-088">Alpha 088</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-089">Alpha 089</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-090">Alpha 090</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-091">Alpha 091</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-092">Alpha 092</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-093">Alpha 093</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-094">Alpha 094</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-095">Alpha 095</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-096">Alpha 096</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-097">Alpha 097</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-098">Alpha 098</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-099">Alpha 099</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-100">Alpha 100</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-101">Alpha 101</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#store-results">Store results</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="formulaic-alphas">
<h1>101 Formulaic Alphas<a class="headerlink" href="#formulaic-alphas" title="Link to this heading">#</a></h1>
<p>Based on <a class="reference external" href="https://arxiv.org/pdf/1601.00991.pdf">101 Formulaic Alphas</a>, Zura Kakushadze, arxiv, 2015</p>
<section id="imports-settings">
<h2>Imports &amp; Settings<a class="headerlink" href="#imports-settings" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">mutual_info_regression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">spearmanr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">talib</span><span class="w"> </span><span class="kn">import</span> <span class="n">WMA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<p>The expressions below that define the 101 formulaic alphas contain functions for both time-series and cross-sectional computations.</p>
<section id="cross-section">
<h3>Cross-section<a class="headerlink" href="#cross-section" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>rank(x)</p></td>
<td class="text-left"><p>Cross-sectional rank</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>scale(x, a)</p></td>
<td class="text-left"><p>Rescaled x such that sum(abs(x)) = a (the default is a = 1)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>indneutralize(x, g)</p></td>
<td class="text-left"><p>x cross-sectionally demeaned within groups g (subindustries, industries, etc.)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rank</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cross-sectional percentile rank</span>

<span class="sd">     Args:</span>
<span class="sd">         :param df: tickers in columns, sorted dates in rows.</span>

<span class="sd">     Returns:</span>
<span class="sd">         pd.DataFrame: the ranked values</span>
<span class="sd">     &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scaling time serie.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param k: scaling factor.</span>
<span class="sd">    :return: a pandas DataFrame rescaled df such that sum(abs(df)) = k</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>abs(x), log(x), sign(x), power(x, a) = standard definitions</p></li>
<li><p>same for the operators “+”, “-”, “*”, “/”, “&gt;”, “&lt;”, “==”, “||”, “x ? y : z”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sign</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-series">
<h3>Time Series<a class="headerlink" href="#time-series" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>ts_{O}(x, d)</p></td>
<td class="text-left"><p>Operator O applied to the time-series for the past d days; non-integer number of days d is converted to floor(d)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_lag(x, d)</p></td>
<td class="text-left"><p>Value of x d days ago</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ts_delta(x, d)</p></td>
<td class="text-left"><p>Difference between the value of x today and d days ago</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_weighted_mean(x, d)</p></td>
<td class="text-left"><p>Weighted moving average over the past d days with linearly decaying weights d, d – 1, …, 1 (rescaled to sum up to 1)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ts_sum(x, d)</p></td>
<td class="text-left"><p>Rolling sum over the past d days</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_product(x, d)</p></td>
<td class="text-left"><p>Rolling product over the past d days</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ts_stddev(x, d)</p></td>
<td class="text-left"><p>Moving standard deviation over the past d days</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_rank(x, d)</p></td>
<td class="text-left"><p>Rank over the past d days</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ts_min(x, d)</p></td>
<td class="text-left"><p>Rolling min over the past d days [alias: min(x, d)]</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_max(x, d)</p></td>
<td class="text-left"><p>Rolling max over the past d days [alias: max(x, d)]</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ts_argmax(x, d)</p></td>
<td class="text-left"><p>Day of ts_max(x, d)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_argmin(x, d)</p></td>
<td class="text-left"><p>Day of ts_min(x, d)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ts_correlation(x, y, d)</p></td>
<td class="text-left"><p>Correlation of x and y for the past d days</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ts_covariance(x, y, d)</p></td>
<td class="text-left"><p>Covariance of x and y for the past d days</p></td>
</tr>
</tbody>
</table>
</div>
<section id="pandas-implementation">
<h4>Pandas Implementation<a class="headerlink" href="#pandas-implementation" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_lag</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the lagged values t periods ago.</span>

<span class="sd">    Args:</span>
<span class="sd">        :param df: tickers in columns, sorted dates in rows.</span>
<span class="sd">        :param t: lag</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: the lagged values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_delta</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate difference.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param period: the difference grade.</span>
<span class="sd">    :return: a pandas DataFrame with today’s value minus the value &#39;period&#39; days ago.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_sum</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the rolling ts_sum for the given window size.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): tickers in columns, dates in rows.</span>
<span class="sd">        window      (int): size of rolling window.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: the ts_sum over the last &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_mean</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the rolling mean for the given window size.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): tickers in columns, dates in rows.</span>
<span class="sd">        window      (int): size of rolling window.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: the mean over the last &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_weighted_mean</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear weighted moving average implementation.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param period: the LWMA period</span>
<span class="sd">    :return: a pandas DataFrame with the LWMA.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">WMA</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">period</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling standard deviation.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series min over the past &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">df</span>
            <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
            <span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_rank</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling rank.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series rank over the past window days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">df</span>
            <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_product</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling ts_product.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series ts_product over the past &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">df</span>
            <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_min</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling min.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series min over the past &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_max</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling min.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series max over the past &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_argmax</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate which day ts_max(df, window) occurred on</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: well.. that :)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_argmin</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate which day ts_min(df, window) occurred on</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: well.. that :)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">)</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_corr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling correlations.</span>
<span class="sd">    :param x, y: pandas DataFrames.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series min over the past &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ts_cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function to estimate rolling covariance.</span>
<span class="sd">    :param df: a pandas DataFrame.</span>
<span class="sd">    :param window: the rolling window.</span>
<span class="sd">    :return: a pandas DataFrame with the time-series min over the past &#39;window&#39; days.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h2>
<section id="most-traded-stocks">
<h3>500 most-traded stocks<a class="headerlink" href="#most-traded-stocks" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ohlcv</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;data/top500&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ohlcv</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;ret_01&#39;</span><span class="p">,</span> <span class="s1">&#39;sector&#39;</span><span class="p">,</span> <span class="s1">&#39;ret_fwd&#39;</span><span class="p">]]</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ret_01&#39;</span><span class="p">:</span> <span class="s1">&#39;returns&#39;</span><span class="p">})</span>
        <span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adv20</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">adv20</span><span class="o">=</span><span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)[</span><span class="n">ohlcv</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_rank&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">null_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
MultiIndex: 1255093 entries, (&#39;A&#39;, Timestamp(&#39;2007-01-04 00:00:00&#39;)) to (&#39;ZION&#39;, Timestamp(&#39;2016-12-29 00:00:00&#39;))
Data columns (total 14 columns):
 #   Column       Non-Null Count    Dtype  
---  ------       --------------    -----  
 0   open         1255093 non-null  float64
 1   high         1255093 non-null  float64
 2   low          1255093 non-null  float64
 3   close        1255093 non-null  float64
 4   volume       1255093 non-null  float64
 5   returns      1254593 non-null  float64
 6   sector       1255093 non-null  float64
 7   ret_fwd      1255093 non-null  float64
 8   adv20        0 non-null        float64
 9   open_rank    1255093 non-null  float64
 10  high_rank    1255093 non-null  float64
 11  low_rank     1255093 non-null  float64
 12  close_rank   1255093 non-null  float64
 13  volume_rank  1255093 non-null  float64
dtypes: float64(14)
memory usage: 171.9+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data.to_hdf(&#39;factors.h5&#39;, &#39;data&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="input-data">
<h3>Input Data<a class="headerlink" href="#input-data" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Variable</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>returns</p></td>
<td class="text-left"><p>daily close-to-close returns</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>open, close, high, low, volume</p></td>
<td class="text-left"><p>standard definitions for daily price and volume data</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>vwap</p></td>
<td class="text-left"><p>daily volume-weighted average price</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>cap</p></td>
<td class="text-left"><p>market cap</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>adv{d}</p></td>
<td class="text-left"><p>average daily dollar volume for the past d days</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>IndClass</p></td>
<td class="text-left"><p>a generic placeholder for a binary industry classification such as GICS, BICS, NAICS, SIC, etc., in indneutralize(x, IndClass.level), where level = sector, industry, subindustry, etc. Multiple IndClass in the same alpha need not correspond to the same industry classification.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">o</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">high</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
<span class="n">vwap</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">adv20</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">returns</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="evaluate-alphas">
<h2>Evaluate Alphas<a class="headerlink" href="#evaluate-alphas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;returns&#39;</span><span class="p">,</span> <span class="s1">&#39;ret_fwd&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mi</span><span class="p">,</span><span class="n">ic</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_mutual_info_score</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">returns</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mutual_info_regression</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-001">
<h2>Alpha 001<a class="headerlink" href="#alpha-001" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rank(ts_argmax(power(((returns &lt; 0) ? ts_std(returns, 20) : close), 2.), 5))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha001</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_argmax(power(((returns &lt; 0)</span>
<span class="sd">        ? ts_std(returns, 20)</span>
<span class="sd">        : close), 2.), 5)) -0.5)&quot;&quot;&quot;</span>
    <span class="n">c</span><span class="p">[</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_std</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_argmax</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha001</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 57s, sys: 334 ms, total: 1min 57s
Wall time: 1min 58s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
MultiIndex: 1255093 entries, (&#39;A&#39;, Timestamp(&#39;2007-01-04 00:00:00&#39;)) to (&#39;ZION&#39;, Timestamp(&#39;2016-12-29 00:00:00&#39;))
Data columns (total 3 columns):
 #   Column   Non-Null Count    Dtype  
---  ------   --------------    -----  
 0   returns  1254593 non-null  float64
 1   ret_fwd  1255093 non-null  float64
 2   001      1243849 non-null  float64
dtypes: float64(3)
memory usage: 66.5+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9d3519728b9eb488892a8774d6e871875b82c83ae4f339dd073db9cdb199fd3b.png" src="../../_images/9d3519728b9eb488892a8774d6e871875b82c83ae4f339dd073db9cdb199fd3b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/be02eab291b5d7b806b044f83d9f562867e456bc3d396ecbcca582e26e1e7469.png" src="../../_images/be02eab291b5d7b806b044f83d9f562867e456bc3d396ecbcca582e26e1e7469.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01888595802975246
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-002">
<h2>Alpha 002<a class="headerlink" href="#alpha-002" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">delta</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">rank</span><span class="p">(((</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">)</span> <span class="o">/</span> <span class="nb">open</span><span class="p">)),</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha002</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * ts_corr(rank(ts_delta(log(volume), 2)), rank(((close - open) / open)), 6))&quot;&quot;&quot;</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">rank</span><span class="p">((</span><span class="n">c</span> <span class="o">/</span> <span class="n">o</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">alpha</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha002</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.86 s, sys: 28 ms, total: 3.88 s
Wall time: 3.84 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6474df2c3f6f3b2dce0bb0bcbf13f06cf7abc496cacf908f670d56c99227edb4.png" src="../../_images/6474df2c3f6f3b2dce0bb0bcbf13f06cf7abc496cacf908f670d56c99227edb4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/46ca8a27aa4941dda6fb5329dd5688ac71c655bfd45acf221761852d9ec1e8f4.png" src="../../_images/46ca8a27aa4941dda6fb5329dd5688ac71c655bfd45acf221761852d9ec1e8f4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0012399516229262275
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-003">
<h2>Alpha 003<a class="headerlink" href="#alpha-003" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">correlation</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha003</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * ts_corr(rank(open), rank(volume), 10))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha003</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4.03 s, sys: 112 ms, total: 4.14 s
Wall time: 4.17 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=-</span><span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c282e483eb9ea1dfbe091a87cf8b330755e5632fa79cba350b0b0f285359d405.png" src="../../_images/c282e483eb9ea1dfbe091a87cf8b330755e5632fa79cba350b0b0f285359d405.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/90b1b0b04ffdf536424d6fc8fb50e49e54658d3428f8653aa72901a7f1616feb.png" src="../../_images/90b1b0b04ffdf536424d6fc8fb50e49e54658d3428f8653aa72901a7f1616feb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-004">
<h2>Alpha 004<a class="headerlink" href="#alpha-004" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Ts_Rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">low</span><span class="p">),</span> <span class="mi">9</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha004</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * Ts_Rank(rank(low), 9))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha004</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 3s, sys: 62.4 ms, total: 3min 3s
Wall time: 3min 3s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/93e931ef3b8e5eee8c4c0df936bea851122984a15a2314b9154953b4a7ba7af1.png" src="../../_images/93e931ef3b8e5eee8c4c0df936bea851122984a15a2314b9154953b4a7ba7af1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f4a284eff3d2f8626603ffa68101d519e0fa4a61b98fdec178e93c7f0190133f.png" src="../../_images/f4a284eff3d2f8626603ffa68101d519e0fa4a61b98fdec178e93c7f0190133f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-005">
<h2>Alpha 005<a class="headerlink" href="#alpha-005" title="Link to this heading">#</a></h2>
<p>Very roughly approximating wvap as average of OHLC.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">((</span><span class="nb">open</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rank</span><span class="p">((</span><span class="n">close</span> <span class="o">-</span> <span class="n">vwap</span><span class="p">)))))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha005</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank((open - ts_mean(vwap, 10))) * (-1 * abs(rank((close - vwap)))))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha005</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.21 s, sys: 12 ms, total: 2.22 s
Wall time: 2.18 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1fe5a17938742a4753559b131822aaa96ed17b165d00074ad2d1c3c07deae5ad.png" src="../../_images/1fe5a17938742a4753559b131822aaa96ed17b165d00074ad2d1c3c07deae5ad.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/beb1db7debec90e0e604805409f3dbc0710095f5ce17719b939dee0e6b06f2c2.png" src="../../_images/beb1db7debec90e0e604805409f3dbc0710095f5ce17719b939dee0e6b06f2c2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-006">
<h2>Alpha 006<a class="headerlink" href="#alpha-006" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_corr</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha006</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-ts_corr(open, volume, 10))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha006</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.54 s, sys: 48.2 ms, total: 3.59 s
Wall time: 3.56 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7bea137f64f0411182a735012356c1801f1f0c088ff6dfe31bdb11c6c1ca5440.png" src="../../_images/7bea137f64f0411182a735012356c1801f1f0c088ff6dfe31bdb11c6c1ca5440.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8b646a9c11b77033a6e1431ea089e786146bb528292c1bd13de5dde0dca6d2e1.png" src="../../_images/8b646a9c11b77033a6e1431ea089e786146bb528292c1bd13de5dde0dca6d2e1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0026892751534788317
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-007">
<h2>Alpha 007<a class="headerlink" href="#alpha-007" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(adv20 &lt; volume) 
? ((-1 * ts_rank(abs(ts_delta(close, 7)), 60)) * sign(ts_delta(close, 7))) 
: -1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha007</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(adv20 &lt; volume) </span>
<span class="sd">        ? ((-ts_rank(abs(ts_delta(close, 7)), 60)) * sign(ts_delta(close, 7))) </span>
<span class="sd">        : -1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">delta7</span> <span class="o">=</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_rank</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta7</span><span class="p">),</span> <span class="mi">60</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">delta7</span><span class="p">))</span>
            <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">adv20</span><span class="o">&lt;</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha007</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 1s, sys: 83.5 ms, total: 3min 1s
Wall time: 3min 1s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (log scale)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/63de6df642d884143e2cfe7308d5fbcf8de5831488eb1da4b28d48351b63ae24.png" src="../../_images/63de6df642d884143e2cfe7308d5fbcf8de5831488eb1da4b28d48351b63ae24.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/484ae4f68ca1bcf18adb3af122ddca28239f53fa5eaeb322bc9b8c6c2e68a85d.png" src="../../_images/484ae4f68ca1bcf18adb3af122ddca28239f53fa5eaeb322bc9b8c6c2e68a85d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-008">
<h2>Alpha 008<a class="headerlink" href="#alpha-008" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(((</span><span class="n">ts_sum</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">((</span><span class="n">ts_sum</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span><span class="mi">10</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha008</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-rank(((ts_sum(open, 5) * ts_sum(returns, 5)) - </span>
<span class="sd">        ts_lag((ts_sum(open, 5) * ts_sum(returns, 5)),10)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">rank</span><span class="p">(((</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">-</span>
                       <span class="n">ts_lag</span><span class="p">((</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">10</span><span class="p">))))</span>
           <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha008</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.15 s, sys: 12 ms, total: 2.16 s
Wall time: 2.13 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c9519cad741917d7909b4a46d7d37bc8939e7880540c698e4ee6f3ff51f2c474.png" src="../../_images/c9519cad741917d7909b4a46d7d37bc8939e7880540c698e4ee6f3ff51f2c474.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/52652a3af869f43eed922eec9548a042f3bbb9534f0f23a9aa4aa114252422f1.png" src="../../_images/52652a3af869f43eed922eec9548a042f3bbb9534f0f23a9aa4aa114252422f1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-009">
<h2>Alpha 009<a class="headerlink" href="#alpha-009" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(0 &lt; ts_min(ts_delta(close, 1), 5)) ? ts_delta(close, 1) 
: ((ts_max(ts_delta(close, 1), 5) &lt; 0) 
? ts_delta(close, 1) : (-1 * ts_delta(close, 1)))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha009</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(0 &lt; ts_min(ts_delta(close, 1), 5)) ? ts_delta(close, 1) </span>
<span class="sd">    : ((ts_max(ts_delta(close, 1), 5) &lt; 0) </span>
<span class="sd">    ? ts_delta(close, 1) : (-1 * ts_delta(close, 1)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">close_diff</span> <span class="o">=</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">close_diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">close_diff</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="n">close_diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">close_diff</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span>
                                              <span class="o">-</span><span class="n">close_diff</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">9</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha009</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.01 s, sys: 20.1 ms, total: 2.03 s
Wall time: 2.01 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                                        <span class="n">upper</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3bd9e5b56cd403d05f728396b9c2a2a5eae2120f95092e5f4472793115b175d4.png" src="../../_images/3bd9e5b56cd403d05f728396b9c2a2a5eae2120f95092e5f4472793115b175d4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/433b1351bf73d0de741c3552d0d47c33f994f36cd5ceee574e5214dae8481c34.png" src="../../_images/433b1351bf73d0de741c3552d0d47c33f994f36cd5ceee574e5214dae8481c34.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.02205990873050201
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    0.018886
2    0.001240
3    0.000000
4    0.000000
5    0.000000
6    0.002689
8    0.000000
9    0.022060
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-010">
<h2>Alpha 010<a class="headerlink" href="#alpha-010" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rank(((0 &lt; ts_min(ts_delta(close, 1), 4)) 
? ts_delta(close, 1) 
: ((ts_max(ts_delta(close, 1), 4) &lt; 0)
    ? ts_delta(close, 1) 
    : (-1 * ts_delta(close, 1)))))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha010</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;rank(((0 &lt; ts_min(ts_delta(close, 1), 4)) </span>
<span class="sd">        ? ts_delta(close, 1) </span>
<span class="sd">        : ((ts_max(ts_delta(close, 1), 4) &lt; 0)</span>
<span class="sd">            ? ts_delta(close, 1) </span>
<span class="sd">            : (-1 * ts_delta(close, 1)))))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">close_diff</span> <span class="o">=</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">close_diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">close_diff</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="n">close_diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">close_diff</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
                                              <span class="o">-</span><span class="n">close_diff</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha010</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.67 s, sys: 24.1 ms, total: 2.7 s
Wall time: 2.67 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5e29b38f3529b17ebcac6ce006228c580ef0af01bde2ed1e5eaaa8714caf700f.png" src="../../_images/5e29b38f3529b17ebcac6ce006228c580ef0af01bde2ed1e5eaaa8714caf700f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dfaa22371132b55b348bd36bc1fdfd0d05ff48072f8ef509d596cdddadf88cde.png" src="../../_images/dfaa22371132b55b348bd36bc1fdfd0d05ff48072f8ef509d596cdddadf88cde.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-011">
<h2>Alpha 011<a class="headerlink" href="#alpha-011" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_max</span><span class="p">((</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">close</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_min</span><span class="p">((</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">close</span><span class="p">),</span> <span class="mi">3</span><span class="p">)))</span> <span class="o">*</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha011</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_max((vwap - close), 3)) + </span>
<span class="sd">        rank(ts_min(vwap - close), 3)) * </span>
<span class="sd">        rank(ts_delta(volume, 3))</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="mi">3</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">11</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha011</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.48 s, sys: 64.2 ms, total: 2.55 s
Wall time: 2.49 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7dde24e7a3d3115744349769c5272784e9cbd3b104f880a6394d631746adc093.png" src="../../_images/7dde24e7a3d3115744349769c5272784e9cbd3b104f880a6394d631746adc093.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2a0ab1cc21c255ab588026115da51e50abebbc988644bf58e5a4818e529ede94.png" src="../../_images/2a0ab1cc21c255ab588026115da51e50abebbc988644bf58e5a4818e529ede94.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0032785883763768453
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-012">
<h2>Alpha 012<a class="headerlink" href="#alpha-012" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sign</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha012</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(sign(ts_delta(volume, 1)) * </span>
<span class="sd">            (-1 * ts_delta(close, 1)))</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha012</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.03 s, sys: 8.03 ms, total: 2.04 s
Wall time: 2.03 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                                        <span class="n">upper</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4778e6ba68ec5133f994db22add9fd9a1b43c85c354e3a9499c8588a2b3625e2.png" src="../../_images/4778e6ba68ec5133f994db22add9fd9a1b43c85c354e3a9499c8588a2b3625e2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e64ea3fb422072c86a1f8733b7a0f2c1309ea5d490ff9d335a49148f0d692fdd.png" src="../../_images/e64ea3fb422072c86a1f8733b7a0f2c1309ea5d490ff9d335a49148f0d692fdd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015514105621370788
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-013">
<h2>Alpha 013<a class="headerlink" href="#alpha-013" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_cov</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">close</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha013</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-rank(ts_cov(rank(close), rank(volume), 5))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_cov</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">13</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha013</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.64 s, sys: 48.1 ms, total: 3.69 s
Wall time: 3.64 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/01136553de34a7c052aebf353e7785c8bace1fab378df335f0af75f0d0a3895d.png" src="../../_images/01136553de34a7c052aebf353e7785c8bace1fab378df335f0af75f0d0a3895d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ade35b9f5ce59f2faafd426873ade39914d6ad269d9733f477c5bf4f23b3cd9d.png" src="../../_images/ade35b9f5ce59f2faafd426873ade39914d6ad269d9733f477c5bf4f23b3cd9d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0019222442390711691
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-014">
<h2>Alpha 014<a class="headerlink" href="#alpha-014" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span> <span class="o">*</span> <span class="n">ts_corr</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha014</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    (-rank(ts_delta(returns, 3))) * ts_corr(open, volume, 10))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
                                      <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                                               <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">14</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha014</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.58 s, sys: 36 ms, total: 3.62 s
Wall time: 3.58 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2c40c950c5d1acd47b9b47a5e9458218067c5b858b5d611dac4b31619ebe9b80.png" src="../../_images/2c40c950c5d1acd47b9b47a5e9458218067c5b858b5d611dac4b31619ebe9b80.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8fab178969990e1b0d0a9b3ed6562bcd785dfbd7cd74f04de636857b8f1b01fb.png" src="../../_images/8fab178969990e1b0d0a9b3ed6562bcd785dfbd7cd74f04de636857b8f1b01fb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0009324039861251521
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-015">
<h2>Alpha 015<a class="headerlink" href="#alpha-015" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">high</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha015</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * ts_sum(rank(ts_corr(rank(high), rank(volume), 3)), 3))&quot;&quot;&quot;</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">15</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha015</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.44 s, sys: 24.1 ms, total: 3.47 s
Wall time: 3.44 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/59a73334c735549c795e22911c4edf8f4415a63195d9cd857374565c29ff8506.png" src="../../_images/59a73334c735549c795e22911c4edf8f4415a63195d9cd857374565c29ff8506.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4b10c18e0fa3888d80e303a74d8270a0043177540b5a281aa34b97deb851c052.png" src="../../_images/4b10c18e0fa3888d80e303a74d8270a0043177540b5a281aa34b97deb851c052.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0011393971145832182
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-016">
<h2>Alpha 016<a class="headerlink" href="#alpha-016" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(-1 * rank(ts_cov(rank(high), rank(volume), 5)))```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha016</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * rank(ts_cov(rank(high), rank(volume), 5)))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_cov</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">16</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha016</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.89 s, sys: 44.1 ms, total: 2.94 s
Wall time: 2.91 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/06306662e6be501e81d2824a6c6e43f950228e24e97205eb26570813b49a5f80.png" src="../../_images/06306662e6be501e81d2824a6c6e43f950228e24e97205eb26570813b49a5f80.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dc2a1fe772a1438d48d3d6af0e23532e3c161b1c020e8c490f4d454f54f7980e.png" src="../../_images/dc2a1fe772a1438d48d3d6af0e23532e3c161b1c020e8c490f4d454f54f7980e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-017">
<h2>Alpha 017<a class="headerlink" href="#alpha-017" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rank(((0 &lt; ts_min(ts_delta(close, 1), 4)) 
? ts_delta(close, 1) 
: ((ts_max(ts_delta(close, 1), 4) &lt; 0)
    ? ts_delta(close, 1) 
    : (-1 * ts_delta(close, 1)))))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha017</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(((-1 * rank(ts_rank(close, 10))) * rank(ts_delta(ts_delta(close, 1), 1))) *rank(ts_rank((volume / adv20), 5)))</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">adv20</span> <span class="o">=</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">adv20</span><span class="p">),</span> <span class="mi">5</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">17</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha017</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5min 59s, sys: 127 ms, total: 5min 59s
Wall time: 5min 59s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a9a28f420195ba2601a9c72038b084bc7eb03245e2f75592abfed09072645078.png" src="../../_images/a9a28f420195ba2601a9c72038b084bc7eb03245e2f75592abfed09072645078.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e1ba1ece97f787e6ea059bbd3b5e95453e00528bae36967a47f73c3f694a191a.png" src="../../_images/e1ba1ece97f787e6ea059bbd3b5e95453e00528bae36967a47f73c3f694a191a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-018">
<h2>Alpha 018<a class="headerlink" href="#alpha-018" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">((</span><span class="n">ts_std</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">))</span> <span class="o">+</span>
            <span class="n">ts_corr</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="nb">open</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha018</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-rank((ts_std(abs((close - open)), 5) + (close - open)) +</span>
<span class="sd">            ts_corr(close, open,10))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_std</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
                  <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
                       <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">18</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha018</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.64 s, sys: 84.1 ms, total: 3.72 s
Wall time: 3.64 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/84ff0077a6c9fd0bab6c6ad96af3e49e0049bfe8b49258d60cf2d561107bb78b.png" src="../../_images/84ff0077a6c9fd0bab6c6ad96af3e49e0049bfe8b49258d60cf2d561107bb78b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/09568625fdb11da9668eff1cf2beb46a4cbeb123b79c0c38f4fddbcf6490c502.png" src="../../_images/09568625fdb11da9668eff1cf2beb46a4cbeb123b79c0c38f4fddbcf6490c502.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-019">
<h2>Alpha 019<a class="headerlink" href="#alpha-019" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rank(((0 &lt; ts_min(ts_delta(close, 1), 4)) 
? ts_delta(close, 1) 
: ((ts_max(ts_delta(close, 1), 4) &lt; 0)
    ? ts_delta(close, 1) 
    : (-1 * ts_delta(close, 1)))))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha019</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((-1 * sign(((close - ts_lag(close, 7)) + ts_delta(close, 7)))) * </span>
<span class="sd">    (1 + rank((1 + ts_sum(returns,250)))))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">sign</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rank</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">19</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha019</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.33 s, sys: 24 ms, total: 2.36 s
Wall time: 2.33 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e7b1e7c03810d219eba2198dde1d2ce665faa0fab3706cb68d613cfd3c1f403f.png" src="../../_images/e7b1e7c03810d219eba2198dde1d2ce665faa0fab3706cb68d613cfd3c1f403f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d6aa2a198dbf5c3b617892822a9201a75e00487554631cf5516e5678e3542188.png" src="../../_images/d6aa2a198dbf5c3b617892822a9201a75e00487554631cf5516e5678e3542188.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.010082898712334476
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-020">
<h2>Alpha 020<a class="headerlink" href="#alpha-020" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
 <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
 <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha020</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-rank(open - ts_lag(high, 1)) * </span>
<span class="sd">        rank(open - ts_lag(close, 1)) * </span>
<span class="sd">        rank(open -ts_lag(low, 1))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha020</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.4 s, sys: 64 ms, total: 2.47 s
Wall time: 2.4 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b912c09eb7971f28d44068d6253529df4dd9f72978c7009d9ac8805741da0450.png" src="../../_images/b912c09eb7971f28d44068d6253529df4dd9f72978c7009d9ac8805741da0450.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/72d957205842492a821027aed0f47faef18c5792d5ea3545aa92d5e5f1206102.png" src="../../_images/72d957205842492a821027aed0f47faef18c5792d5ea3545aa92d5e5f1206102.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002095780517723078
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-021">
<h2>Alpha 021<a class="headerlink" href="#alpha-021" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ts_mean(close, 8) + ts_std(close, 8) &lt; ts_mean(close, 2)
        ? -1 
        : (ts_mean(close,2) &lt; ts_mean(close, 8) - ts_std(close, 8)
            ? 1 
            : (volume / adv20 &lt; 1
                ? -1 
                : 1))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha021</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ts_mean(close, 8) + ts_std(close, 8) &lt; ts_mean(close, 2)</span>
<span class="sd">        ? -1</span>
<span class="sd">        : (ts_mean(close,2) &lt; ts_mean(close, 8) - ts_std(close, 8)</span>
<span class="sd">            ? 1</span>
<span class="sd">            : (volume / adv20 &lt; 1</span>
<span class="sd">                ? -1</span>
<span class="sd">                : 1))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sma2</span> <span class="o">=</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sma8</span> <span class="o">=</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">std8</span> <span class="o">=</span> <span class="n">ts_std</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="n">cond_1</span> <span class="o">=</span> <span class="n">sma8</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">std8</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sma2</span>
    <span class="n">cond_2</span> <span class="o">=</span> <span class="n">sma8</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">std8</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">sma2</span>
    <span class="n">cond_3</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">1</span>

    <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">condlist</span><span class="o">=</span><span class="p">[</span><span class="n">cond_1</span><span class="p">,</span> <span class="n">cond_2</span><span class="p">,</span> <span class="n">cond_3</span><span class="p">],</span>
                                   <span class="n">choicelist</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">index</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                         <span class="n">columns</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">21</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha021</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.15 s, sys: 16 ms, total: 2.17 s
Wall time: 2.13 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1    1211187
-1      43906
Name: 021, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/22e58df539e54451b846be93863e5d77f92509b286ef947ef7f6b6220e22914c.png" src="../../_images/22e58df539e54451b846be93863e5d77f92509b286ef947ef7f6b6220e22914c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-022">
<h2>Alpha 022<a class="headerlink" href="#alpha-022" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_std</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">20</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha022</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-(ts_delta(ts_corr(high, volume, 5), 5) * </span>
<span class="sd">        rank(ts_std(close, 20)))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_std</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">20</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">22</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha022</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.47 s, sys: 52.1 ms, total: 3.52 s
Wall time: 3.45 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0075fcba2d838ca520f22fbe23d0dc0d0b162284d2ca9bb92eb80dcf4646a7fb.png" src="../../_images/0075fcba2d838ca520f22fbe23d0dc0d0b162284d2ca9bb92eb80dcf4646a7fb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3a06453d9568ce5cea83064d5e3bd54cd1bcd524a38c0c9dd767d3082dcb0f45.png" src="../../_images/3a06453d9568ce5cea83064d5e3bd54cd1bcd524a38c0c9dd767d3082dcb0f45.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0025639008286280074
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-023">
<h2>Alpha 023<a class="headerlink" href="#alpha-023" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>((ts_sum(high, 20) / 20) &lt; high)
            ? (-1 * ts_delta(high, 2))
            : 0
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha023</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((ts_mean(high, 20) &lt; high)</span>
<span class="sd">            ? (-1 * ts_delta(high, 2))</span>
<span class="sd">            : 0</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">23</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha023</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.49 s, sys: 8.05 ms, total: 2.5 s
Wall time: 2.48 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.025</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                                        <span class="n">upper</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ac23fc7046aaaa08bebb466b52c5025e9082bbe0bd52c153b67184bd78a7d054.png" src="../../_images/ac23fc7046aaaa08bebb466b52c5025e9082bbe0bd52c153b67184bd78a7d054.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b9a5c89f10f0a7bbb9aae4de6a1c729a784bef57f532b4fd5505385a55096d02.png" src="../../_images/b9a5c89f10f0a7bbb9aae4de6a1c729a784bef57f532b4fd5505385a55096d02.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.010802888976805036
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-024">
<h2>Alpha 024<a class="headerlink" href="#alpha-024" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>((((ts_delta((ts_mean(close, 100)), 100) / ts_lag(close, 100)) &lt;= 0.05)  
        ? (-1 * (close - ts_min(close, 100))) 
        : (-1 * ts_delta(close, 3)))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha024</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((((ts_delta((ts_mean(close, 100)), 100) / ts_lag(close, 100)) &lt;= 0.05)  </span>
<span class="sd">        ? (-1 * (close - ts_min(close, 100))) </span>
<span class="sd">        : (-1 * ts_delta(close, 3)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.05</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="o">-</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">24</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha024</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.45 s, sys: 48 ms, total: 2.5 s
Wall time: 2.44 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                                        <span class="n">upper</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a74731fc654fec211bb9fddc428ed37fc4c07971f72594ba7363c43d5f25116d.png" src="../../_images/a74731fc654fec211bb9fddc428ed37fc4c07971f72594ba7363c43d5f25116d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6ea7f7cb263d71ec6f0efdccb15634350b5b083cb50becdcec4ec5226814d047.png" src="../../_images/6ea7f7cb263d71ec6f0efdccb15634350b5b083cb50becdcec4ec5226814d047.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.031433111296676586
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-025">
<h2>Alpha 025<a class="headerlink" href="#alpha-025" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">returns</span><span class="p">)</span> <span class="o">*</span> <span class="n">adv20</span> <span class="o">*</span> <span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">close</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha025</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;rank((-1 * returns) * adv20 * vwap * (high - close))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">adv20</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">vwap</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">25</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha025</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.9 s, sys: 36 ms, total: 2.93 s
Wall time: 2.9 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e4dca5441208d60827634a983707e1a77333335b04d4f5c06f5b6dcd8180a947.png" src="../../_images/e4dca5441208d60827634a983707e1a77333335b04d4f5c06f5b6dcd8180a947.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/da432938f71dec5611ab19acdce680f8c1f11475d666f10d89aea1e7456cbdfc.png" src="../../_images/da432938f71dec5611ab19acdce680f8c1f11475d666f10d89aea1e7456cbdfc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002047811727091897
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-026">
<h2>Alpha 026<a class="headerlink" href="#alpha-026" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(-1 * rank(ts_cov(rank(high), rank(volume), 5)))```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha026</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * ts_max(ts_corr(ts_rank(volume, 5), ts_rank(high, 5), 5), 3))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> 
                           <span class="n">ts_rank</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">26</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha026</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6min 3s, sys: 148 ms, total: 6min 3s
Wall time: 6min 3s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b090ad6e9444c35909d6165d92fc8ed4bcffe51b3b8e16695f0d762dae34a613.png" src="../../_images/b090ad6e9444c35909d6165d92fc8ed4bcffe51b3b8e16695f0d762dae34a613.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eb360dfce3fd5d18fe0e8b74a3899ee8a398a10d5d1c641287153a71e8f80849.png" src="../../_images/eb360dfce3fd5d18fe0e8b74a3899ee8a398a10d5d1c641287153a71e8f80849.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.006628205346157046
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-027">
<h2>Alpha 027<a class="headerlink" href="#alpha-027" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rank(((0 &lt; ts_min(ts_delta(close, 1), 4)) 
? ts_delta(close, 1) 
: ((ts_max(ts_delta(close, 1), 4) &lt; 0)
    ? ts_delta(close, 1) 
    : (-1 * ts_delta(close, 1)))))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha027</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((0.5 &lt; rank(ts_mean(ts_corr(rank(volume), rank(vwap), 6), 2))) </span>
<span class="sd">            ? -1</span>
<span class="sd">            : 1)&quot;&quot;&quot;</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span>
                                <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="n">alpha</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">27</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha027</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.65 s, sys: 28 ms, total: 3.68 s
Wall time: 3.64 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a68547384c26374a360701b2e0ba8f1c5a78ff8403823fbc3b4d1a93c2d4fdbd.png" src="../../_images/a68547384c26374a360701b2e0ba8f1c5a78ff8403823fbc3b4d1a93c2d4fdbd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f3a02927075c813bfe3fd98ec45b45ac998e90fef724c2bf8e5e777a560c4527.png" src="../../_images/f3a02927075c813bfe3fd98ec45b45ac998e90fef724c2bf8e5e777a560c4527.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-028">
<h2>Alpha 028<a class="headerlink" href="#alpha-028" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">((</span><span class="n">ts_std</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">))</span> <span class="o">+</span>
            <span class="n">ts_corr</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="nb">open</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha028</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;scale(((ts_corr(adv20, low, 5) + (high + low) / 2) - close))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">adv20</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">28</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha028</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.3 s, sys: 24 ms, total: 3.33 s
Wall time: 3.27 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d92d4df7f191b578cfef5b7f30aa5765dfd89e8b420b2cf4b2adfdb6da7023b9.png" src="../../_images/d92d4df7f191b578cfef5b7f30aa5765dfd89e8b420b2cf4b2adfdb6da7023b9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9cffd7b49f1325872d2c5a0655ff4177865dbcc8cf866d7977c83808d8b9a414.png" src="../../_images/9cffd7b49f1325872d2c5a0655ff4177865dbcc8cf866d7977c83808d8b9a414.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0064583435249003784
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-029">
<h2>Alpha 029<a class="headerlink" href="#alpha-029" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rank(((0 &lt; ts_min(ts_delta(close, 1), 4)) 
? ts_delta(close, 1) 
: ((ts_max(ts_delta(close, 1), 4) &lt; 0)
    ? ts_delta(close, 1) 
    : (-1 * ts_delta(close, 1)))))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha029</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(ts_min(ts_product(rank(rank(scale(log(ts_sum(ts_min(rank(rank((-1 * </span>
<span class="sd">            rank(ts_delta((close - 1),5))))), 2), 1))))), 1), 5)</span>
<span class="sd">        + ts_rank(ts_lag((-1 * returns), 6), 5))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">5</span><span class="p">)))),</span> <span class="mi">2</span><span class="p">))))),</span> <span class="mi">5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">r</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">29</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha029</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 3s, sys: 188 ms, total: 3min 4s
Wall time: 3min 4s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/673d590c8549a7b19748dc2fac9d17d91e27e92cc83bb7bd297c67d8187287f8.png" src="../../_images/673d590c8549a7b19748dc2fac9d17d91e27e92cc83bb7bd297c67d8187287f8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5ea208ffdd49c1e1965605beead972b245c80f54e086c8b6868fed13812eabd0.png" src="../../_images/5ea208ffdd49c1e1965605beead972b245c80f54e086c8b6868fed13812eabd0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.005814612612969228
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-030">
<h2>Alpha 030<a class="headerlink" href="#alpha-030" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
 <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
 <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha030</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(((1.0 - rank(((sign((close - ts_lag(close, 1))) +</span>
<span class="sd">            sign((ts_lag(close, 1) - ts_lag(close, 2)))) +</span>
<span class="sd">            sign((ts_lag(close, 2) - ts_lag(close, 3)))))) *</span>
<span class="sd">            ts_sum(volume, 5)) / ts_sum(volume, 20))&quot;&quot;&quot;</span>
    <span class="n">close_diff</span> <span class="o">=</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">close_diff</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">close_diff</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
                 <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">close_diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha030</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.39 s, sys: 48 ms, total: 2.44 s
Wall time: 2.38 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/64d3ad3d7acbf0921b2b683a8302a9d227cfb214c8c0c1fd784353031df3f1ec.png" src="../../_images/64d3ad3d7acbf0921b2b683a8302a9d227cfb214c8c0c1fd784353031df3f1ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/50221cf15d17f95c9cbb24cc3c484f09ecae7f7dc4d8db60ae61ab31c172e01c.png" src="../../_images/50221cf15d17f95c9cbb24cc3c484f09ecae7f7dc4d8db60ae61ab31c172e01c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-031">
<h2>Alpha 031<a class="headerlink" href="#alpha-031" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ts_mean(close, 8) + ts_std(close, 8) &lt; ts_mean(close, 2)
        ? -1 
        : (ts_mean(close,2) &lt; ts_mean(close, 8) - ts_std(close, 8)
            ? 1 
            : (volume / adv20 &lt; 1
                ? -1 
                : 1))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha031</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(rank(rank(ts_weighted_mean((-1 * rank(rank(ts_delta(close, 10)))), 10)))) +</span>
<span class="sd">        rank((-1 * ts_delta(close, 3)))) + sign(scale(ts_corr(adv20, low, 12))))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">adv20</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">31</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha031</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.66 s, sys: 15.9 ms, total: 3.68 s
Wall time: 3.61 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c2d72b4481a742548b909dfe6160107a03b07ae74d04649e2b2521b4986976ec.png" src="../../_images/c2d72b4481a742548b909dfe6160107a03b07ae74d04649e2b2521b4986976ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d0b0748da304ec829fada9b6c239d37c713efad54b1bd29ac7c81e4776fe8b79.png" src="../../_images/d0b0748da304ec829fada9b6c239d37c713efad54b1bd29ac7c81e4776fe8b79.png" />
</div>
</div>
</section>
<section id="alpha-032">
<h2>Alpha 032<a class="headerlink" href="#alpha-032" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>scale(ts_mean(close, 7) - close) + 
        (20 * scale(ts_corr(vwap, ts_lag(close, 5),230)))```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha032</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;scale(ts_mean(close, 7) - close) + </span>
<span class="sd">        (20 * scale(ts_corr(vwap, ts_lag(close, 5),230)))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">scale</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span>
                                    <span class="n">ts_lag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">230</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">32</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha032</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.68 s, sys: 15.9 ms, total: 3.69 s
Wall time: 3.63 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1b1aaf5d4703e2c39d8b91dbe34e77cd3cc08bc03b0699b7d7aa87a6a701e036.png" src="../../_images/1b1aaf5d4703e2c39d8b91dbe34e77cd3cc08bc03b0699b7d7aa87a6a701e036.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/91408727952316547b70898856f0853688d683252e4dfdad6b90803fe95174b9.png" src="../../_images/91408727952316547b70898856f0853688d683252e4dfdad6b90803fe95174b9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> 
                                  <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015078606589863597
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-033">
<h2>Alpha 033<a class="headerlink" href="#alpha-033" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>((ts_sum(high, 20) / 20) &lt; high)
            ? (-1 * ts_delta(high, 2))
            : 0
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha033</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;rank(-(1 - (open / close)))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">33</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha033</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.66 s, sys: 12 ms, total: 2.67 s
Wall time: 2.64 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/49e14ad7ba58721f05fb317d624a29f5004ed9db9bc1692e7e9d99f0e7966800.png" src="../../_images/49e14ad7ba58721f05fb317d624a29f5004ed9db9bc1692e7e9d99f0e7966800.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1cee2d2f83f2b4da1bc3ffbb3172ea60d3fa858857ea7c167b5b984dca506350.png" src="../../_images/1cee2d2f83f2b4da1bc3ffbb3172ea60d3fa858857ea7c167b5b984dca506350.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.003290483361809038
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-034">
<h2>Alpha 034<a class="headerlink" href="#alpha-034" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>((((ts_delta((ts_mean(close, 100)), 100) / ts_lag(close, 100)) &lt;= 0.05)  
        ? (-1 * (close - ts_min(close, 100))) 
        : (-1 * ts_delta(close, 3)))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha034</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;rank(((1 - rank((ts_std(returns, 2) / ts_std(returns, 5)))) + (1 - rank(ts_delta(close, 1)))))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_std</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_std</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
                      <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
                 <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
                 <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">34</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha034</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.75 s, sys: 8 ms, total: 1.76 s
Wall time: 1.73 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/630318d0eb515f6919c33de66f951c293ff8f2c30c357e9b157b344b4404aeb1.png" src="../../_images/630318d0eb515f6919c33de66f951c293ff8f2c30c357e9b157b344b4404aeb1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5f35bc884a36c215bcc024cf49320b13b13807a99409eb76394dc73ff91e3ab8.png" src="../../_images/5f35bc884a36c215bcc024cf49320b13b13807a99409eb76394dc73ff91e3ab8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-035">
<h2>Alpha 035<a class="headerlink" href="#alpha-035" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">returns</span><span class="p">)</span> <span class="o">*</span> <span class="n">adv20</span> <span class="o">*</span> <span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">close</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha035</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((ts_Rank(volume, 32) *</span>
<span class="sd">        (1 - ts_Rank(((close + high) - low), 16))) *</span>
<span class="sd">        (1 -ts_Rank(returns, 32)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="mi">16</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">35</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha035</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 9min 1s, sys: 95.8 ms, total: 9min 1s
Wall time: 9min 1s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0345c1d7598563c8c98680aa69bd92411bc31dabb63ccfc565aff996642a6024.png" src="../../_images/0345c1d7598563c8c98680aa69bd92411bc31dabb63ccfc565aff996642a6024.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/439dbced9e6df1631928e3264728610c6de859199675ad8cab33ab2b614e856e.png" src="../../_images/439dbced9e6df1631928e3264728610c6de859199675ad8cab33ab2b614e856e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-036">
<h2>Alpha 036<a class="headerlink" href="#alpha-036" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">2.21</span> <span class="o">*</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">((</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">),</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">15</span><span class="p">))</span> <span class="o">+</span>
<span class="mf">0.7</span> <span class="o">*</span> <span class="n">rank</span><span class="p">((</span><span class="nb">open</span><span class="o">-</span> <span class="n">close</span><span class="p">))</span> <span class="o">+</span>
<span class="mf">0.73</span> <span class="o">*</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_Rank</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">returns</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span>
<span class="n">rank</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span><span class="n">adv20</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span> <span class="o">+</span>
<span class="mf">0.6</span> <span class="o">*</span> <span class="n">rank</span><span class="p">(((</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="o">-</span> <span class="nb">open</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">close</span> <span class="o">-</span> <span class="nb">open</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha036</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;2.21 * rank(ts_corr((close - open), ts_lag(volume, 1), 15)) +</span>
<span class="sd">        0.7 * rank((open- close)) +</span>
<span class="sd">        0.73 * rank(ts_Rank(ts_lag(-1 * returns, 6), 5)) +</span>
<span class="sd">        rank(abs(ts_corr(vwap,adv20, 6))) +</span>
<span class="sd">        0.6 * rank(((ts_mean(close, 200) - open) * (close - open)))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">2.21</span><span class="p">)</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">.7</span><span class="p">))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">0.73</span><span class="p">))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">,</span> <span class="mi">6</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">o</span><span class="p">)))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">0.6</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">36</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha036</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 5s, sys: 51.9 ms, total: 3min 5s
Wall time: 3min 5s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4e74ebb09060ccfccda31882357f135afd82f808732be71e4f40550c92a6a6e1.png" src="../../_images/4e74ebb09060ccfccda31882357f135afd82f808732be71e4f40550c92a6a6e1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9d3252255a5820fc75871a9afdf7c00d1884d34640fa5471e1ed492911b835ab.png" src="../../_images/9d3252255a5820fc75871a9afdf7c00d1884d34640fa5471e1ed492911b835ab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0017091501300177114
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-037">
<h2>Alpha 037<a class="headerlink" href="#alpha-037" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">close</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span> <span class="o">+</span> 
        <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">close</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha037</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_corr(ts_lag((open - close), 1), close, 200)) + rank((open - close)))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">37</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha037</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.51 s, sys: 32 ms, total: 3.54 s
Wall time: 3.49 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0b78e6c2ee8dd57723cbeca691b0ab13ad54ff9bd8f0c5a64a84dfe39969bf56.png" src="../../_images/0b78e6c2ee8dd57723cbeca691b0ab13ad54ff9bd8f0c5a64a84dfe39969bf56.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c5b1f1d05d607901d77882f11aa9ec7d97a8da269bb12564b078e5b4efce5c95.png" src="../../_images/c5b1f1d05d607901d77882f11aa9ec7d97a8da269bb12564b078e5b4efce5c95.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0011419189372663396
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mi.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-038">
<h2>Alpha 038<a class="headerlink" href="#alpha-038" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">*</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">*</span> <span class="n">rank</span><span class="p">(</span><span class="n">close</span> <span class="o">/</span> <span class="nb">open</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha038</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;-1 * rank(ts_rank(close, 10)) * rank(close / open)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">38</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha038</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 5s, sys: 15.9 ms, total: 3min 5s
Wall time: 3min 5s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e13a22be155cb59b1523321e63a7a8ee952062e713ea0b08cbeb99b5b7db6792.png" src="../../_images/e13a22be155cb59b1523321e63a7a8ee952062e713ea0b08cbeb99b5b7db6792.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fafef68ea09b59e52fad116b76f9e86dac1fb83de3c079c75163714faa6d61d3.png" src="../../_images/fafef68ea09b59e52fad116b76f9e86dac1fb83de3c079c75163714faa6d61d3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.003271738846891026
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-039">
<h2>Alpha 039<a class="headerlink" href="#alpha-039" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">volume</span> <span class="o">/</span> <span class="n">adv20</span><span class="p">,</span> <span class="mi">9</span><span class="p">))))</span> <span class="o">*</span> 
    <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha039</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-rank(ts_delta(close, 7) * (1 - rank(ts_weighted_mean(volume / adv20, 9)))) * </span>
<span class="sd">            (1 + rank(ts_sum(returns, 250)))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">adv20</span><span class="p">),</span> <span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">39</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha039</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.55 s, sys: 16 ms, total: 2.56 s
Wall time: 2.5 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ac93aaa0f0d2fc2896cb8e1a563b6a3f0cd5f5934a1cd4f2bcab40725cdb9b22.png" src="../../_images/ac93aaa0f0d2fc2896cb8e1a563b6a3f0cd5f5934a1cd4f2bcab40725cdb9b22.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a9ab32e1c6fc9b373782028314f555abcc3b45058ceafc76e506d51db03eaefb.png" src="../../_images/a9ab32e1c6fc9b373782028314f555abcc3b45058ceafc76e506d51db03eaefb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0021417818275919487
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-040">
<h2>Alpha 040<a class="headerlink" href="#alpha-040" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
 <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
 <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha040</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((-1 * rank(ts_std(high, 10))) * ts_corr(high, volume, 10))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_std</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">40</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha040</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.71 s, sys: 15.9 ms, total: 3.72 s
Wall time: 3.68 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ecaaaa6fe03a371facb9b5cbb6b36f280544d8165b2f583c49180e1986374d99.png" src="../../_images/ecaaaa6fe03a371facb9b5cbb6b36f280544d8165b2f583c49180e1986374d99.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bbec1a243cde450988a4072c218ee6a6e810248c767d92a6c264b58084797c23.png" src="../../_images/bbec1a243cde450988a4072c218ee6a6e810248c767d92a6c264b58084797c23.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.008389463848225809
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-041">
<h2>Alpha 041<a class="headerlink" href="#alpha-041" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>power(high * low, 0.5) - vwap```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha041</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;power(high * low, 0.5 - vwap&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">41</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha041</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.32 s, sys: 16 ms, total: 2.34 s
Wall time: 2.3 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cdbc627d7f420af1081c186d6bca85f1d6a1d228b3d17ec953ca072e62a8f0b0.png" src="../../_images/cdbc627d7f420af1081c186d6bca85f1d6a1d228b3d17ec953ca072e62a8f0b0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3a84b22bf87d282d4ff56f9bcdc55e45d05836045e6ed320e49f23640ece5ae8.png" src="../../_images/3a84b22bf87d282d4ff56f9bcdc55e45d05836045e6ed320e49f23640ece5ae8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.004631922179492598
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-042">
<h2>Alpha 042<a class="headerlink" href="#alpha-042" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">close</span><span class="p">)</span> <span class="o">/</span> <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span> <span class="o">+</span> <span class="n">close</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha042</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;rank(vwap - close) / rank(vwap + close)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
            <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha042</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.43 s, sys: 36 ms, total: 2.46 s
Wall time: 2.43 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/06914e2bc1a78af2934b220ad89134357c59f7f679c81f4f35c5bfff77bd7c8a.png" src="../../_images/06914e2bc1a78af2934b220ad89134357c59f7f679c81f4f35c5bfff77bd7c8a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/05f084f31a87bd15fc852fc965df11584737ad2e45b5c38795200572537cfc77.png" src="../../_images/05f084f31a87bd15fc852fc965df11584737ad2e45b5c38795200572537cfc77.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0003211794350050923
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-043">
<h2>Alpha 043<a class="headerlink" href="#alpha-043" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>((ts_sum(high, 20) / 20) &lt; high)
            ? (-1 * ts_delta(high, 2))
            : 0
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha043</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(ts_rank((volume / adv20), 20) * ts_rank((-1 * ts_delta(close, 7)), 8))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">adv20</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">43</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha043</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6min 2s, sys: 72 ms, total: 6min 2s
Wall time: 6min 2s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e97015a4ad98e8007d4832e58c6ca71345b75dce630152bf6bf69ebca03d2cff.png" src="../../_images/e97015a4ad98e8007d4832e58c6ca71345b75dce630152bf6bf69ebca03d2cff.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/66af2194a5d88c04303e80074ba155865bd69481ee0be9539477403740b688b4.png" src="../../_images/66af2194a5d88c04303e80074ba155865bd69481ee0be9539477403740b688b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.31646414482023e-05
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-044">
<h2>Alpha 044<a class="headerlink" href="#alpha-044" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha044</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-ts_corr(high, rank(volume), 5)&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">44</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha044</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.69 s, sys: 28 ms, total: 3.72 s
Wall time: 3.69 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ff6fc8b8f01c21eae9fc3d280aeb19f2f9313184668d57b15767754ddf608b67.png" src="../../_images/ff6fc8b8f01c21eae9fc3d280aeb19f2f9313184668d57b15767754ddf608b67.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a024e5d3186a984e0d72ba85877f35027b6b1bf9d660e74c1c4d5c2342162f2d.png" src="../../_images/a024e5d3186a984e0d72ba85877f35027b6b1bf9d660e74c1c4d5c2342162f2d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-045">
<h2>Alpha 045<a class="headerlink" href="#alpha-045" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="p">(</span><span class="n">rank</span><span class="p">((</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">20</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">ts_corr</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha045</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-(rank((ts_mean(ts_lag(close, 5), 20)) * </span>
<span class="sd">        ts_corr(close, volume, 2)) *</span>
<span class="sd">        rank(ts_corr(ts_sum(close, 5), ts_sum(close, 20), 2)))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">20</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                              <span class="n">ts_sum</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">45</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha045</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5.26 s, sys: 76 ms, total: 5.33 s
Wall time: 5.18 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1a2db8a49779510053f8c315cfb616ea8ed4a8e2df2faa286f977fbfdd888cc7.png" src="../../_images/1a2db8a49779510053f8c315cfb616ea8ed4a8e2df2faa286f977fbfdd888cc7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/75c3862a4c9ce38692c551e747fbf2cb33f8d8f12b377b98ac876c9bf314053e.png" src="../../_images/75c3862a4c9ce38692c551e747fbf2cb33f8d8f12b377b98ac876c9bf314053e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.008224194668740914
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-046">
<h2>Alpha 046<a class="headerlink" href="#alpha-046" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0.25 &lt; ts_lag(ts_delta(close, 10), 10) / 10 - ts_delta(close, 10) / 10
    ? -1
    : ((ts_lag(ts_delta(close, 10), 10) / 10 - ts_delta(close, 10) / 10 &lt; 0) 
        ? 1 
        : -ts_delta(close, 1))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha046</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;0.25 &lt; ts_lag(ts_delta(close, 10), 10) / 10 - ts_delta(close, 10) / 10</span>
<span class="sd">            ? -1</span>
<span class="sd">            : ((ts_lag(ts_delta(close, 10), 10) / 10 - ts_delta(close, 10) / 10 &lt; 0) </span>
<span class="sd">                ? 1 </span>
<span class="sd">                : -ts_delta(close, 1))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cond</span> <span class="o">=</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">cond</span><span class="p">),</span>
                         <span class="n">index</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                         <span class="n">columns</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">alpha</span><span class="p">[</span><span class="n">cond</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">,</span>
                       <span class="o">-</span><span class="n">alpha</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="o">-</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">46</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha046</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.37 s, sys: 12 ms, total: 2.38 s
Wall time: 2.34 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1c3fa079d5fdb53f4da76f554b1c7a7beaf72e7c87bbeafd1d983ddd4bf1756b.png" src="../../_images/1c3fa079d5fdb53f4da76f554b1c7a7beaf72e7c87bbeafd1d983ddd4bf1756b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/91759da6d38536cfa7a19ed0eead53a84f1a966a6d08aad5a10dced9b49384c2.png" src="../../_images/91759da6d38536cfa7a19ed0eead53a84f1a966a6d08aad5a10dced9b49384c2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00870732283747122
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-047">
<h2>Alpha 047<a class="headerlink" href="#alpha-047" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">close</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span> <span class="o">+</span> 
        <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">close</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha047</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((((rank((1 / close)) * volume) / adv20) * ((high * rank((high - close))) / </span>
<span class="sd">        (ts_sum(high, 5) /5))) - rank((vwap - ts_lag(vwap, 5))))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">adv20</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
                       <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
                 <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">5</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">47</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha047</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.87 s, sys: 64.1 ms, total: 2.93 s
Wall time: 2.81 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/91d4f530fe04ad25fd1ee065639c1c0a657603eaf57330917723025e02fdf2df.png" src="../../_images/91d4f530fe04ad25fd1ee065639c1c0a657603eaf57330917723025e02fdf2df.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/82005a16152ec0ab5bf55c777e309bfea8eeab5d7e1460a23dff4b7c63ef16b4.png" src="../../_images/82005a16152ec0ab5bf55c777e309bfea8eeab5d7e1460a23dff4b7c63ef16b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0009995443357944112
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-048">
<h2>Alpha 048<a class="headerlink" href="#alpha-048" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">indneutralize</span><span class="p">(((</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">250</span><span class="p">)</span> <span class="o">*</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">close</span><span class="p">),</span> <span class="n">IndClass</span><span class="o">.</span><span class="n">subindustry</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(((</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha48</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(indneutralize(((ts_corr(ts_delta(close, 1), ts_delta(ts_lag(close, 1), 1), 250) * </span>
<span class="sd">        ts_delta(close, 1)) / close), IndClass.subindustry) / </span>
<span class="sd">        ts_sum(((ts_delta(close, 1) / ts_lag(close, 1))^2), 250))&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">48</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%time</span>
<span class="c1"># alphas[f&#39;{alpha:03}&#39;] = alpha48(o, c)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alphas[f&#39;{alpha:03}&#39;].to_hdf(&#39;alphas.h5&#39;, f&#39;alphas/{alpha:03}&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.distplot(alphas[f&#39;{alpha:03}&#39;]);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># g = sns.jointplot(x=f&#39;{alpha:03}&#39;, y=&#39;ret_fwd&#39;, data=alphas);</span>
<span class="c1"># </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
<span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-049">
<h2>Alpha 049<a class="headerlink" href="#alpha-049" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ts_delta(ts_lag(close, 10), 10).div(10).sub(ts_delta(close, 10).div(10)) &lt; -0.1 * c
        ? 1 
        : -ts_delta(close, 1)
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha049</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ts_delta(ts_lag(close, 10), 10).div(10).sub(ts_delta(close, 10).div(10)) &lt; -0.1 * c</span>
<span class="sd">        ? 1 </span>
<span class="sd">        : -ts_delta(close, 1)&quot;&quot;&quot;</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">49</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha049</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.13 s, sys: 32 ms, total: 3.16 s
Wall time: 3.12 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/da068bba087c12b143cd8b4a3d47a28a14c64bceb9bce706ebf11246e5bf3cb3.png" src="../../_images/da068bba087c12b143cd8b4a3d47a28a14c64bceb9bce706ebf11246e5bf3cb3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/afc058856cf7e80374e717403dade8b204099e804024261478d39206469b6c02.png" src="../../_images/afc058856cf7e80374e717403dade8b204099e804024261478d39206469b6c02.png" />
</div>
</div>
</section>
<section id="alpha-050">
<h2>Alpha 050<a class="headerlink" href="#alpha-050" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha050</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-ts_max(rank(ts_corr(rank(volume), rank(vwap), 5)), 5)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span>
                                <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha050</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.98 s, sys: 88 ms, total: 3.07 s
Wall time: 3.01 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/746df88b9be7002572cdf76877b6b80063f9e6121d0034bf26a15a46fa20d683.png" src="../../_images/746df88b9be7002572cdf76877b6b80063f9e6121d0034bf26a15a46fa20d683.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7a92ace4d813c69ee369896e8f69fa46b945a9a4a13f1b6851a6b982fc939128.png" src="../../_images/7a92ace4d813c69ee369896e8f69fa46b945a9a4a13f1b6851a6b982fc939128.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-051">
<h2>Alpha 051<a class="headerlink" href="#alpha-051" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ts_delta(ts_lag(close, 10), 10).div(10).sub(ts_delta(close, 10).div(10)) &lt; -0.05 * c
        ? 1 
        : -ts_delta(close, 1)
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha051</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ts_delta(ts_lag(close, 10), 10).div(10).sub(ts_delta(close, 10).div(10)) &lt; -0.05 * c</span>
<span class="sd">        ? 1 </span>
<span class="sd">        : -ts_delta(close, 1)&quot;&quot;&quot;</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">51</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha051</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5.92 s, sys: 128 ms, total: 6.05 s
Wall time: 6 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/db8961fe3b2c9e3959e284bb9cd20f6b4de41c8899ee5f3d2e675cdff5545c77.png" src="../../_images/db8961fe3b2c9e3959e284bb9cd20f6b4de41c8899ee5f3d2e675cdff5545c77.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f9d0fb8be3b1aeee7f7ee4af33859eb62edbad31e6d6754525046a637a3e82a6.png" src="../../_images/f9d0fb8be3b1aeee7f7ee4af33859eb62edbad31e6d6754525046a637a3e82a6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.010624389695808034
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-052">
<h2>Alpha 052<a class="headerlink" href="#alpha-052" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">240</span><span class="p">)</span> <span class="o">-</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="o">/</span> <span class="mi">220</span><span class="p">)</span> <span class="o">*</span> 
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha052</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(ts_lag(ts_min(low, 5), 5) - ts_min(low, 5)) * </span>
<span class="sd">        rank((ts_sum(returns, 240) - ts_sum(returns, 20)) / 220) * </span>
<span class="sd">        ts_rank(volume, 5)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">240</span><span class="p">)</span>
                      <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
                      <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">220</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">52</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha052</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 4s, sys: 52 ms, total: 3min 4s
Wall time: 3min 4s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ffc1d1de107c40bf07bcfb3efe0c380f8df669573e98e693a877be0d493d22e1.png" src="../../_images/ffc1d1de107c40bf07bcfb3efe0c380f8df669573e98e693a877be0d493d22e1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0b8e9813f475048e89e658f0b672dc09118ba6cd946d6453f1fe9a2c7cb0748f.png" src="../../_images/0b8e9813f475048e89e658f0b672dc09118ba6cd946d6453f1fe9a2c7cb0748f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.007025458925477679
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-053">
<h2>Alpha 053<a class="headerlink" href="#alpha-053" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>((ts_sum(high, 20) / 20) &lt; high)
            ? (-1 * ts_delta(high, 2))
            : 0
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha053</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-1 * ts_delta(1 - (high - close) / (close - low), 9)&quot;&quot;&quot;</span>
    <span class="n">inner</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)),</span> <span class="mi">9</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">53</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha053</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.51 s, sys: 0 ns, total: 1.51 s
Wall time: 1.45 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b9c7c484c37d0c1bf92c05966723e50902b3a9455bf869985fca8fa240c7baaf.png" src="../../_images/b9c7c484c37d0c1bf92c05966723e50902b3a9455bf869985fca8fa240c7baaf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
<span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-054">
<h2>Alpha 054<a class="headerlink" href="#alpha-054" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="p">(</span><span class="n">low</span> <span class="o">-</span> <span class="n">close</span><span class="p">)</span> <span class="o">*</span> <span class="n">power</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">low</span> <span class="o">-</span> <span class="n">high</span><span class="p">)</span> <span class="o">*</span> <span class="n">power</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha054</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-(low - close) * power(open, 5) / ((low - high) * power(close, 5))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">c</span> <span class="o">**</span> <span class="mi">5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">54</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha054</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.99 s, sys: 42.8 ms, total: 2.03 s
Wall time: 1.91 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/795ead2cdc2eb3228e0ec3b71f416e2e5effb73c3145e98d85580713f0eb4f0d.png" src="../../_images/795ead2cdc2eb3228e0ec3b71f416e2e5effb73c3145e98d85580713f0eb4f0d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f7c174b608afeb71788236aee7f3e460f1396b30cc2813cbd4de2ba15de7e790.png" src="../../_images/f7c174b608afeb71788236aee7f3e460f1396b30cc2813cbd4de2ba15de7e790.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0007175455210228776
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54    0.000718
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-055">
<h2>Alpha 055<a class="headerlink" href="#alpha-055" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(((</span><span class="n">close</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span> <span class="o">/</span> 
                            <span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="mi">12</span><span class="p">)))),</span> 
                    <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha055</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * ts_corr(rank(((close - ts_min(low, 12)) / </span>
<span class="sd">                            (ts_max(high, 12) - ts_min(low,12)))), </span>
<span class="sd">                    rank(volume), 6))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
                         <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
                              <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">))),</span>
                    <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">55</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha055</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.83 s, sys: 65.4 ms, total: 3.89 s
Wall time: 3.81 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d8ca3a5aa74eb1f9e26310dd6e2bb74c3df08c8aa24eab169dfd0eb1ce78abaa.png" src="../../_images/d8ca3a5aa74eb1f9e26310dd6e2bb74c3df08c8aa24eab169dfd0eb1ce78abaa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4adb582ca01dc4359d538893c43571830553c3a0ef3ce835ed0876a776af8d53.png" src="../../_images/4adb582ca01dc4359d538893c43571830553c3a0ef3ce835ed0876a776af8d53.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-056">
<h2>Alpha 056<a class="headerlink" href="#alpha-056" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">returns</span> <span class="o">*</span> <span class="n">cap</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha056</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-rank(ts_sum(returns, 10) / ts_sum(ts_sum(returns, 2), 3)) * </span>
<span class="sd">        rank((returns * cap))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-057">
<h2>Alpha 057<a class="headerlink" href="#alpha-057" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">close</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span> <span class="o">+</span> 
        <span class="n">rank</span><span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="n">close</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha057</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-(close - vwap) / ts_weighted_mean(rank(ts_argmax(close, 30)), 2)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">))</span>
            <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_argmax</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">30</span><span class="p">))))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">57</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha057</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 54s, sys: 280 ms, total: 1min 54s
Wall time: 1min 53s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7bffcf44c12411599c7ce63b40cbeec541a65533bcaee58d067e3fb15ec13e44.png" src="../../_images/7bffcf44c12411599c7ce63b40cbeec541a65533bcaee58d067e3fb15ec13e44.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4d31103459df6aac2e0c2ab810aed04756b4e66d4db6bf4638dc9a134bab897c.png" src="../../_images/4d31103459df6aac2e0c2ab810aed04756b4e66d4db6bf4638dc9a134bab897c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.006408315924969266
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-058">
<h2>Alpha 058<a class="headerlink" href="#alpha-058" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">indneutralize</span><span class="p">(((</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">250</span><span class="p">)</span> <span class="o">*</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">close</span><span class="p">),</span> <span class="n">IndClass</span><span class="o">.</span><span class="n">subindustry</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(((</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha58</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">wvap</span><span class="p">,</span> <span class="n">sector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(-1 * ts_rank(ts_weighted_mean(ts_corr(IndNeutralize(vwap, IndClass.sector), volume, 3), 7), 5))&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-059">
<h2>Alpha 059<a class="headerlink" href="#alpha-059" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">indneutralize</span><span class="p">(((</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ts_delta</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">250</span><span class="p">)</span> <span class="o">*</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">close</span><span class="p">),</span> <span class="n">IndClass</span><span class="o">.</span><span class="n">subindustry</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(((</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_lag</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha59</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">wvap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-ts_rank(ts_weighted_mean(ts_corr(IndNeutralize(vwap, IndClass.industry), volume, 4), 16), 8)&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-060">
<h2>Alpha 060<a class="headerlink" href="#alpha-060" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha060</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-((2 * scale(rank(((((close - low) - (high - close)) / (high - low)) * volume)))) -scale(rank(ts_argmax(close, 10))))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                       <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">))</span>
                       <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_argmax</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">))))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">60</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha060</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 57s, sys: 372 ms, total: 1min 57s
Wall time: 1min 56s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e56d8f591637d4259df3aeb3e9428df92df5941997904ad9e367a8842e316ffb.png" src="../../_images/e56d8f591637d4259df3aeb3e9428df92df5941997904ad9e367a8842e316ffb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d46218c4f483d4920cc31a2f31bec8f3821db0465c36cc2bfa9fe8634ac0f4bc.png" src="../../_images/d46218c4f483d4920cc31a2f31bec8f3821db0465c36cc2bfa9fe8634ac0f4bc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-061">
<h2>Alpha 061<a class="headerlink" href="#alpha-061" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">((</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">16.1219</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">adv180</span><span class="p">,</span> <span class="mf">17.9282</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha061</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;rank((vwap - ts_min(vwap, 16))) &lt; rank(ts_corr(vwap, adv180, 17))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="mi">18</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">61</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha061</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4.58 s, sys: 112 ms, total: 4.69 s
Wall time: 4.64 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f9305830a675cbb8f706732dd8ef1b5e0a033e2725ef22411351987f1ec150a9.png" src="../../_images/f9305830a675cbb8f706732dd8ef1b5e0a033e2725ef22411351987f1ec150a9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>061</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>671704.0</td>
      <td>0.000458</td>
      <td>0.025757</td>
      <td>-0.757755</td>
      <td>-0.009681</td>
      <td>0.000413</td>
      <td>0.010529</td>
      <td>2.317073</td>
    </tr>
    <tr>
      <th>1</th>
      <td>583389.0</td>
      <td>0.000724</td>
      <td>0.025759</td>
      <td>-0.643066</td>
      <td>-0.009615</td>
      <td>0.000599</td>
      <td>0.010819</td>
      <td>0.972222</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/36c642f59d80ff432ff9cbd20f0c9b3c17cf7f5a658294b9df7905e207174d3f.png" src="../../_images/36c642f59d80ff432ff9cbd20f0c9b3c17cf7f5a658294b9df7905e207174d3f.png" />
</div>
</div>
</section>
<section id="alpha-062">
<h2>Alpha 062<a class="headerlink" href="#alpha-062" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv20</span><span class="p">,</span> <span class="mf">22.4101</span><span class="p">),</span> <span class="mf">9.91009</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">rank</span><span class="p">(((</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span><span class="p">)</span> <span class="o">+</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span><span class="p">))</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">rank</span><span class="p">(((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">rank</span><span class="p">(</span><span class="n">high</span><span class="p">)))))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha062</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_corr(vwap, ts_sum(adv20, 22.4101), 9.91009)) &lt; </span>
<span class="sd">    rank(((rank(open) + rank(open)) &lt; (rank(((high + low) / 2)) + rank(high))))) * -1)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv20</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="mi">9</span><span class="p">))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span>
                <span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">62</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha062</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">adv20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.67 s, sys: 36.3 ms, total: 3.71 s
Wall time: 3.64 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/60eb118f90d185c515aa2d66335eb9e311b966a871038f876699b6f86855bcca.png" src="../../_images/60eb118f90d185c515aa2d66335eb9e311b966a871038f876699b6f86855bcca.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>062</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>1227397.0</td>
      <td>0.000582</td>
      <td>0.025877</td>
      <td>-0.757755</td>
      <td>-0.009697</td>
      <td>0.000496</td>
      <td>0.010711</td>
      <td>2.317073</td>
    </tr>
    <tr>
      <th>0</th>
      <td>27696.0</td>
      <td>0.000545</td>
      <td>0.019795</td>
      <td>-0.441048</td>
      <td>-0.007788</td>
      <td>0.000648</td>
      <td>0.008919</td>
      <td>0.436170</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f5b20b3cf6157209aff20cf3cd9d2c109090e01ddc53e82b08eb398010645ab2.png" src="../../_images/f5b20b3cf6157209aff20cf3cd9d2c109090e01ddc53e82b08eb398010645ab2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
<span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-063">
<h2>Alpha 063<a class="headerlink" href="#alpha-063" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="n">IndClass</span><span class="o">.</span><span class="n">industry</span><span class="p">),</span> <span class="mf">2.25164</span><span class="p">),</span> <span class="mf">8.22237</span><span class="p">))</span><span class="o">-</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(((</span><span class="n">vwap</span> <span class="o">*</span> <span class="mf">0.318108</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">open</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.318108</span><span class="p">))),</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv180</span><span class="p">,</span><span class="mf">37.2467</span><span class="p">),</span> <span class="mf">13.557</span><span class="p">),</span> <span class="mf">12.2883</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha63</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">wvap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_weighted_mean(ts_delta(IndNeutralize(close, IndClass.industry), 2), 8)) - </span>
<span class="sd">        rank(ts_weighted_mean(ts_corr(((vwap * 0.318108) + (open * (1 - 0.318108))), </span>
<span class="sd">                                        ts_sum(adv180, 37), 13), 12))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">63</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%time</span>
<span class="c1"># alphas[f&#39;{alpha:03}&#39;] = alpha48(o, c)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alphas[f&#39;{alpha:03}&#39;].to_hdf(&#39;alphas.h5&#39;, f&#39;alphas/{alpha:03}&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.distplot(alphas[f&#39;{alpha:03}&#39;]);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># g = sns.jointplot(x=f&#39;{alpha:03}&#39;, y=&#39;ret_fwd&#39;, data=alphas);</span>
<span class="c1"># </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
<span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-064">
<h2>Alpha 064<a class="headerlink" href="#alpha-064" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha064</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_corr(ts_sum(((open * 0.178404) + (low * (1 - 0.178404))), 12.7054),ts_sum(adv120, 12.7054), 16.6208)) &lt;</span>
<span class="sd">        rank(ts_delta(((((high + low) / 2) * 0.178404) + (vwap * (1 -0.178404))), 3.69741))) * -1)&quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.178404</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)),</span> <span class="mi">12</span><span class="p">),</span>
                         <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">16</span><span class="p">))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                               <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)),</span> <span class="mi">3</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">64</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha064</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.74 s, sys: 40.3 ms, total: 3.79 s
Wall time: 3.69 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>064</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>590330.0</td>
      <td>0.000463</td>
      <td>0.025842</td>
      <td>-0.757755</td>
      <td>-0.009714</td>
      <td>0.000410</td>
      <td>0.010584</td>
      <td>2.317073</td>
    </tr>
    <tr>
      <th>0</th>
      <td>664763.0</td>
      <td>0.000687</td>
      <td>0.025683</td>
      <td>-0.619752</td>
      <td>-0.009595</td>
      <td>0.000576</td>
      <td>0.010741</td>
      <td>0.869835</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8f0b72593e9ca8c7434c89ca504fc8ad30c9e063936bf82e8cb73d3c2960e859.png" src="../../_images/8f0b72593e9ca8c7434c89ca504fc8ad30c9e063936bf82e8cb73d3c2960e859.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/35400f6afa9b24850efc4cc00f6e0f5f803719e1398f145e799dec58ef261d21.png" src="../../_images/35400f6afa9b24850efc4cc00f6e0f5f803719e1398f145e799dec58ef261d21.png" />
</div>
</div>
</section>
<section id="alpha-065">
<h2>Alpha 065<a class="headerlink" href="#alpha-065" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(((</span><span class="nb">open</span> <span class="o">*</span> <span class="mf">0.00817205</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.00817205</span><span class="p">))),</span> 
                        <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv60</span><span class="p">,</span><span class="mf">8.6911</span><span class="p">),</span> <span class="mf">6.40374</span><span class="p">))</span> <span class="o">&lt;</span> 
        <span class="n">rank</span><span class="p">((</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="mf">13.635</span><span class="p">))))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha065</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_corr(((open * 0.00817205) + (vwap * (1 - 0.00817205))), </span>
<span class="sd">                        ts_sum(adv60,8.6911), 6.40374)) &lt; </span>
<span class="sd">        rank((open - ts_min(open, 13.635)))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.00817205</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)),</span>
                         <span class="n">ts_mean</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">6</span><span class="p">))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="mi">13</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">65</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha065</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.83 s, sys: 32 ms, total: 3.86 s
Wall time: 3.79 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f6d891bc9781b33fdfce51b2b5f61cfb27d667e602407c7aec3034dc1594b3d6.png" src="../../_images/f6d891bc9781b33fdfce51b2b5f61cfb27d667e602407c7aec3034dc1594b3d6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/39848c2188500a450b8856f1c5eda6ad19278a710272f52b85270592cff38405.png" src="../../_images/39848c2188500a450b8856f1c5eda6ad19278a710272f52b85270592cff38405.png" />
</div>
</div>
</section>
<section id="alpha-066">
<h2>Alpha 066<a class="headerlink" href="#alpha-066" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">3.51013</span><span class="p">),</span> <span class="mf">7.23052</span><span class="p">))</span> <span class="o">+</span> 
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(((((</span><span class="n">low</span><span class="o">*</span> <span class="mf">0.96633</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">low</span> <span class="o">*</span> 
                                    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.96633</span><span class="p">)))</span> <span class="o">-</span> <span class="n">vwap</span><span class="p">)</span> <span class="o">/</span> 
                                    <span class="p">(</span><span class="nb">open</span> <span class="o">-</span> <span class="p">((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))),</span> <span class="mf">11.4157</span><span class="p">),</span> <span class="mf">6.72611</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha066</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_weighted_mean(ts_delta(vwap, 3.51013), 7.23052)) +</span>
<span class="sd">        ts_rank(ts_weighted_mean(((((low* 0.96633) + (low *</span>
<span class="sd">                                    (1 - 0.96633))) - vwap) /</span>
<span class="sd">                                    (open - ((high + low) / 2))), 11.4157), 6.72611)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.96633</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">7</span><span class="p">))</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">))</span>
                                           <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="p">)</span>
                                           <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)),</span> <span class="mi">11</span><span class="p">),</span> <span class="mi">7</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">66</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha066</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min, sys: 257 ms, total: 3min
Wall time: 3min
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ff33e9facf25de4dd8dbc488cd266b756dc76937a4bf6f651dd4afc5f631c262.png" src="../../_images/ff33e9facf25de4dd8dbc488cd266b756dc76937a4bf6f651dd4afc5f631c262.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7083a7bb7266e9ee28917637e680ac4f77ff30865aa1554c447ea0d258589339.png" src="../../_images/7083a7bb7266e9ee28917637e680ac4f77ff30865aa1554c447ea0d258589339.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.009140875589292108
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-067">
<h2>Alpha 067<a class="headerlink" href="#alpha-067" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(((</span><span class="n">close</span> <span class="o">*</span> <span class="mf">0.60733</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">open</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.60733</span><span class="p">))),</span><span class="n">IndClass</span><span class="o">.</span><span class="n">sector</span><span class="p">),</span> <span class="mf">1.23438</span><span class="p">))</span> <span class="o">&lt;</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">Ts_Rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">3.60973</span><span class="p">),</span> <span class="n">Ts_Rank</span><span class="p">(</span><span class="n">adv150</span><span class="p">,</span><span class="mf">9.18637</span><span class="p">),</span> <span class="mf">14.6644</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha067</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sector</span><span class="p">,</span> <span class="n">subindustry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(power(rank((high - ts_min(high, 2.14593))),</span>
<span class="sd">        rank(ts_corr(IndNeutralize(vwap,IndClass.sector), </span>
<span class="sd">                IndNeutralize(adv20, IndClass.subindustry), 6.02936))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">67</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%time</span>
<span class="c1"># alphas[f&#39;{alpha:03}&#39;] = alpha056(r, cap)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alphas[f&#39;{alpha:03}&#39;].to_hdf(&#39;alphas.h5&#39;, f&#39;alphas/{alpha:03}&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.distplot(alphas[f&#39;{alpha:03}&#39;]);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># g = sns.jointplot(x=f&#39;{alpha:03}&#39;, y=&#39;ret_fwd&#39;, data=alphas);</span>
<span class="c1"># </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
<span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-068">
<h2>Alpha 068<a class="headerlink" href="#alpha-068" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">high</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">adv15</span><span class="p">),</span> <span class="mf">8.91644</span><span class="p">),</span> <span class="mf">13.9333</span><span class="p">)</span> <span class="o">&lt;</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(((</span><span class="n">close</span> <span class="o">*</span> <span class="mf">0.518371</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">low</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.518371</span><span class="p">))),</span> <span class="mf">1.06157</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha068</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((ts_rank(ts_corr(rank(high), rank(adv15), 8.91644), 13.9333) &lt;</span>
<span class="sd">        rank(ts_delta(((close * 0.518371) + (low * (1 - 0.518371))), 1.06157))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.518371</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">15</span><span class="p">)),</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">14</span><span class="p">)</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">68</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha068</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2min 54s, sys: 66.2 ms, total: 2min 54s
Wall time: 2min 54s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4de87a6cfe0f2fce1c742582bcb347113fe3d0a4c4404f4de7e1c78b5fbca5eb.png" src="../../_images/4de87a6cfe0f2fce1c742582bcb347113fe3d0a4c4404f4de7e1c78b5fbca5eb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/64fee6459e20c14c3a453f5441a8ce8c5d5767c471504f79d4711f5574601167.png" src="../../_images/64fee6459e20c14c3a453f5441a8ce8c5d5767c471504f79d4711f5574601167.png" />
</div>
</div>
</section>
<section id="alpha-069">
<h2>Alpha 069<a class="headerlink" href="#alpha-069" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">power</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">IndClass</span><span class="o">.</span><span class="n">industry</span><span class="p">),</span> <span class="mf">2.72412</span><span class="p">),</span><span class="mf">4.79344</span><span class="p">)),</span>
        <span class="n">Ts_Rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(((</span><span class="n">close</span> <span class="o">*</span> <span class="mf">0.490655</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.490655</span><span class="p">))),</span> <span class="n">adv20</span><span class="p">,</span> <span class="mf">4.92416</span><span class="p">),</span><span class="mf">9.0615</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha069</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((power(rank(ts_max(ts_delta(IndNeutralize(vwap, IndClass.industry), 2.72412),4.79344)),</span>
<span class="sd">    Ts_Rank(ts_corr(((close * 0.490655) + (vwap * (1 - 0.490655))), adv20, 4.92416),9.0615))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-070">
<h2>Alpha 070<a class="headerlink" href="#alpha-070" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">power</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">1.29456</span><span class="p">)),</span>
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(</span><span class="n">close</span><span class="p">,</span><span class="n">IndClass</span><span class="o">.</span><span class="n">industry</span><span class="p">),</span> <span class="n">adv50</span><span class="p">,</span> <span class="mf">17.8256</span><span class="p">),</span> <span class="mf">17.9171</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha076</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((power(rank(ts_delta(vwap, 1.29456)),</span>
<span class="sd">        ts_rank(ts_corr(IndNeutralize(close, IndClass.industry), adv50, 17.8256), 17.9171))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">70</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-071">
<h2>Alpha 071<a class="headerlink" href="#alpha-071" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha071</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;max(ts_rank(ts_weighted_mean(ts_corr(ts_rank(close, 3.43976), ts_rank(adv180,12.0647), 18.0175), 4.20501), 15.6948), </span>
<span class="sd">            ts_rank(ts_weighted_mean((rank(((low + open) - (vwap +vwap)))^2), 16.4662), 4.4388))&quot;&quot;&quot;</span>

    <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                           <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">18</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">16</span><span class="p">))</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span>
                                        <span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
                                   <span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">16</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&gt;</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">71</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha071</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 9min 28s, sys: 81.3 ms, total: 9min 29s
Wall time: 9min 28s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e035ef0b95a58ec4957d74bee05da6e3f9e0a478885ad90299a96fdd7be48cdb.png" src="../../_images/e035ef0b95a58ec4957d74bee05da6e3f9e0a478885ad90299a96fdd7be48cdb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f4ae62e82cd707e7fdd549829ec7a184105418455a9f4c9f3379cecd363bfe7d.png" src="../../_images/f4ae62e82cd707e7fdd549829ec7a184105418455a9f4c9f3379cecd363bfe7d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002330970321091197
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-072">
<h2>Alpha 072<a class="headerlink" href="#alpha-072" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">adv40</span><span class="p">,</span> <span class="mf">8.93345</span><span class="p">),</span> <span class="mf">10.1519</span><span class="p">))</span> <span class="o">/</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">3.72469</span><span class="p">),</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mf">18.5188</span><span class="p">),</span> <span class="mf">6.86671</span><span class="p">),</span> <span class="mf">2.95011</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha072</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_weighted_mean(ts_corr(((high + low) / 2), adv40, 8.93345), 10.1519)) /</span>
<span class="sd">        rank(ts_weighted_mean(ts_corr(ts_rank(vwap, 3.72469), ts_rank(volume, 18.5188), 6.86671), 2.95011)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">10</span><span class="p">))</span>
            <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">72</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha072</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6min 5s, sys: 95.2 ms, total: 6min 5s
Wall time: 6min 4s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f85f63b73cc9fd59010f7ed724c073bc0255c918dd8e13bafc549d4007c6560f.png" src="../../_images/f85f63b73cc9fd59010f7ed724c073bc0255c918dd8e13bafc549d4007c6560f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0e6559b570979e299562ac5d9279eda2158e8768b490a345d014829edff862da.png" src="../../_images/0e6559b570979e299562ac5d9279eda2158e8768b490a345d014829edff862da.png" />
</div>
</div>
</section>
<section id="alpha-073">
<h2>Alpha 073<a class="headerlink" href="#alpha-073" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">4.72775</span><span class="p">),</span> <span class="mf">2.91864</span><span class="p">)),</span>
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(((</span><span class="n">ts_delta</span><span class="p">(((</span><span class="nb">open</span> <span class="o">*</span> <span class="mf">0.147155</span><span class="p">)</span> <span class="o">+</span> 
            <span class="p">(</span><span class="n">low</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.147155</span><span class="p">))),</span> <span class="mf">2.03608</span><span class="p">)</span> <span class="o">/</span> 
            <span class="p">((</span><span class="nb">open</span> <span class="o">*</span><span class="mf">0.147155</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">low</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.147155</span><span class="p">))))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">3.33829</span><span class="p">),</span> <span class="mf">16.7411</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha073</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(max(rank(ts_weighted_mean(ts_delta(vwap, 4.72775), 2.91864)),</span>
<span class="sd">        ts_rank(ts_weighted_mean(((ts_delta(((open * 0.147155) + </span>
<span class="sd">            (low * (1 - 0.147155))), 2.03608) / </span>
<span class="sd">            ((open *0.147155) + (low * (1 - 0.147155)))) * -1), 3.33829), 16.7411)) * -1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.147155</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
                                   <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">16</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&gt;</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">73</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha073</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ticker         A   AAL   AAP  AAPL   ABC  ABT   ACN  ADBE   ADI   ADM  ...  \
date                                                                   ...   
2007-01-04   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN  ...   
2007-01-05   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN  ...   
2007-01-08   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN  ...   
2007-01-09   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN  ...   
2007-01-10   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN  ...   
...          ...   ...   ...   ...   ...  ...   ...   ...   ...   ...  ...   
2016-12-22   8.0   5.0  11.0  12.0   9.0  7.0  16.0  10.0   6.0  14.0  ...   
2016-12-23  10.0  14.0  15.0  14.0  12.0  6.0  15.0  12.0   8.0  15.0  ...   
2016-12-27   7.0  16.0  13.0  13.0  10.0  5.0  12.0  11.0   7.0  13.0  ...   
2016-12-28  11.0  16.0  10.0  11.0   7.0  6.0  12.0  14.0   7.0  11.0  ...   
2016-12-29  14.0  16.0  10.0  12.0   6.0  9.0  12.0  14.0  13.0   9.0  ...   

ticker       XEC   XEL    XL  XLNX   XOM  XRAY   XRX   YUM   ZBH  ZION  
date                                                                    
2007-01-04   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  
2007-01-05   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  
2007-01-08   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  
2007-01-09   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  
2007-01-10   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  
...          ...   ...   ...   ...   ...   ...   ...   ...   ...   ...  
2016-12-22  13.0  10.0   3.0   5.0  15.0  13.0  10.0  11.0  11.0   9.0  
2016-12-23  12.0  11.0   4.0   7.0   9.0  14.0  14.0  12.0   9.0  10.0  
2016-12-27   8.0  11.0   4.0   9.0   6.0  11.0  13.0  12.0   7.0  12.0  
2016-12-28   7.0  15.0   7.0  11.0   8.0  14.0  15.0  11.0   5.0  12.0  
2016-12-29   8.0  16.0  13.0  16.0  15.0  16.0  15.0  13.0   5.0  15.0  

[2516 rows x 500 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/30a7607d6d0b331d29ee1b32e416a12cf0c1b36676b5164a2730e0d7d28af44b.png" src="../../_images/30a7607d6d0b331d29ee1b32e416a12cf0c1b36676b5164a2730e0d7d28af44b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a0089c2c1a91947da89beff5a07b93d0b3848403134d47911d62e095bd375adf.png" src="../../_images/a0089c2c1a91947da89beff5a07b93d0b3848403134d47911d62e095bd375adf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0019621236363676076
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-074">
<h2>Alpha 074<a class="headerlink" href="#alpha-074" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv30</span><span class="p">,</span> <span class="mf">37.4843</span><span class="p">),</span> <span class="mf">15.1365</span><span class="p">))</span> <span class="o">&lt;</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(((</span><span class="n">high</span> <span class="o">*</span> <span class="mf">0.0261661</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.0261661</span><span class="p">)))),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mf">11.4791</span><span class="p">)))</span><span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha074</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_corr(close, ts_sum(adv30, 37.4843), 15.1365)) &lt;</span>
<span class="sd">        rank(ts_corr(rank(((high * 0.0261661) + (vwap * (1 - 0.0261661)))), rank(volume), 11.4791)))* -1)&quot;&quot;&quot;</span>

    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.0261661</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="mi">37</span><span class="p">),</span> <span class="mi">15</span><span class="p">))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">))),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">11</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">74</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha074</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4.76 s, sys: 64 ms, total: 4.82 s
Wall time: 4.73 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c3c9c7f74b1614f46510f4ab62f00a2da477be430d64904c46d59626cc9c7018.png" src="../../_images/c3c9c7f74b1614f46510f4ab62f00a2da477be430d64904c46d59626cc9c7018.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c78df3698422c30807ddcbb5b7a3f43a9760878cc215fe755b76ee4f07c8a2ca.png" src="../../_images/c78df3698422c30807ddcbb5b7a3f43a9760878cc215fe755b76ee4f07c8a2ca.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>074</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>598745.0</td>
      <td>0.000563</td>
      <td>0.026009</td>
      <td>-0.757755</td>
      <td>-0.009807</td>
      <td>0.000456</td>
      <td>0.010752</td>
      <td>1.061026</td>
    </tr>
    <tr>
      <th>0</th>
      <td>656348.0</td>
      <td>0.000599</td>
      <td>0.025527</td>
      <td>-0.619752</td>
      <td>-0.009509</td>
      <td>0.000538</td>
      <td>0.010582</td>
      <td>2.317073</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="alpha-075">
<h2>Alpha 075<a class="headerlink" href="#alpha-075" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="mf">4.24304</span><span class="p">))</span> <span class="o">&lt;</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">low</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">adv50</span><span class="p">),</span><span class="mf">12.4413</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha075</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_corr(vwap, volume, 4.24304)) &lt; </span>
<span class="sd">        rank(ts_corr(rank(low), rank(adv50),12.4413)))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">50</span><span class="p">)),</span> <span class="mi">12</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">75</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha075</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4.79 s, sys: 36 ms, total: 4.83 s
Wall time: 4.76 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3527d7112b29629854d5180f64883f9955e58f7a112b7ac051d0a941a55c614a.png" src="../../_images/3527d7112b29629854d5180f64883f9955e58f7a112b7ac051d0a941a55c614a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="o">-</span><span class="mf">.025</span><span class="p">,</span> <span class="mf">.025</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3b80fd2063e290a8387fe4eb983741a28285298b2efe6f1f91e0f11b96ef19d0.png" src="../../_images/3b80fd2063e290a8387fe4eb983741a28285298b2efe6f1f91e0f11b96ef19d0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>075</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>656508.0</td>
      <td>0.000545</td>
      <td>0.026144</td>
      <td>-0.757755</td>
      <td>-0.009674</td>
      <td>0.000472</td>
      <td>0.010631</td>
      <td>2.317073</td>
    </tr>
    <tr>
      <th>1</th>
      <td>598585.0</td>
      <td>0.000621</td>
      <td>0.025328</td>
      <td>-0.607908</td>
      <td>-0.009625</td>
      <td>0.000529</td>
      <td>0.010706</td>
      <td>0.814423</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="alpha-076">
<h2>Alpha 076<a class="headerlink" href="#alpha-076" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(((</span><span class="n">close</span> <span class="o">*</span> <span class="mf">0.60733</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">open</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.60733</span><span class="p">))),</span><span class="n">IndClass</span><span class="o">.</span><span class="n">sector</span><span class="p">),</span> <span class="mf">1.23438</span><span class="p">))</span> <span class="o">&lt;</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">Ts_Rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">3.60973</span><span class="p">),</span> <span class="n">Ts_Rank</span><span class="p">(</span><span class="n">adv150</span><span class="p">,</span><span class="mf">9.18637</span><span class="p">),</span> <span class="mf">14.6644</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha076</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">sector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(max(rank(ts_weighted_mean(ts_delta(vwap, 1.24383), 11.8259)),</span>
<span class="sd">            ts_rank(ts_weighted_mean(ts_rank(ts_corr(IndNeutralize(low, IndClass.sector), adv81,8.14941), 19.569), 17.1543), 19.383)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">76</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-077">
<h2>Alpha 077<a class="headerlink" href="#alpha-077" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">min</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(((((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">+</span> <span class="n">high</span><span class="p">)),</span> <span class="mf">20.0451</span><span class="p">)),</span>
            <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">adv40</span><span class="p">,</span> <span class="mf">3.1614</span><span class="p">),</span> <span class="mf">5.64125</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha077</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;min(rank(ts_weighted_mean(((((high + low) / 2) + high) - (vwap + high)), 20.0451)),</span>
<span class="sd">            rank(ts_weighted_mean(ts_corr(((high + low) / 2), adv40, 3.1614), 5.64125)))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">s1</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">20</span><span class="p">))</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&lt;</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">77</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha077</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.73 s, sys: 16 ms, total: 3.75 s
Wall time: 3.66 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4487f149c794bb753a37d91ed4a66bff7a72b12c85c07fe09666d13b0736aa7f.png" src="../../_images/4487f149c794bb753a37d91ed4a66bff7a72b12c85c07fe09666d13b0736aa7f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3f882053338ba02f48dbfbb3631b08c74363733283a71a2573f0824daa4e245a.png" src="../../_images/3f882053338ba02f48dbfbb3631b08c74363733283a71a2573f0824daa4e245a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-078">
<h2>Alpha 078<a class="headerlink" href="#alpha-078" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(((</span><span class="n">low</span> <span class="o">*</span> <span class="mf">0.352233</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.352233</span><span class="p">))),</span> <span class="mf">19.7428</span><span class="p">),</span>
        <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv40</span><span class="p">,</span> <span class="mf">19.7428</span><span class="p">),</span> <span class="mf">6.83313</span><span class="p">))</span><span class="o">^</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mf">5.77492</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha078</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_corr(ts_sum(((low * 0.352233) + (vwap * (1 - 0.352233))), 19.7428),</span>
<span class="sd">        ts_sum(adv40, 19.7428), 6.83313))^rank(ts_corr(rank(vwap), rank(volume), 5.77492)))&quot;&quot;&quot;</span>

    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.352233</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">((</span><span class="n">l</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">))),</span> <span class="mi">19</span><span class="p">),</span>
                         <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="mi">19</span><span class="p">),</span> <span class="mi">6</span><span class="p">))</span>
            <span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">5</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">78</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha078</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4.67 s, sys: 20 ms, total: 4.69 s
Wall time: 4.59 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d265501ef23e4d07863f366ac546255a7e163c83665cc7a89b4e7cfc58b96b87.png" src="../../_images/d265501ef23e4d07863f366ac546255a7e163c83665cc7a89b4e7cfc58b96b87.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d9b0c515a76e6b6463fe5e037e270262896de5b5ca69ffec753050e8b33a3f10.png" src="../../_images/d9b0c515a76e6b6463fe5e037e270262896de5b5ca69ffec753050e8b33a3f10.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0002397436931129704
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-079">
<h2>Alpha 079<a class="headerlink" href="#alpha-079" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(((</span><span class="n">close</span> <span class="o">*</span> <span class="mf">0.60733</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">open</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.60733</span><span class="p">))),</span><span class="n">IndClass</span><span class="o">.</span><span class="n">sector</span><span class="p">),</span> <span class="mf">1.23438</span><span class="p">))</span> <span class="o">&lt;</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">Ts_Rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">3.60973</span><span class="p">),</span> <span class="n">Ts_Rank</span><span class="p">(</span><span class="n">adv150</span><span class="p">,</span><span class="mf">9.18637</span><span class="p">),</span> <span class="mf">14.6644</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha079</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_delta(IndNeutralize(((close * 0.60733) + (open * (1 - 0.60733))),IndClass.sector), 1.23438)) &lt; </span>
<span class="sd">        rank(ts_corr(Ts_Rank(vwap, 3.60973), Ts_Rank(adv150,9.18637), 14.6644)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-080">
<h2>Alpha 080<a class="headerlink" href="#alpha-080" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">power</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(((</span><span class="nb">open</span> <span class="o">*</span> <span class="mf">0.868128</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">high</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.868128</span><span class="p">))),</span><span class="n">IndClass</span><span class="o">.</span><span class="n">industry</span><span class="p">),</span> <span class="mf">4.04545</span><span class="p">))),</span>
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">adv10</span><span class="p">,</span> <span class="mf">5.11456</span><span class="p">),</span> <span class="mf">5.53756</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha080</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((power(rank(sign(ts_delta(IndNeutralize(((open * 0.868128) + (high * (1 - 0.868128))),IndClass.industry), 4.04545))),</span>
<span class="sd">        ts_rank(ts_corr(high, adv10, 5.11456), 5.53756)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-081">
<h2>Alpha 081<a class="headerlink" href="#alpha-081" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">ts_product</span><span class="p">(</span><span class="n">rank</span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv10</span><span class="p">,</span> <span class="mf">49.6054</span><span class="p">),</span><span class="mf">8.47743</span><span class="p">))</span><span class="o">^</span><span class="mi">4</span><span class="p">)),</span> <span class="mf">14.9655</span><span class="p">)))</span> <span class="o">&lt;</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mf">5.07914</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha081</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-(rank(log(ts_product(rank((rank(ts_corr(vwap, ts_sum(adv10, 49.6054),8.47743))^4)), 14.9655))) &lt;</span>
<span class="sd">        rank(ts_corr(rank(vwap), rank(volume), 5.07914)))&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">ts_product</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span>
                                                  <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">50</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>
                                     <span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="mi">15</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">5</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">81</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha081</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 57s, sys: 593 ms, total: 1min 57s
Wall time: 1min 57s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6b2f9552f5c3501337edeae898ab5e039958c3bdcd105e4975474329b424c41a.png" src="../../_images/6b2f9552f5c3501337edeae898ab5e039958c3bdcd105e4975474329b424c41a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1f614ad3e5fe1267f0efa52ffdc8476464ad9673aa0df338582e8dad185aee0d.png" src="../../_images/1f614ad3e5fe1267f0efa52ffdc8476464ad9673aa0df338582e8dad185aee0d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mi[alpha] = get_mutual_info_score(alphas.ret_fwd, alphas[f&#39;{alpha:03}&#39;])</span>
<span class="c1"># mi[alpha]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-082">
<h2>Alpha 082<a class="headerlink" href="#alpha-082" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">returns</span> <span class="o">*</span> <span class="n">cap</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha082</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(min(rank(ts_weighted_mean(ts_delta(open, 1.46063), 14.8717)),</span>
<span class="sd">        ts_rank(ts_weighted_mean(ts_corr(IndNeutralize(volume, IndClass.sector), </span>
<span class="sd">        ((open * 0.634196) +(open * (1 - 0.634196))), 17.4842), 6.92131), 13.4283)) * -1)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-083">
<h2>Alpha 083<a class="headerlink" href="#alpha-083" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">((</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">))</span> <span class="o">/</span> 
    <span class="p">(((</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">close</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha083</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_lag((high - low) / ts_mean(close, 5), 2)) * rank(rank(volume)) / </span>
<span class="sd">            (((high - low) / ts_mean(close, 5) / (vwap - close)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_lag</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
                 <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
                 <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">83</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha083</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.8 s, sys: 16 ms, total: 2.81 s
Wall time: 2.75 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ae7155a79b40722ae9ed2faaa2b2b803fa181a0172d69b7b86f4803932b293f5.png" src="../../_images/ae7155a79b40722ae9ed2faaa2b2b803fa181a0172d69b7b86f4803932b293f5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f73b200b38660cc24bd3b9a312dbd9997139b77c9f7e15b81ed3a62961cb24a1.png" src="../../_images/f73b200b38660cc24bd3b9a312dbd9997139b77c9f7e15b81ed3a62961cb24a1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0005100117425032025
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-084">
<h2>Alpha 084<a class="headerlink" href="#alpha-084" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">power</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">((</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">ts_max</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">15.3217</span><span class="p">)),</span> <span class="mf">20.7127</span><span class="p">),</span> 
            <span class="n">ts_delta</span><span class="p">(</span><span class="n">close</span><span class="p">,</span><span class="mf">4.96796</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha084</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;power(ts_rank((vwap - ts_max(vwap, 15.3217)), 20.7127), </span>
<span class="sd">        ts_delta(close,4.96796))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_max</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">15</span><span class="p">)),</span> <span class="mi">20</span><span class="p">),</span>
                       <span class="n">ts_delta</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">84</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha084</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 2s, sys: 47.7 ms, total: 3min 2s
Wall time: 3min 2s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e7cf4ce5b0f207b1885af765dbef119c6f63eefe3f6713a6ae677c543ca6384c.png" src="../../_images/e7cf4ce5b0f207b1885af765dbef119c6f63eefe3f6713a6ae677c543ca6384c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fc1d1fa54ba01e01fef90101d64a9793edde104c719beb49233f9efcf2eed9ef.png" src="../../_images/fc1d1fa54ba01e01fef90101d64a9793edde104c719beb49233f9efcf2eed9ef.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.008688359695486092
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-085">
<h2>Alpha 085<a class="headerlink" href="#alpha-085" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">power</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(((</span><span class="n">high</span> <span class="o">*</span> <span class="mf">0.876703</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">close</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.876703</span><span class="p">))),</span> <span class="n">adv30</span><span class="p">,</span><span class="mf">9.61331</span><span class="p">)),</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">3.70596</span><span class="p">),</span> 
                     <span class="n">ts_rank</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mf">10.1595</span><span class="p">),</span><span class="mf">7.11408</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha085</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;power(rank(ts_corr(((high * 0.876703) + (close * (1 - 0.876703))), adv30,9.61331)),</span>
<span class="sd">        rank(ts_corr(ts_rank(((high + low) / 2), 3.70596), </span>
<span class="sd">                     ts_rank(volume, 10.1595),7.11408)))</span>
<span class="sd">                     &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.876703</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)),</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="mi">10</span><span class="p">))</span>
            <span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
                              <span class="n">ts_rank</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">7</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">85</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha085</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6min 14s, sys: 123 ms, total: 6min 14s
Wall time: 6min 14s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0eaddc4fecdcd877205fd7fd4be72553db65b8a87cee7fcb5e7a20d8056d40c0.png" src="../../_images/0eaddc4fecdcd877205fd7fd4be72553db65b8a87cee7fcb5e7a20d8056d40c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f72c30624f6b4e1f5595a6b8f36d6142e9a30e224675da025b4177edcac265b0.png" src="../../_images/f72c30624f6b4e1f5595a6b8f36d6142e9a30e224675da025b4177edcac265b0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.001101338196749957
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-086">
<h2>Alpha 086<a class="headerlink" href="#alpha-086" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv20</span><span class="p">,</span> <span class="mf">14.7444</span><span class="p">),</span> <span class="mf">6.00049</span><span class="p">),</span> <span class="mf">20.4195</span><span class="p">)</span> <span class="o">&lt;</span> 
        <span class="n">rank</span><span class="p">(((</span><span class="nb">open</span> <span class="o">+</span> <span class="n">close</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">+</span> <span class="nb">open</span><span class="p">))))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha086</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((ts_rank(ts_corr(close, ts_sum(adv20, 14.7444), 6.00049), 20.4195) &lt; </span>
<span class="sd">        rank(((open + close) - (vwap + open)))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">15</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">vwap</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">86</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha086</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 2s, sys: 152 ms, total: 3min 2s
Wall time: 3min 2s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/96831051427c1c1bb6147ab0f15d74f952f89b787e153c59d6e5b55c1c5a3ba7.png" src="../../_images/96831051427c1c1bb6147ab0f15d74f952f89b787e153c59d6e5b55c1c5a3ba7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3b27f73abd5b179848ade1ffcc673756c5a9fd6c8d0279399c0dabab64cadee6.png" src="../../_images/3b27f73abd5b179848ade1ffcc673756c5a9fd6c8d0279399c0dabab64cadee6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00020642450841457105
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-087">
<h2>Alpha 087<a class="headerlink" href="#alpha-087" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(max(rank(ts_weighted_mean(ts_delta(((close * 0.369701) + (vwap * (1 - 0.369701))),1.91233), 2.65461)), 
            ts_rank(ts_weighted_mean(abs(ts_corr(IndNeutralize(adv81,IndClass.industry), close, 13.4132)), 4.89768), 14.4535)) * -1)
            ```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha087</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(max(rank(ts_weighted_mean(ts_delta(((close * 0.369701) + (vwap * (1 - 0.369701))),1.91233), 2.65461)), </span>
<span class="sd">            ts_rank(ts_weighted_mean(abs(ts_corr(IndNeutralize(adv81,IndClass.industry), close, 13.4132)), 4.89768), 14.4535)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-088">
<h2>Alpha 088<a class="headerlink" href="#alpha-088" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">min</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(((</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span><span class="p">)</span> <span class="o">+</span> <span class="n">rank</span><span class="p">(</span><span class="n">low</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">high</span><span class="p">)</span> <span class="o">+</span> <span class="n">rank</span><span class="p">(</span><span class="n">close</span><span class="p">))),</span><span class="mf">8.06882</span><span class="p">)),</span> 
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mf">8.44728</span><span class="p">),</span> 
                <span class="n">ts_rank</span><span class="p">(</span><span class="n">adv60</span><span class="p">,</span><span class="mf">20.6966</span><span class="p">),</span> <span class="mf">8.01266</span><span class="p">),</span> <span class="mf">6.65053</span><span class="p">),</span> <span class="mf">2.61957</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha088</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;min(rank(ts_weighted_mean(((rank(open) + rank(low)) - (rank(high) + rank(close))),8.06882)), </span>
<span class="sd">        ts_rank(ts_weighted_mean(ts_corr(ts_rank(close, 8.44728), </span>
<span class="sd">                ts_rank(adv60,20.6966), 8.01266), 6.65053), 2.61957))&quot;&quot;&quot;</span>

    <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
                                <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
                                <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
                                <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span> <span class="mi">8</span><span class="p">)))</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                                          <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">8</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&lt;</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">88</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha088</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6min 7s, sys: 79.6 ms, total: 6min 7s
Wall time: 6min 7s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e613d2a649201fe970e2a69259991727e29fc1c43024ea1051f9ea37b0bc507a.png" src="../../_images/e613d2a649201fe970e2a69259991727e29fc1c43024ea1051f9ea37b0bc507a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1b454c3b355618e9123d474243a6fca75e82a901503b03d19846ea560c76292c.png" src="../../_images/1b454c3b355618e9123d474243a6fca75e82a901503b03d19846ea560c76292c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.019146991360432075
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-089">
<h2>Alpha 089<a class="headerlink" href="#alpha-089" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">returns</span> <span class="o">*</span> <span class="n">cap</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha089</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(ts_rank(ts_weighted_mean(ts_corr(((low * 0.967285) + </span>
<span class="sd">        (low * (1 - 0.967285))), adv10,6.94279), 5.51607), 3.79744) - </span>
<span class="sd">        ts_rank(ts_weighted_mean(ts_delta(IndNeutralize(vwap,IndClass.industry), 3.48158), 10.1466), 15.3012))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-090">
<h2>Alpha 090<a class="headerlink" href="#alpha-090" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">returns</span> <span class="o">*</span> <span class="n">cap</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha090</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">subindustry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank((close - ts_max(close, 4.66719)))</span>
<span class="sd">        ^ts_rank(ts_corr(IndNeutralize(adv40,IndClass.subindustry), low, 5.38375), 3.21856)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-091">
<h2>Alpha 091<a class="headerlink" href="#alpha-091" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(</span><span class="n">close</span><span class="p">,</span><span class="n">IndClass</span><span class="o">.</span><span class="n">industry</span><span class="p">),</span> <span class="n">volume</span><span class="p">,</span> <span class="mf">9.74928</span><span class="p">),</span> <span class="mf">16.398</span><span class="p">),</span> <span class="mf">3.83219</span><span class="p">),</span> <span class="mf">4.8667</span><span class="p">)</span> <span class="o">-</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">adv30</span><span class="p">,</span> <span class="mf">4.01303</span><span class="p">),</span> <span class="mf">2.6809</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha091</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((ts_rank(ts_weighted_mean(ts_weighted_mean(ts_corr(IndNeutralize(close,IndClass.industry), volume, 9.74928), 16.398), 3.83219), 4.8667) -</span>
<span class="sd">        rank(ts_weighted_mean(ts_corr(vwap, adv30, 4.01303), 2.6809))) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-092">
<h2>Alpha 092<a class="headerlink" href="#alpha-092" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">min</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(((((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">close</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="nb">open</span><span class="p">)),</span> <span class="mf">14.7221</span><span class="p">),</span><span class="mf">18.8683</span><span class="p">),</span> 
            <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">low</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">adv30</span><span class="p">),</span> <span class="mf">7.58555</span><span class="p">),</span> <span class="mf">6.94024</span><span class="p">),</span><span class="mf">6.80584</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha092</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;min(ts_rank(ts_weighted_mean(((((high + low) / 2) + close) &lt; (low + open)), 14.7221),18.8683), </span>
<span class="sd">            ts_rank(ts_weighted_mean(ts_corr(rank(low), rank(adv30), 7.58555), 6.94024),6.80584))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">o</span><span class="p">)),</span> <span class="mi">15</span><span class="p">),</span> <span class="mi">18</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">30</span><span class="p">)),</span> <span class="mi">7</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p1</span><span class="o">&lt;</span><span class="n">p2</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">92</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha092</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4min 33s, sys: 39.8 ms, total: 4min 34s
Wall time: 4min 33s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fbe691599f01fb3da8ccb54b654b3bcda579e053257ab957c640b33735e147b4.png" src="../../_images/fbe691599f01fb3da8ccb54b654b3bcda579e053257ab957c640b33735e147b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6e6eec6db69ee7475913274b6f38314eb81473e2976bdfc08c161eb155d638ce.png" src="../../_images/6e6eec6db69ee7475913274b6f38314eb81473e2976bdfc08c161eb155d638ce.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0034230030791526644
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-093">
<h2>Alpha 093<a class="headerlink" href="#alpha-093" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">IndNeutralize</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">IndClass</span><span class="o">.</span><span class="n">industry</span><span class="p">),</span> <span class="n">adv81</span><span class="p">,</span><span class="mf">17.4193</span><span class="p">),</span> <span class="mf">19.848</span><span class="p">),</span> <span class="mf">7.54455</span><span class="p">)</span> <span class="o">/</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_delta</span><span class="p">(((</span><span class="n">close</span> <span class="o">*</span> <span class="mf">0.524434</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vwap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span><span class="mf">0.524434</span><span class="p">))),</span> <span class="mf">2.77377</span><span class="p">),</span> <span class="mf">16.2664</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha093</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">,</span> <span class="n">industry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(ts_rank(ts_weighted_mean(ts_corr(IndNeutralize(vwap, IndClass.industry), adv81,17.4193), 19.848), 7.54455) / </span>
<span class="sd">        rank(ts_weighted_mean(ts_delta(((close * 0.524434) + (vwap * (1 -0.524434))), 2.77377), 16.2664)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-094">
<h2>Alpha 094<a class="headerlink" href="#alpha-094" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">((</span><span class="n">vwap</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mf">11.5783</span><span class="p">)))</span><span class="o">^</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span><span class="mf">19.6462</span><span class="p">),</span> 
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">adv60</span><span class="p">,</span> <span class="mf">4.02992</span><span class="p">),</span> <span class="mf">18.0926</span><span class="p">),</span> <span class="mf">2.70756</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha094</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank((vwap - ts_min(vwap, 11.5783)))^ts_rank(ts_corr(ts_rank(vwap,19.6462), </span>
<span class="sd">        ts_rank(adv60, 4.02992), 18.0926), 2.70756)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">11</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                                 <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">18</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">94</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha094</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 8min 59s, sys: 164 ms, total: 8min 59s
Wall time: 9min
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a87687a1f30a74a3184f21974bbfa1891404205842392d5f4e69ef2f51b8a0aa.png" src="../../_images/a87687a1f30a74a3184f21974bbfa1891404205842392d5f4e69ef2f51b8a0aa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/75532c54e5fa35c1cfca603f71d49d00877192db5890c9a4e14f00eefeb8285d.png" src="../../_images/75532c54e5fa35c1cfca603f71d49d00877192db5890c9a4e14f00eefeb8285d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.005173119205998944
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-095">
<h2>Alpha 095<a class="headerlink" href="#alpha-095" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">((</span><span class="nb">open</span> <span class="o">-</span> <span class="n">ts_min</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="mf">12.4105</span><span class="p">)))</span> <span class="o">&lt;</span> 
    <span class="n">ts_rank</span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span><span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">19.1351</span><span class="p">),</span> 
    <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv40</span><span class="p">,</span> <span class="mf">19.1351</span><span class="p">),</span> <span class="mf">12.8742</span><span class="p">))</span><span class="o">^</span><span class="mi">5</span><span class="p">),</span> <span class="mf">11.7584</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha095</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank((open - ts_min(open, 12.4105))) &lt; </span>
<span class="sd">        ts_rank((rank(ts_corr(ts_sum(((high + low)/ 2), 19.1351), ts_sum(adv40, 19.1351), 12.8742))^5), 11.7584))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ts_min</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="mi">12</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">19</span><span class="p">),</span>
                                     <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="mi">19</span><span class="p">),</span> <span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="mi">12</span><span class="p">))</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">95</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha095</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3min 3s, sys: 43.9 ms, total: 3min 3s
Wall time: 3min 3s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/80e7d0be16678775b6f84f1e050dd1702c43f5b5023d5ea79bc1efb413b8673e.png" src="../../_images/80e7d0be16678775b6f84f1e050dd1702c43f5b5023d5ea79bc1efb413b8673e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="o">-</span><span class="mf">.025</span><span class="p">,</span> <span class="mf">.025</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dfa9f4e93c77403f579870cbfd23c4a689274f88a4b21431cbba77ae4e8847a6.png" src="../../_images/dfa9f4e93c77403f579870cbfd23c4a689274f88a4b21431cbba77ae4e8847a6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>095</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>42212.0</td>
      <td>0.001107</td>
      <td>0.018945</td>
      <td>-0.441048</td>
      <td>-0.006959</td>
      <td>0.000900</td>
      <td>0.008912</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1212881.0</td>
      <td>0.000563</td>
      <td>0.025963</td>
      <td>-0.757755</td>
      <td>-0.009764</td>
      <td>0.000481</td>
      <td>0.010736</td>
      <td>2.317073</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="alpha-096">
<h2>Alpha 096<a class="headerlink" href="#alpha-096" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="mf">5.83878</span><span class="p">),</span><span class="mf">4.16783</span><span class="p">),</span> <span class="mf">8.38151</span><span class="p">),</span> 
        <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_argmax</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="mf">7.45404</span><span class="p">),</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">adv60</span><span class="p">,</span> <span class="mf">4.13242</span><span class="p">),</span> <span class="mf">3.65459</span><span class="p">),</span> <span class="mf">12.6556</span><span class="p">),</span> <span class="mf">14.0365</span><span class="p">),</span> <span class="mf">13.4143</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha096</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(max(ts_rank(ts_weighted_mean(ts_corr(rank(vwap), rank(volume), 5.83878),4.16783), 8.38151), </span>
<span class="sd">        ts_rank(ts_weighted_mean(ts_argmax(ts_corr(ts_rank(close, 7.45404), ts_rank(adv60, 4.13242), 3.65459), 12.6556), 14.0365), 13.4143)) * -1)&quot;&quot;&quot;</span>
    
    <span class="n">s1</span> <span class="o">=</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_argmax</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                                                    <span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">14</span><span class="p">),</span> <span class="mi">13</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&gt;</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">96</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha096</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 10min 4s, sys: 432 ms, total: 10min 4s
Wall time: 10min 6s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ec2438dc44943f22b1306512ed44fbdae7856764832a523548f64c29d317934.png" src="../../_images/9ec2438dc44943f22b1306512ed44fbdae7856764832a523548f64c29d317934.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b8f1f54b54029d30e30c626e1c1567749ec4c8cd0a38692728907cf38fa3af02.png" src="../../_images/b8f1f54b54029d30e30c626e1c1567749ec4c8cd0a38692728907cf38fa3af02.png" />
</div>
</div>
</section>
<section id="alpha-097">
<h2>Alpha 097<a class="headerlink" href="#alpha-097" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">returns</span> <span class="o">*</span> <span class="n">cap</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha097</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_weighted_mean(ts_delta(IndNeutralize(((low * 0.721001) + </span>
<span class="sd">        (vwap * (1 - 0.721001))),IndClass.industry), 3.3705), 20.4523)) - </span>
<span class="sd">        ts_rank(ts_weighted_mean(ts_rank(ts_corr(Ts_Rank(low,7.87871), </span>
<span class="sd">        ts_rank(adv60, 17.255), 4.97547), 18.5925), 15.7152), 6.71659)) * -1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-098">
<h2>Alpha 098<a class="headerlink" href="#alpha-098" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv5</span><span class="p">,</span> <span class="mf">26.4719</span><span class="p">),</span> <span class="mf">4.58418</span><span class="p">),</span> <span class="mf">7.18088</span><span class="p">))</span> <span class="o">-</span>
        <span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_tank</span><span class="p">(</span><span class="n">ts_argmin</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="nb">open</span><span class="p">),</span> 
        <span class="n">rank</span><span class="p">(</span><span class="n">adv15</span><span class="p">),</span> <span class="mf">20.8187</span><span class="p">),</span> <span class="mf">8.62571</span><span class="p">),</span><span class="mf">6.95668</span><span class="p">),</span> <span class="mf">8.07206</span><span class="p">)))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha098</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(rank(ts_weighted_mean(ts_corr(vwap, ts_sum(adv5, 26.4719), 4.58418), 7.18088)) -</span>
<span class="sd">        rank(ts_weighted_mean(ts_tank(ts_argmin(ts_corr(rank(open), </span>
<span class="sd">        rank(adv15), 20.8187), 8.62571),6.95668), 8.07206)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">adv5</span> <span class="o">=</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">adv15</span> <span class="o">=</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">vwap</span><span class="p">,</span> <span class="n">ts_mean</span><span class="p">(</span><span class="n">adv5</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">7</span><span class="p">))</span>
            <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_weighted_mean</span><span class="p">(</span><span class="n">ts_rank</span><span class="p">(</span><span class="n">ts_argmin</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">o</span><span class="p">),</span>
                                                                 <span class="n">rank</span><span class="p">(</span><span class="n">adv15</span><span class="p">),</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">8</span><span class="p">),</span> <span class="mi">6</span><span class="p">))))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">98</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha098</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vwap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4min 54s, sys: 389 ms, total: 4min 54s
Wall time: 4min 54s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5cb49e6f3886f693c15193ff29e4e118706e01ee94175ac1bf552e5b4ec06f25.png" src="../../_images/5cb49e6f3886f693c15193ff29e4e118706e01ee94175ac1bf552e5b4ec06f25.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f82475adb8a728591a1755c9d8ba15958e5d4b01359fe6f2e60b16af502daac6.png" src="../../_images/f82475adb8a728591a1755c9d8ba15958e5d4b01359fe6f2e60b16af502daac6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-099">
<h2>Alpha 099<a class="headerlink" href="#alpha-099" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(((</span><span class="n">high</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">19.8975</span><span class="p">),</span> 
                    <span class="n">ts_sum</span><span class="p">(</span><span class="n">adv60</span><span class="p">,</span> <span class="mf">19.8975</span><span class="p">),</span> <span class="mf">8.8136</span><span class="p">))</span> <span class="o">&lt;</span>
                    <span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="mf">6.28259</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha099</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((rank(ts_corr(ts_sum(((high + low) / 2), 19.8975), </span>
<span class="sd">                    ts_sum(adv60, 19.8975), 8.8136)) &lt;</span>
<span class="sd">                    rank(ts_corr(low, volume, 6.28259))) * -1)&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">((</span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">19</span><span class="p">),</span>
                          <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="mi">19</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>
             <span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
             <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha099</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 4.53 s, sys: 21 µs, total: 4.53 s
Wall time: 4.44 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/07c5306ac894cc1aa15331ccb9b5a33c576094e2e7aa23014bc16e77e85c52d4.png" src="../../_images/07c5306ac894cc1aa15331ccb9b5a33c576094e2e7aa23014bc16e77e85c52d4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d728187ae7adb64084f8b8c9f78c48b00a7865b168110eb92034aee6fb1385f6.png" src="../../_images/d728187ae7adb64084f8b8c9f78c48b00a7865b168110eb92034aee6fb1385f6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">ret_fwd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>099</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>604583.0</td>
      <td>0.000537</td>
      <td>0.026239</td>
      <td>-0.757755</td>
      <td>-0.009783</td>
      <td>0.000448</td>
      <td>0.010714</td>
      <td>2.317073</td>
    </tr>
    <tr>
      <th>0</th>
      <td>650510.0</td>
      <td>0.000622</td>
      <td>0.025303</td>
      <td>-0.643066</td>
      <td>-0.009524</td>
      <td>0.000547</td>
      <td>0.010625</td>
      <td>1.061026</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="alpha-100">
<h2>Alpha 100<a class="headerlink" href="#alpha-100" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_sum</span><span class="p">(</span><span class="n">ts_sum</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">rank</span><span class="p">((</span><span class="n">returns</span> <span class="o">*</span> <span class="n">cap</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha100</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(0 - (1 * (((1.5 * scale(indneutralize(</span>
<span class="sd">                indneutralize(rank(((((close - low) - (high -close)) / (high - low)) * volume)), </span>
<span class="sd">                                IndClass.subindustry), IndClass.subindustry))) - </span>
<span class="sd">    scale(indneutralize((ts_corr(close, rank(adv20), 5) - rank(ts_argmin(close, 30))), IndClass.subindustry))) * (volume / adv20))))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="alpha-101">
<h2>Alpha 101<a class="headerlink" href="#alpha-101" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ts_max</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">ts_corr</span><span class="p">(</span><span class="n">rank</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">rank</span><span class="p">(</span><span class="n">vwap</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alpha101</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;((close - open) / ((high - low) + .001))&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">))</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swaplevel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">101</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha101</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.89 s, sys: 12 ms, total: 1.9 s
Wall time: 1.87 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;alphas/</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1e4f28d949f642759b429da8f0fee85f5bd9c61ea9f4076100cb43fafa9037d9.png" src="../../_images/1e4f28d949f642759b429da8f0fee85f5bd9c61ea9f4076100cb43fafa9037d9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ret_fwd&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">alphas</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/aff02427f1555ce61331da4dc13a82d9ee548da0667fb4e02b18b75bdfe1b766.png" src="../../_images/aff02427f1555ce61331da4dc13a82d9ee548da0667fb4e02b18b75bdfe1b766.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_mutual_info_score</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">ret_fwd</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s1">03</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">mi</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0008757897861757513
</pre></div>
</div>
</div>
</div>
</section>
<section id="store-results">
<h2>Store results<a class="headerlink" href="#store-results" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s1">&#39;alphas.h5&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">store</span><span class="p">:</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">store</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">null_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
MultiIndex: 1255093 entries, (&#39;A&#39;, Timestamp(&#39;2007-01-04 00:00:00&#39;)) to (&#39;ZION&#39;, Timestamp(&#39;2016-12-29 00:00:00&#39;))
Data columns (total 82 columns):
 #   Column  Non-Null Count    Dtype  
---  ------  --------------    -----  
 0   1       1243849 non-null  float64
 1   2       1243080 non-null  float64
 2   3       1227126 non-null  float64
 3   4       1250757 non-null  float64
 4   5       1247733 non-null  float64
 5   6       1250204 non-null  float64
 6   7       1241633 non-null  float64
 7   8       1247172 non-null  float64
 8   9       1247548 non-null  float64
 9   10      1247548 non-null  float64
 10  11      1245756 non-null  float64
 11  12      1247548 non-null  float64
 12  13      1243849 non-null  float64
 13  14      1250204 non-null  float64
 14  15      1048657 non-null  float64
 15  16      1252899 non-null  float64
 16  17      1240819 non-null  float64
 17  18      1240862 non-null  float64
 18  19      1127248 non-null  float64
 19  20      1250162 non-null  float64
 20  21      1255093 non-null  int64  
 21  22      1235676 non-null  float64
 22  23      1255093 non-null  float64
 23  24      1247006 non-null  float64
 24  25      1244833 non-null  float64
 25  26      1163949 non-null  float64
 26  27      1255093 non-null  float64
 27  28      1242843 non-null  float64
 28  29      1240358 non-null  float64
 29  30      1243877 non-null  float64
 30  31      2368 non-null     float64
 31  32      1126346 non-null  float64
 32  33      1250702 non-null  float64
 33  34      1246900 non-null  float64
 34  35      1237517 non-null  float64
 35  36      1144017 non-null  float64
 36  37      1143512 non-null  float64
 37  38      1247733 non-null  float64
 38  39      1123375 non-null  float64
 39  40      1250204 non-null  float64
 40  41      1255093 non-null  float64
 41  42      1250702 non-null  float64
 42  43      1235049 non-null  float64
 43  44      1249557 non-null  float64
 44  45      1226678 non-null  float64
 45  46      1247676 non-null  float64
 46  47      1244823 non-null  float64
 47  49      1254955 non-null  float64
 48  50      1181356 non-null  float64
 49  51      1254967 non-null  float64
 50  52      1132298 non-null  float64
 51  53      1244431 non-null  float64
 52  54      1255093 non-null  float64
 53  55      1243526 non-null  float64
 54  57      1229293 non-null  float64
 55  60      1250224 non-null  float64
 56  61      1255093 non-null  int64  
 57  62      1255093 non-null  int64  
 58  64      1255093 non-null  int64  
 59  65      1255093 non-null  int64  
 60  66      1240293 non-null  float64
 61  68      1255093 non-null  int64  
 62  71      1239293 non-null  float64
 63  72      6612 non-null     float64
 64  73      1238793 non-null  float64
 65  74      1255093 non-null  int64  
 66  75      1255093 non-null  int64  
 67  77      1206268 non-null  float64
 68  78      1191505 non-null  float64
 69  81      1255093 non-null  int64  
 70  83      1251765 non-null  float64
 71  84      1237712 non-null  float64
 72  85      1219026 non-null  float64
 73  86      1255093 non-null  int64  
 74  88      33449 non-null    float64
 75  92      609037 non-null   float64
 76  94      1182264 non-null  float64
 77  95      1255093 non-null  int64  
 78  96      53769 non-null    float64
 79  98      1068846 non-null  float64
 80  99      1255093 non-null  int64  
 81  101     1255093 non-null  float64
dtypes: float64(70), int64(12)
memory usage: 790.8+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;factors/formulaic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./0alphas-using qstrader有3sources/计算ipynb_case"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-settings">Imports &amp; Settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-section">Cross-section</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series">Time Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-implementation">Pandas Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#most-traded-stocks">500 most-traded stocks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-data">Input Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-alphas">Evaluate Alphas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-001">Alpha 001</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-002">Alpha 002</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-003">Alpha 003</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-004">Alpha 004</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-005">Alpha 005</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-006">Alpha 006</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-007">Alpha 007</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-008">Alpha 008</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-009">Alpha 009</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-010">Alpha 010</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-011">Alpha 011</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-012">Alpha 012</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-013">Alpha 013</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-014">Alpha 014</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-015">Alpha 015</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-016">Alpha 016</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-017">Alpha 017</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-018">Alpha 018</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-019">Alpha 019</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-020">Alpha 020</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-021">Alpha 021</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-022">Alpha 022</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-023">Alpha 023</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-024">Alpha 024</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-025">Alpha 025</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-026">Alpha 026</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-027">Alpha 027</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-028">Alpha 028</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-029">Alpha 029</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-030">Alpha 030</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-031">Alpha 031</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-032">Alpha 032</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-033">Alpha 033</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-034">Alpha 034</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-035">Alpha 035</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-036">Alpha 036</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-037">Alpha 037</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-038">Alpha 038</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-039">Alpha 039</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-040">Alpha 040</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-041">Alpha 041</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-042">Alpha 042</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-043">Alpha 043</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-044">Alpha 044</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-045">Alpha 045</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-046">Alpha 046</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-047">Alpha 047</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-048">Alpha 048</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-049">Alpha 049</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-050">Alpha 050</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-051">Alpha 051</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-052">Alpha 052</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-053">Alpha 053</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-054">Alpha 054</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-055">Alpha 055</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-056">Alpha 056</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-057">Alpha 057</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-058">Alpha 058</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-059">Alpha 059</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-060">Alpha 060</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-061">Alpha 061</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-062">Alpha 062</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-063">Alpha 063</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-064">Alpha 064</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-065">Alpha 065</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-066">Alpha 066</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-067">Alpha 067</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-068">Alpha 068</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-069">Alpha 069</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-070">Alpha 070</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-071">Alpha 071</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-072">Alpha 072</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-073">Alpha 073</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-074">Alpha 074</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-075">Alpha 075</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-076">Alpha 076</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-077">Alpha 077</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-078">Alpha 078</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-079">Alpha 079</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-080">Alpha 080</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-081">Alpha 081</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-082">Alpha 082</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-083">Alpha 083</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-084">Alpha 084</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-085">Alpha 085</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-086">Alpha 086</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-087">Alpha 087</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-088">Alpha 088</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-089">Alpha 089</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-090">Alpha 090</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-091">Alpha 091</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-092">Alpha 092</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-093">Alpha 093</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-094">Alpha 094</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-095">Alpha 095</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-096">Alpha 096</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-097">Alpha 097</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-098">Alpha 098</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-099">Alpha 099</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-100">Alpha 100</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-101">Alpha 101</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#store-results">Store results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tom Tang
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>