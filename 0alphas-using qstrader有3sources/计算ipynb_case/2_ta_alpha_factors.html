
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Common Alpha Factors &#8212; Tom Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8dedbda2" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '0alphas-using qstrader有3sources/计算ipynb_case/2_ta_alpha_factors';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Tom Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../qc.html">1. Qunat research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb2024.html">2. Notebook 2023-25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb2022.html">3. Notebook &lt;=2022</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/wk" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/0alphas-using qstrader有3sources/计算ipynb_case/2_ta_alpha_factors.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Common Alpha Factors</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ta-lib-function-groups">TA-Lib: Function Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unstable-periods">Unstable periods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-averages">Moving Averages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-moving-average-sma">Simple Moving Average (SMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-moving-average-ema">Exponential Moving Average (EMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-moving-average-wma">Weighted Moving Average (WMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-exponential-moving-average-dema">Double Exponential Moving Average (DEMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triple-exponential-moving-average-tema">Triple Exponential Moving Average (TEMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triangular-moving-average-trima">Triangular Moving Average (TRIMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kaufman-adaptive-moving-average-kama">Kaufman Adaptive Moving Average (KAMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesa-adaptive-moving-average-mama">MESA Adaptive Moving Average (MAMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison">Comparison</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-studies">Overlap Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bollinger-bands">Bollinger Bands</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalized-squeeze-mean-reversion-indicators">Normalized squeeze &amp; mean reversion indicators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-distribution">Visualize Distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-outlier-price-series">Plot outlier price series</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hilbert-transform-instantaneous-trendline">Hilbert Transform - Instantaneous Trendline</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-hilbert-based-normalized-indicator">Compute Hilbert-based normalized indicator</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parabolic-sar">Parabolic SAR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalized-sar-indicator">Normalized SAR indicator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#momentum-indicators">Momentum Indicators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#average-directional-movement-index-adx">Average Directional Movement Index (ADX)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plus-minus-directional-movement-plus-dm-minus-dm">Plus/Minus Directional Movement (PLUS_DM/MINUS_DM)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plus-minus-directional-index-plus-di-minus-di">Plus/Minus Directional Index (PLUS_DI/MINUS_DI)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Average directional movement index (ADX)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Visualize distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#average-directional-movement-index-rating">Average Directional Movement Index Rating</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absolute-price-oscillator-apo">Absolute Price Oscillator (APO)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#percentage-price-oscillator-ppo">Percentage Price Oscillator (PPO)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aroon-oscillator">Aroon Oscillator</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aroon-up-down-indicator">Aroon Up/Down Indicator</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Aroon Oscillator</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balance-of-power-bop">Balance Of Power (BOP)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#commodity-channel-index-cci">Commodity Channel Index (CCI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-average-convergence-divergence-macd">Moving Average Convergence/Divergence (MACD)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chande-momentum-oscillator-cmo">Chande Momentum Oscillator (CMO)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#money-flow-index">Money Flow Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-strength-index">Relative Strength Index</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-rsi-stochrsi">Stochastic RSI (STOCHRSI)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-stoch">Stochastic (STOCH)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ultimate-oscillator-ultosc">Ultimate Oscillator (ULTOSC)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#williams-r-willr">Williams’ %R (WILLR)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#volume-indicators">Volume Indicators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaikin-a-d-line">Chaikin A/D Line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaikin-a-d-oscillator-adosc">Chaikin A/D Oscillator (ADOSC)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#on-balance-volume-obv">On Balance Volume (OBV)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#volatility-indicators">Volatility Indicators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atr">ATR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-normalized-version-of-atr-using-rolling-mean-of-price">Compute normalized version of ATR using rolling mean of price</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#natr">NATR</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-factor-betas">Rolling Factor Betas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#size-proxy">Size proxy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#persist-results">Persist results</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="common-alpha-factors">
<h1>Common Alpha Factors<a class="headerlink" href="#common-alpha-factors" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas_datareader.data</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">web</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.regression.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingOLS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">scale</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">talib</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">deciles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;data/top500&#39;</span><span class="p">)</span>
<span class="n">price_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ta-lib-function-groups">
<h2>TA-Lib: Function Groups<a class="headerlink" href="#ta-lib-function-groups" title="Link to this heading">#</a></h2>
<p>List number of available functions by group</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">function_groups</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Overlap Studies&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Momentum Indicators&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Volume Indicators&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Volatility Indicators&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Price Transform&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Cycle Indicators&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Pattern Recognition&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Statistic Functions&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Math Transform&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Math Operators&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">talib_grps</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">get_function_groups</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function Group</p></th>
<th class="head"><p># Indicators</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Overlap Studies</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Momentum Indicators</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Volume Indicators</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Volatility Indicators</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Price Transform</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Cycle Indicators</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Pattern Recognition</p></td>
<td><p>61</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Math Operators</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Math Transform</p></td>
<td><p>15</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Statistic Functions</p></td>
<td><p>9</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="unstable-periods">
<h2>Unstable periods<a class="headerlink" href="#unstable-periods" title="Link to this heading">#</a></h2>
<p>Some TA-Lib functions depend on all past data and are sometimes called functions with memory. For example, the Exponential Moving Average (EMA), recursively uses the previous EMA in its computation. As a result, a given data point will continue to have an influence on all subsequent values. In contrast, a simple moving average (SMA) only reflects the values in a finite window of the data.</p>
</section>
<section id="moving-averages">
<h2>Moving Averages<a class="headerlink" href="#moving-averages" title="Link to this heading">#</a></h2>
<p>Numerous indicators allow for calculation using different types of moving average</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>MA Type</p></th>
<th class="head text-right"><p>Name</p></th>
<th class="head text-center"><p>Code</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>SMA</p></td>
<td class="text-right"><p>Simple Moving Average</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>EMA</p></td>
<td class="text-right"><p>Exponential Moving Average</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>WMA</p></td>
<td class="text-right"><p>Weighted Moving Average</p></td>
<td class="text-center"><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>DEMA</p></td>
<td class="text-right"><p>Double Exponential Moving Average</p></td>
<td class="text-center"><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>TEMA</p></td>
<td class="text-right"><p>Triple Exponential Moving Average</p></td>
<td class="text-center"><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>TRIMA</p></td>
<td class="text-right"><p>Triangular Moving Average</p></td>
<td class="text-center"><p>5</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>KAMA</p></td>
<td class="text-right"><p>Kaufman Adaptive Moving Average</p></td>
<td class="text-center"><p>6</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MAMA</p></td>
<td class="text-right"><p>MESA Adaptive Moving Average</p></td>
<td class="text-center"><p>7</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>T3</p></td>
<td class="text-right"><p>Triple Exponential Moving Average</p></td>
<td class="text-center"><p>8</p></td>
</tr>
</tbody>
</table>
</div>
<section id="simple-moving-average-sma">
<h3>Simple Moving Average (SMA)<a class="headerlink" href="#simple-moving-average-sma" title="Link to this heading">#</a></h3>
<p>For price series <span class="math notranslate nohighlight">\(P_t\)</span> with a window of length <span class="math notranslate nohighlight">\(N\)</span>, the simple moving average at time <span class="math notranslate nohighlight">\(t\)</span> weighs each data point within the window has equal weight:
$<span class="math notranslate nohighlight">\(\text{SMA}(N)_t= \frac{P_{t-N+1}+P_{t-N+2}+P_{t-N+3}+P_{t}}{N}=\frac{1}{N}\sum_{i=1}^N P_{t-N+i}\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">:</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                               <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5cf44307d0ff83f07b00e3567a9b047770affae19c1ed7a402a7e3be3f155944.png" src="../../_images/5cf44307d0ff83f07b00e3567a9b047770affae19c1ed7a402a7e3be3f155944.png" />
</div>
</div>
</section>
<section id="exponential-moving-average-ema">
<h3>Exponential Moving Average (EMA)<a class="headerlink" href="#exponential-moving-average-ema" title="Link to this heading">#</a></h3>
<p>For price series <span class="math notranslate nohighlight">\(P_t\)</span> with a window of length <span class="math notranslate nohighlight">\(N\)</span>, the exponential moving average at time <span class="math notranslate nohighlight">\(t\)</span> <span class="math notranslate nohighlight">\(EMA_t\)</span> is recursively defined as the weighted average of the current price and most recent previous <span class="math notranslate nohighlight">\(EMA_{t-1}\)</span>, where the weights <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(1-\alpha\)</span> are defined as below:
$<span class="math notranslate nohighlight">\(\begin{align*}
\text{EMA}(N)_t&amp;= \alpha P_t  + (1-\alpha)\text{EMA}(N)_{t-1} \\
\alpha&amp;=\frac{2}{N+1}\\
\end{align*}\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;EMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">EMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                               <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3a9deafba87e8238b8664838357822f1143ed8377587562b1a201af2d2b1c131.png" src="../../_images/3a9deafba87e8238b8664838357822f1143ed8377587562b1a201af2d2b1c131.png" />
</div>
</div>
</section>
<section id="weighted-moving-average-wma">
<h3>Weighted Moving Average (WMA)<a class="headerlink" href="#weighted-moving-average-wma" title="Link to this heading">#</a></h3>
<p>For price series <span class="math notranslate nohighlight">\(P_t\)</span> with a window of length <span class="math notranslate nohighlight">\(N\)</span>, the weighted moving average at time <span class="math notranslate nohighlight">\(t\)</span> is computed as such that the weight of each data point corresponds to its index within the window:
$<span class="math notranslate nohighlight">\(\text{WMA}(N)_t= \frac{P_{t-N+1}+2P_{t-N+2}+3P_{t-N+3}+NP_{t}}{N(N+1)/2}\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;WMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">WMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                               <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e68dee9664332f5ec34282fe9a44d81ef1bb142d96868408ff647737fe60c72a.png" src="../../_images/e68dee9664332f5ec34282fe9a44d81ef1bb142d96868408ff647737fe60c72a.png" />
</div>
</div>
</section>
<section id="double-exponential-moving-average-dema">
<h3>Double Exponential Moving Average (DEMA)<a class="headerlink" href="#double-exponential-moving-average-dema" title="Link to this heading">#</a></h3>
<p>The double exponential moving average for a price series <span class="math notranslate nohighlight">\(P_t\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(\text{DEMA}_t\)</span> is based on the EMA yet designed to react faster to changes in price. I t is computed as the difference between twice the current EMA and the EMA applied to the current EMA, labeled <span class="math notranslate nohighlight">\(\text{EMA}_2(N)_t\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{DEMA}(N)_t=2\times\text{EMA}(N)_t-\text{EMA}_2(N)_t\]</div>
<p>Since the calculation uses <span class="math notranslate nohighlight">\(\text{EMA}_2\)</span>, DEMA needs 2 * N - 1 samples to start producing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;DEMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">DEMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9c9f15001d9697e4c1ab5bffcca8417ed6c5a4a544107945956efb0a4df4168c.png" src="../../_images/9c9f15001d9697e4c1ab5bffcca8417ed6c5a4a544107945956efb0a4df4168c.png" />
</div>
</div>
</section>
<section id="triple-exponential-moving-average-tema">
<h3>Triple Exponential Moving Average (TEMA)<a class="headerlink" href="#triple-exponential-moving-average-tema" title="Link to this heading">#</a></h3>
<p>The triple exponential moving average for a price series <span class="math notranslate nohighlight">\(P_t\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(\text{TEMA}_t\)</span> is based on the EMA yet designed to react faster to changes in price and indicate short-term price direction. It is computed as the difference between three time the difference between the current EMA and the EMA applied to the current EMA, <span class="math notranslate nohighlight">\(\text{EMA}_2\)</span>, with addition of the EMA of the <span class="math notranslate nohighlight">\(\text{EMA}_2\)</span>, labeled as <span class="math notranslate nohighlight">\(\text{EMA}_3\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{TEMA}(N)_t=3\times\left[\text{EMA}(N)_t-\text{EMA}_2(N)_t\right] + \text{EMA}_3(N)_t\]</div>
<p>Since the calculation uses <span class="math notranslate nohighlight">\(\text{EMA}_3\)</span>, DEMA needs 3 * N - 2 samples to start producing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;TEMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">TEMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4e3f4373e9f7c87d3269cd203f88d48827254a08a631737fe767e9577ad7b514.png" src="../../_images/4e3f4373e9f7c87d3269cd203f88d48827254a08a631737fe767e9577ad7b514.png" />
</div>
</div>
</section>
<section id="triangular-moving-average-trima">
<h3>Triangular Moving Average (TRIMA)<a class="headerlink" href="#triangular-moving-average-trima" title="Link to this heading">#</a></h3>
<p>The triangular moving average (TRIMA) with window length N for a price series <span class="math notranslate nohighlight">\(P_t\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(\text{TRIMA}(N)_t\)</span> is a weighted average of the last N <span class="math notranslate nohighlight">\(SMA(N)_t\)</span> values. In other words, it applies the SMA to a time series of SMA values:</p>
<div class="math notranslate nohighlight">
\[\text{TRIMA}(N)_t=\frac{1}{N}\sum_{i=1}^N \text{SMA}(N)_{t-N+i}\]</div>
<p>Since the calculation applies the SMA(N) to the SMA(N), TRIMA needs 2 * N - 1 samples to start producing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;TRIMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">TRIMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7aca5db3a99ce11d290824e0fb8f40b8b1e2f19b9bdef3f34eb80a0e8f5020ff.png" src="../../_images/7aca5db3a99ce11d290824e0fb8f40b8b1e2f19b9bdef3f34eb80a0e8f5020ff.png" />
</div>
</div>
</section>
<section id="kaufman-adaptive-moving-average-kama">
<h3>Kaufman Adaptive Moving Average (KAMA)<a class="headerlink" href="#kaufman-adaptive-moving-average-kama" title="Link to this heading">#</a></h3>
<p>The computation of the Kaufman adaptive moving average aims to take into account changes in market volatility. See <a class="reference external" href="https://www.technicalindicators.net/indicators-technical-analysis/152-kama-kaufman-adaptive-moving-average">here</a> for details on the slightly more involved computation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;KAMA_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">KAMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eab2eacf5affc5015b32b2462363d45effa414fe6ed3c84335256c7f52f51181.png" src="../../_images/eab2eacf5affc5015b32b2462363d45effa414fe6ed3c84335256c7f52f51181.png" />
</div>
</div>
</section>
<section id="mesa-adaptive-moving-average-mama">
<h3>MESA Adaptive Moving Average (MAMA)<a class="headerlink" href="#mesa-adaptive-moving-average-mama" title="Link to this heading">#</a></h3>
<p>The MESA Adaptive Moving Average (MAMA) is an exponential moving average that adapts to price movement based on the rate change of phase as measured by the Hilbert Transform Discriminator (see below). In addition to the price series, MAMA accepts two additional parameters, <code class="docutils literal notranslate"><span class="pre">fastlimit</span></code> and <code class="docutils literal notranslate"><span class="pre">slowlimit</span></code> that control the maximum and minimum alpha value that should be applied to the EMA using when calculating MAMA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">talib</span><span class="o">.</span><span class="n">MAMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                         <span class="n">fastlimit</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                         <span class="n">slowlimit</span><span class="o">=</span><span class="mf">.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mama</span><span class="p">,</span> <span class="n">fama</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MAMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                        <span class="n">fastlimit</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                        <span class="n">slowlimit</span><span class="o">=</span><span class="mf">.05</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;mama&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mama</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;fama&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fama</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ef96eaf03f07efaa8fb3bdf9c21d6b6c3bfc92e55970ad6866462282a26f8c45.png" src="../../_images/ef96eaf03f07efaa8fb3bdf9c21d6b6c3bfc92e55970ad6866462282a26f8c45.png" />
</div>
</div>
</section>
<section id="comparison">
<h3>Comparison<a class="headerlink" href="#comparison" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">21</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;WMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">WMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;TRIMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">TRIMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;SMA&#39;</span><span class="p">,</span> <span class="s1">&#39;WMA&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIMA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9b40c6f98750e0d24f0a6c6e318914542f6055b9aeb76f0f2a6a65757eb2fa89.png" src="../../_images/9b40c6f98750e0d24f0a6c6e318914542f6055b9aeb76f0f2a6a65757eb2fa89.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">EMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;DEMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">DEMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;TEMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">TEMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;EMA&#39;</span><span class="p">,</span> <span class="s1">&#39;DEMA&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0d24f541aba595b3e70387a2ffb30406383c4e7c10be387ceb1917bffabe6ab9.png" src="../../_images/0d24f541aba595b3e70387a2ffb30406383c4e7c10be387ceb1917bffabe6ab9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;KAMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">KAMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">mama</span><span class="p">,</span> <span class="n">fama</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MAMA</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                        <span class="n">fastlimit</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                        <span class="n">slowlimit</span><span class="o">=</span><span class="mf">.05</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MAMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mama</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;FAMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fama</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;KAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;MAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;FAMA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fea2f064c13ab5c5eac472a06c8f5d4d5459ab66ab6d7d1c5e15457f4f57445c.png" src="../../_images/fea2f064c13ab5c5eac472a06c8f5d4d5459ab66ab6d7d1c5e15457f4f57445c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;SMA&#39;</span><span class="p">,</span> <span class="s1">&#39;WMA&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIMA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                          <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Simple, Weighted and Triangular Moving Averages&#39;</span><span class="p">,</span>
                                          <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;EMA&#39;</span><span class="p">,</span> <span class="s1">&#39;DEMA&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Simple, Double, and Triple Exponential Moving Averages&#39;</span><span class="p">,</span>
                                          <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;KAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;MAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;FAMA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mesa and Kaufman Adaptive Moving Averages&#39;</span><span class="p">,</span>
                                          <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0b24a1da85c0ec7385096178e3d14302ab9bbf5735b2ce6df45cee99ebc13ee1.png" src="../../_images/0b24a1da85c0ec7385096178e3d14302ab9bbf5735b2ce6df45cee99ebc13ee1.png" />
</div>
</div>
</section>
</section>
<section id="overlap-studies">
<h2>Overlap Studies<a class="headerlink" href="#overlap-studies" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>BBANDS</p></td>
<td class="text-left"><p>Bollinger Bands</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>HT_TRENDLINE</p></td>
<td class="text-left"><p>Hilbert Transform - Instantaneous Trendline</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>MAVP</p></td>
<td class="text-left"><p>Moving average with variable period</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MA</p></td>
<td class="text-left"><p>Moving average</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>MIDPOINT</p></td>
<td class="text-left"><p>MidPoint over period</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MIDPRICE</p></td>
<td class="text-left"><p>Midpoint Price over period</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>SAR</p></td>
<td class="text-left"><p>Parabolic SAR</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>SAREXT</p></td>
<td class="text-left"><p>Parabolic SAR - Extended</p></td>
</tr>
</tbody>
</table>
</div>
<section id="bollinger-bands">
<h3>Bollinger Bands<a class="headerlink" href="#bollinger-bands" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BBANDS</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>   <span class="c1"># Number of periods (2 to 100000)</span>
                 <span class="n">timeperiod</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">nbdevup</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>    <span class="c1"># Deviation multiplier for lower band</span>
                 <span class="n">nbdevdn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>    <span class="c1"># Deviation multiplier for upper band</span>
                 <span class="n">matype</span><span class="o">=</span><span class="mi">1</span>      <span class="c1"># default: SMA</span>
                 <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bb_bands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bb_bands</span><span class="p">,</span> <span class="n">s</span><span class="p">)))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bb_bands</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d5b423dcac7b2a36cb26b1db03c983c4a9490665d045bc7e650e28546d709591.png" src="../../_images/d5b423dcac7b2a36cb26b1db03c983c4a9490665d045bc7e650e28546d709591.png" />
</div>
</div>
<section id="normalized-squeeze-mean-reversion-indicators">
<h4>Normalized squeeze &amp; mean reversion indicators<a class="headerlink" href="#normalized-squeeze-mean-reversion-indicators" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">upper</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bb_up&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bb_low&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">upper</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bb_squeeze&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0387a2ba2fa06ff576f2d11430514f5ec93fecd118aeceeb9cb24f79850490f3.png" src="../../_images/0387a2ba2fa06ff576f2d11430514f5ec93fecd118aeceeb9cb24f79850490f3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_bb_indicators</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">matype</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">high</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">low</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BBANDS</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> 
                                  <span class="n">timeperiod</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                  <span class="n">matype</span><span class="o">=</span><span class="n">matype</span><span class="p">)</span>
    <span class="n">bb_up</span> <span class="o">=</span> <span class="n">high</span> <span class="o">/</span> <span class="n">close</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">bb_low</span> <span class="o">=</span> <span class="n">low</span> <span class="o">/</span> <span class="n">close</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">squeeze</span> <span class="o">=</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="n">close</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;BB_UP&#39;</span><span class="p">:</span> <span class="n">bb_up</span><span class="p">,</span> 
                         <span class="s1">&#39;BB_LOW&#39;</span><span class="p">:</span> <span class="n">bb_low</span><span class="p">,</span> 
                         <span class="s1">&#39;BB_SQUEEZE&#39;</span><span class="p">:</span> <span class="n">squeeze</span><span class="p">},</span> 
                        <span class="n">index</span><span class="o">=</span><span class="n">close</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span>
                  <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">close</span>
                  <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_bb_indicators</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-distribution">
<h4>Visualize Distribution<a class="headerlink" href="#visualize-distribution" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bb_indicators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BB_UP&#39;</span><span class="p">,</span> <span class="s1">&#39;BB_LOW&#39;</span><span class="p">,</span> <span class="s1">&#39;BB_SQUEEZE&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">.01</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">bb_indicators</span><span class="p">]</span>
    <span class="n">df_</span> <span class="o">=</span> <span class="n">df_</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">df_</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> 
                   <span class="n">df_</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bb_indicators</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df_</span><span class="p">[</span><span class="n">indicator</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Distribution of normalized Bollinger Band indicators&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">.93</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/54c0ded6f3bbc9eb07ecf0ddbfb6d7d944dacb05a1a939de44d0559b79a02941.png" src="../../_images/54c0ded6f3bbc9eb07ecf0ddbfb6d7d944dacb05a1a939de44d0559b79a02941.png" />
</div>
</div>
</section>
<section id="plot-outlier-price-series">
<h4>Plot outlier price series<a class="headerlink" href="#plot-outlier-price-series" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bb_indicators</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bb_indicators</span><span class="p">):</span>
    <span class="n">ticker</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">ticker</span><span class="p">,</span> <span class="p">:],</span> <span class="p">:]</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">ticker</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ticker</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">ticker</span><span class="p">,</span> <span class="p">:],</span> <span class="p">:]</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">ticker</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    
    <span class="n">c</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">indicator</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c9b3dae0503d8b94019df646d18bbd983f7e770bd4392576701792a81faf16db.png" src="../../_images/c9b3dae0503d8b94019df646d18bbd983f7e770bd4392576701792a81faf16db.png" />
</div>
</div>
</section>
</section>
<section id="hilbert-transform-instantaneous-trendline">
<h3>Hilbert Transform - Instantaneous Trendline<a class="headerlink" href="#hilbert-transform-instantaneous-trendline" title="Link to this heading">#</a></h3>
<p>The Hilbert Transform generates inphase and quadrature components of a de-trended real-valued signal like a price series to analyze variations of the instantaneous phase and amplitude.</p>
<p>HTTrendline returns the price series value after the Dominant Cycle of the analytic signal as generated by the Hilbert Transform has been removed. The Dominant Cycle can be thought of as being the “most likely” period (in the range of 10 to 40) of a sine function of the Price Series. See <a class="reference external" href="http://www2.wealth-lab.com/WL5Wiki/HTTrendLine.ashx">here</a> for additional detail on computation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;HT_TRENDLINE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">HT_TRENDLINE</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a3f5cf9ff7af6b0fdaa7ce6e4e66421e60b29a76638bb5f67cce0a8adc9c6ea4.png" src="../../_images/a3f5cf9ff7af6b0fdaa7ce6e4e66421e60b29a76638bb5f67cce0a8adc9c6ea4.png" />
</div>
</div>
<section id="compute-hilbert-based-normalized-indicator">
<h4>Compute Hilbert-based normalized indicator<a class="headerlink" href="#compute-hilbert-based-normalized-indicator" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;HT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
              <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
              <span class="o">.</span><span class="n">close</span>
              <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">talib</span><span class="o">.</span><span class="n">HT_TRENDLINE</span><span class="p">)</span>
              <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">=</span><span class="mf">0.005</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">HT</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">HT</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">HT</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/82fb0263bb0b1f71205cd7f70860527368f8606d98d5d7372e9bd189f7c3a643.png" src="../../_images/82fb0263bb0b1f71205cd7f70860527368f8606d98d5d7372e9bd189f7c3a643.png" />
</div>
</div>
</section>
</section>
<section id="parabolic-sar">
<h3>Parabolic SAR<a class="headerlink" href="#parabolic-sar" title="Link to this heading">#</a></h3>
<p>The Parabolic SAR aims to identify trend reversals. It is a trend-following (lagging) indicator that can be used to set a trailing stop loss or determine entry or exit points. It is usually represented in a price chart as a set of dots near the price bars. Generally, when these dots are above the price, it signals a downward trend, and an upward trend if the dots are below the price. The change in the direction of the dots can be interpreted as a  trade signal. However, the indicator is not as reliable in a flat or range-bound markt. It is compute as follows:</p>
<div class="math notranslate nohighlight">
\[\text{SAR}_t=\text{SAR}_{t-1} + \alpha (\text{EP}-\text{SAR}_{t-1})\]</div>
<p>EP (the extreme point) is a record kept during each trend that represents the highest value reached by the price during the current uptrend – or lowest value during a downtrend. During each period, if a new maximum (or minimum) is observed, the EP is updated with that value.</p>
<p>The α value represents the acceleration factor and is typically set initially to a value of 0.02. This factor increases by α each time a new EP is recorded. The rate will then quicken to a point where the SAR converges towards the price. To prevent it from getting too large, a maximum value for the acceleration factor is normally set to 0.20.</p>
<p>For additional detail, see <a class="reference external" href="https://en.wikipedia.org/wiki/Parabolic_SAR">wikipedia</a>; there is also an <a class="reference external" href="http://www.tadoc.org/indicator/SAR.htm">extended SAR</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">]]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;SAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SAR</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> 
                      <span class="n">acceleration</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="c1"># common value</span>
                      <span class="n">maximum</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>       
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;SAR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Parabolic SAR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5b14f9846715c747e0fa777768f38a81998b46134afd1597f742ca20c669138a.png" src="../../_images/5b14f9846715c747e0fa777768f38a81998b46134afd1597f742ca20c669138a.png" />
</div>
</div>
<section id="normalized-sar-indicator">
<h4>Normalized SAR indicator<a class="headerlink" href="#normalized-sar-indicator" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_sar_indicator</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">acceleration</span><span class="o">=</span><span class="mf">.02</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="n">sar</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SAR</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> 
                    <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                    <span class="n">acceleration</span><span class="o">=</span><span class="n">acceleration</span><span class="p">,</span>
                    <span class="n">maximum</span><span class="o">=</span><span class="n">maximum</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sar</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">close</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_sar_indicator</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">=</span><span class="mf">0.005</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">SAR</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">SAR</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">SAR</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a7dac96fc3f99d68aa7e84dfb9bbc90e529b61b8e51fee2a1f83fa24f95443fd.png" src="../../_images/a7dac96fc3f99d68aa7e84dfb9bbc90e529b61b8e51fee2a1f83fa24f95443fd.png" />
</div>
</div>
</section>
</section>
</section>
<section id="momentum-indicators">
<h2>Momentum Indicators<a class="headerlink" href="#momentum-indicators" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>PLUS_DM</p></td>
<td class="text-left"><p>Plus Directional Movement</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MINUS_DM</p></td>
<td class="text-left"><p>Minus Directional Movement</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>PLUS_DI</p></td>
<td class="text-left"><p>Plus Directional Indicator</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MINUS_DI</p></td>
<td class="text-left"><p>Minus Directional Indicator</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>DX</p></td>
<td class="text-left"><p>Directional Movement Index</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ADX</p></td>
<td class="text-left"><p>Average Directional Movement Index</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ADXR</p></td>
<td class="text-left"><p>Average Directional Movement Index Rating</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>APO</p></td>
<td class="text-left"><p>Absolute Price Oscillator</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>PPO</p></td>
<td class="text-left"><p>Percentage Price Oscillator</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>AROON</p></td>
<td class="text-left"><p>Aroon</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>AROONOSC</p></td>
<td class="text-left"><p>Aroon Oscillator</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>BOP</p></td>
<td class="text-left"><p>Balance Of Power</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CCI</p></td>
<td class="text-left"><p>Commodity Channel Index</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CMO</p></td>
<td class="text-left"><p>Chande Momentum Oscillator</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>MACD</p></td>
<td class="text-left"><p>Moving Average Convergence/Divergence</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MACDEXT</p></td>
<td class="text-left"><p>MACD with controllable MA type</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>MACDFIX</p></td>
<td class="text-left"><p>Moving Average Convergence/Divergence Fix 12/26</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MFI</p></td>
<td class="text-left"><p>Money Flow Index</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>MOM</p></td>
<td class="text-left"><p>Momentum</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>RSI</p></td>
<td class="text-left"><p>Relative Strength Index</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>STOCH</p></td>
<td class="text-left"><p>Stochastic</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>STOCHF</p></td>
<td class="text-left"><p>Stochastic Fast</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>STOCHRSI</p></td>
<td class="text-left"><p>Stochastic Relative Strength Index</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>TRIX</p></td>
<td class="text-left"><p>1-day Rate-Of-Change (ROC) of a Triple Smooth EMA</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>ULTOSC</p></td>
<td class="text-left"><p>Ultimate Oscillator</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>WILLR</p></td>
<td class="text-left"><p>Williams’ %R</p></td>
</tr>
</tbody>
</table>
</div>
<section id="average-directional-movement-index-adx">
<h3>Average Directional Movement Index (ADX)<a class="headerlink" href="#average-directional-movement-index-adx" title="Link to this heading">#</a></h3>
<p>The ADX combines of two other indicators, namely the positive and directional indicators (PLUS_DI and MINUS_DI), which in turn build on the positive and directional movement (PLUS_DM and MINUS_DM). For additional details see <a class="reference external" href="https://en.wikipedia.org/wiki/Average_directional_movement_index">Wikipdia</a> and <a class="reference external" href="https://www.investopedia.com/articles/trading/07/adx-trend-indicator.asp">Investopedia</a>.</p>
<section id="plus-minus-directional-movement-plus-dm-minus-dm">
<h4>Plus/Minus Directional Movement (PLUS_DM/MINUS_DM)<a class="headerlink" href="#plus-minus-directional-movement-plus-dm-minus-dm" title="Link to this heading">#</a></h4>
<p>For a price series <span class="math notranslate nohighlight">\(P_t\)</span> with daily highs <span class="math notranslate nohighlight">\(P^H_t\)</span> and daily lows <span class="math notranslate nohighlight">\(P^L_t\)</span>, the directional movement tracks the absolute size of price moves over a timeperiod T as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\text{Up}_t &amp; =P^H_t-P^H_{t-T} \\
\text{Down}_t &amp; = P^L_{t-T} - P^L_t\\
\text{PLUS_DM}_t &amp; = 
\begin{cases}
\text{Up}_t &amp; \text{if Up}_t &gt; \text{Down}_t \text{and Up}_t &gt; 0 \\
0 &amp; \text{otherwise}
\end{cases} \\
\text{MINUS_DM}_t &amp; = 
\begin{cases}
\text{Down}_t &amp; \text{if Down}_t &gt; \text{Up}_t \text{and Down}_t &lt; 0 \\
0 &amp; \text{otherwise}
\end{cases}
\end{align*}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">:</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PLUS_DM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">PLUS_DM</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MINUS_DM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MINUS_DM</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;PLUS_DM&#39;</span><span class="p">,</span> <span class="s1">&#39;MINUS_DM&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                               <span class="n">secondary_y</span><span class="o">=</span><span class="p">[</span>
                                                   <span class="s1">&#39;PLUS_DM&#39;</span><span class="p">,</span> <span class="s1">&#39;MINUS_DM&#39;</span><span class="p">],</span>
                                               <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">],</span>
                                              <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f8834dc72692ee6ddfd1533f006c287e921a50adba09eab62ae82b586eb02507.png" src="../../_images/f8834dc72692ee6ddfd1533f006c287e921a50adba09eab62ae82b586eb02507.png" />
</div>
</div>
</section>
<section id="plus-minus-directional-index-plus-di-minus-di">
<h4>Plus/Minus Directional Index (PLUS_DI/MINUS_DI)<a class="headerlink" href="#plus-minus-directional-index-plus-di-minus-di" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">PLUS_DI</span></code> and <code class="docutils literal notranslate"><span class="pre">MINUS_DI</span></code> are the simple moving average of <code class="docutils literal notranslate"><span class="pre">PLUS_DM</span></code> and <code class="docutils literal notranslate"><span class="pre">MINUS_DM</span></code>, respectively, each divided by the average true range (<code class="docutils literal notranslate"><span class="pre">ATR</span></code>, see below).</p>
<p>The smoothed moving average is calculated over the number of periods selected, and the average true range is a smoothed average of the true ranges.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012&#39;</span><span class="p">:</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PLUS_DI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">PLUS_DI</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MINUS_DI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MINUS_DI</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;PLUS_DI&#39;</span><span class="p">,</span> <span class="s1">&#39;MINUS_DI&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/41060839dcaa07bdec90baf7e7ac9bb2557b985c6a53f2942518dfe8524b87fe.png" src="../../_images/41060839dcaa07bdec90baf7e7ac9bb2557b985c6a53f2942518dfe8524b87fe.png" />
</div>
</div>
</section>
<section id="id1">
<h4>Average directional movement index (ADX)<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>The ADX is the (simple) moving average of the absolute value of the difference between PLUS_DI and MINUS_DI, divided by their sum:</p>
<div class="math notranslate nohighlight">
\[
\text{ADX}=100\times\text{SMA}(N)_t\left|\frac{\text{PLUS_DI}_t-\text{MINUS_DI}_t}{\text{PLUS_DI}_t+\text{MINUS_DI}_t}\right|
\]</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>ADX Value</p></th>
<th class="head text-left"><p>Trend Strength</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>0-25</p></td>
<td class="text-left"><p>Absent or Weak Trend</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>25-50</p></td>
<td class="text-left"><p>Strong Trend</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>50-75</p></td>
<td class="text-left"><p>Very Strong Trend</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>75-100</p></td>
<td class="text-left"><p>Extremely Strong Trend</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADX</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> 
                      <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> 
                      <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> 
                      <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;ADX&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;ADX&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a658c98b913dcdd8d2483c4c80734876e7ecc7954d13639439e3913a4ae633b1.png" src="../../_images/a658c98b913dcdd8d2483c4c80734876e7ecc7954d13639439e3913a4ae633b1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_adx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADX</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> 
                    <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                    <span class="n">timeperiod</span><span class="o">=</span><span class="n">timeperiod</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ADX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_adx</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4>Visualize distribution<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ADX</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5cc34659df599ff52c8b7b608568cfd119521acf741cd8935852a4aa84fed74b.png" src="../../_images/5cc34659df599ff52c8b7b608568cfd119521acf741cd8935852a4aa84fed74b.png" />
</div>
</div>
</section>
<section id="average-directional-movement-index-rating">
<h4>Average Directional Movement Index Rating<a class="headerlink" href="#average-directional-movement-index-rating" title="Link to this heading">#</a></h4>
<p>Averages the current ADX and the ADX T periods ago.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADXR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADXR</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                        <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                        <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                        <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;ADXR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                                <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;ADX&#39;</span><span class="p">,</span>
                                <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f8ebb94a1f0864b0ad1e6c4846813990b9b1b8be002a50bb45e21878d83ba176.png" src="../../_images/f8ebb94a1f0864b0ad1e6c4846813990b9b1b8be002a50bb45e21878d83ba176.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_adxr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADXR</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> 
                    <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                    <span class="n">timeperiod</span><span class="o">=</span><span class="n">timeperiod</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ADXR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_adxr</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ADXR</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/064bebd8f53caeca548922540569d31ad5947f45dbf9bec1d18a9cbda4849fd0.png" src="../../_images/064bebd8f53caeca548922540569d31ad5947f45dbf9bec1d18a9cbda4849fd0.png" />
</div>
</div>
</section>
</section>
<section id="absolute-price-oscillator-apo">
<h3>Absolute Price Oscillator (APO)<a class="headerlink" href="#absolute-price-oscillator-apo" title="Link to this heading">#</a></h3>
<p>The absolute Price Oscillator (APO) is computed as the difference between two exponential moving averages (EMA) of price series, expressed as an absolute value. The EMA windows usually contain 26 and 12 data points, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;APO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">APO</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                      <span class="n">fastperiod</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                      <span class="n">slowperiod</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
                      <span class="n">matype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;APO&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0169eee17c531cca371f2fd1c09cc20579406b074e2d1b25175c5182d03ee723.png" src="../../_images/0169eee17c531cca371f2fd1c09cc20579406b074e2d1b25175c5182d03ee723.png" />
</div>
</div>
</section>
<section id="percentage-price-oscillator-ppo">
<h3>Percentage Price Oscillator (PPO)<a class="headerlink" href="#percentage-price-oscillator-ppo" title="Link to this heading">#</a></h3>
<p>The Percentage Price Oscillator (APO) is computed as the difference between two exponential moving averages (EMA) of price series, expressed as a percentage value and thus comparable across assets. The EMA windows usually contain 26 and 12 data points, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PPO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">PPO</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                      <span class="n">fastperiod</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                      <span class="n">slowperiod</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
                      <span class="n">matype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">secondary_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;APO&#39;</span><span class="p">,</span> <span class="s1">&#39;PPO&#39;</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d1d4c6c9045251379b6eef4c517031ce87bc05de96cf381d58a8e1bb8e9f5187.png" src="../../_images/d1d4c6c9045251379b6eef4c517031ce87bc05de96cf381d58a8e1bb8e9f5187.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;PPO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
               <span class="o">.</span><span class="n">close</span>
               <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">talib</span><span class="o">.</span><span class="n">PPO</span><span class="p">,</span> 
                      <span class="n">fastperiod</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> 
                      <span class="n">slowperiod</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> 
                      <span class="n">matype</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PPO</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">PPO</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                               <span class="n">upper</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">PPO</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/10722c95427f2f52c0495f59b89d3b3e063a7ae2db4466294af3bc0eeddda91f.png" src="../../_images/10722c95427f2f52c0495f59b89d3b3e063a7ae2db4466294af3bc0eeddda91f.png" />
</div>
</div>
</section>
<section id="aroon-oscillator">
<h3>Aroon Oscillator<a class="headerlink" href="#aroon-oscillator" title="Link to this heading">#</a></h3>
<section id="aroon-up-down-indicator">
<h4>Aroon Up/Down Indicator<a class="headerlink" href="#aroon-up-down-indicator" title="Link to this heading">#</a></h4>
<p>The indicator measures the time between highs and the time between lows over a time period. It computes an AROON_UP and an AROON_DWN indicator as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{AROON_UP}&amp;=\frac{T-\text{Periods since T period High}}{T}\times 100\\
\text{AROON_DWN}&amp;=\frac{T-\text{Periods since T period Low}}{T}\times 100
\end{align*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aroonup</span><span class="p">,</span> <span class="n">aroondwn</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AROON</span><span class="p">(</span><span class="n">high</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                <span class="n">low</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROON_UP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aroonup</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROON_DWN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aroondwn</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;AROON_UP&#39;</span><span class="p">,</span> <span class="s1">&#39;AROON_DWN&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/aa3b4e0ded89ff99a3725938e22069b026d8eb830ef0302d75c293ae7ddc4093.png" src="../../_images/aa3b4e0ded89ff99a3725938e22069b026d8eb830ef0302d75c293ae7ddc4093.png" />
</div>
</div>
</section>
<section id="id3">
<h4>Aroon Oscillator<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>The Aroon Oscillator is simply the difference between the Aroon Up and Aroon Down indicators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROONOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AROONOSC</span><span class="p">(</span><span class="n">high</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                <span class="n">low</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;AROONOSC&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span> <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;AROONOSC&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4ff70b6f7b3e2e388f008e182f09c6a4ea2cdf648f60083392fabda32d1e82b8.png" src="../../_images/4ff70b6f7b3e2e388f008e182f09c6a4ea2cdf648f60083392fabda32d1e82b8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;AARONOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span>
                                 <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">AROONOSC</span><span class="p">(</span><span class="n">high</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                                    <span class="n">low</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                                    <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">AARONOSC</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d95472bff9531a0927a82bb8f6c1e279efc7e2e348b1f20358efdd150c8c8573.png" src="../../_images/d95472bff9531a0927a82bb8f6c1e279efc7e2e348b1f20358efdd150c8c8573.png" />
</div>
</div>
</section>
</section>
<section id="balance-of-power-bop">
<h3>Balance Of Power (BOP)<a class="headerlink" href="#balance-of-power-bop" title="Link to this heading">#</a></h3>
<p>The Balance of Power (BOP) intends to measure the strength of buyers relative to sellers in the market by assessing the ability of each side to drive prices. It is computer as the difference between the close and the open price, divided by the difference between the high and the low price:</p>
<div class="math notranslate nohighlight">
\[
\text{BOP}_t= \frac{P_t^\text{Close}-P_t^\text{Open}}{P_t^\text{High}-P_t^\text{Low}}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BOP</span><span class="p">(</span><span class="nb">open</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">open</span><span class="p">,</span>
                      <span class="n">high</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                      <span class="n">low</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                      <span class="n">close</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;BOP&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;BOP&#39;</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cdace0a1b2451adffe4c85faf75613f6a5e34c9daf79b0d52d963dd01e3998b3.png" src="../../_images/cdace0a1b2451adffe4c85faf75613f6a5e34c9daf79b0d52d963dd01e3998b3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_ticker</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BOP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">by_ticker</span>
               <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">BOP</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">open</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.0005</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">BOP</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">BOP</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                               <span class="n">upper</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">BOP</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3886e8a7be6aca53baa990ad5993ff5a2b35c8587beaad8e386990e3dc7c9dfe.png" src="../../_images/3886e8a7be6aca53baa990ad5993ff5a2b35c8587beaad8e386990e3dc7c9dfe.png" />
</div>
</div>
</section>
<section id="commodity-channel-index-cci">
<h3>Commodity Channel Index (CCI)<a class="headerlink" href="#commodity-channel-index-cci" title="Link to this heading">#</a></h3>
<p>The Commodity Channel Index (CCI) measures the difference between the current <em>typical</em> price, computed as the average of current low, high and close price and the historical average price. A positive (negative) CCI indicates that price is above (below) the historic average. When CCI is below zero, the price is below the hsitoric average. It is computed as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\bar{P_t}&amp;=\frac{P_t^H+P_t^L+P_t^C}{3}\\
\text{CCI}_t &amp; =\frac{\bar{P_t} - \text{SMA}(T)_t}{0.15\sum_{t=i}^T |\bar{P_t}-\text{SMA}(N)_t|/T}
\end{align*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CCI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CCI</span><span class="p">(</span><span class="n">high</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                      <span class="n">low</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                      <span class="n">close</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                      <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;CCI&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> 
                                 <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                                 <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;CCI&#39;</span><span class="p">],</span> 
                                 <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1d2be3f4f8f55ee46f1bbc7fc89e1fe854b213f16317a6797af2c8653fc1960a.png" src="../../_images/1d2be3f4f8f55ee46f1bbc7fc89e1fe854b213f16317a6797af2c8653fc1960a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;CCI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">by_ticker</span>
               <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">CCI</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                          <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">CCI</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/385f947f48ee0d20b7064d6bb1efbc76bb3c6dc6b1454d5daa7a99e7e689ff78.png" src="../../_images/385f947f48ee0d20b7064d6bb1efbc76bb3c6dc6b1454d5daa7a99e7e689ff78.png" />
</div>
</div>
</section>
<section id="moving-average-convergence-divergence-macd">
<h3>Moving Average Convergence/Divergence (MACD)<a class="headerlink" href="#moving-average-convergence-divergence-macd" title="Link to this heading">#</a></h3>
<p>Moving Average Convergence Divergence (MACD) is a trend-following (lagging) momentum indicator that shows the relationship between two moving averages of a security’s price. It is calculated by subtracting the 26-period Exponential Moving Average (EMA) from the 12-period EMA.</p>
<p>The TA-Lib implementation returns the MACD value and its signal line, which is the 9-day EMA of the MACD. In addition, the MACD-Histogram measures the distance between the indicator and its signal line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">macd</span><span class="p">,</span> <span class="n">macdsignal</span><span class="p">,</span> <span class="n">macdhist</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MACD</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                        <span class="n">fastperiod</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                        <span class="n">slowperiod</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
                                        <span class="n">signalperiod</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">macd</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACDSIG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">macdsignal</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACDHIST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">macdhist</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
               <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MACD&#39;</span><span class="p">,</span> <span class="s1">&#39;MACDSIG&#39;</span><span class="p">,</span> <span class="s1">&#39;MACDHIST&#39;</span><span class="p">],</span>
               <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/42b2429ec78038eae1fd9df168a112c94c3309abdc96c9da3b693c3201386868.png" src="../../_images/42b2429ec78038eae1fd9df168a112c94c3309abdc96c9da3b693c3201386868.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_macd</span><span class="p">(</span><span class="n">close</span><span class="p">,</span> <span class="n">fastperiod</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">slowperiod</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">signalperiod</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span>
    <span class="n">macd</span><span class="p">,</span> <span class="n">macdsignal</span><span class="p">,</span> <span class="n">macdhist</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MACD</span><span class="p">(</span><span class="n">close</span><span class="p">,</span>
                                            <span class="n">fastperiod</span><span class="o">=</span><span class="n">fastperiod</span><span class="p">,</span>
                                            <span class="n">slowperiod</span><span class="o">=</span><span class="n">slowperiod</span><span class="p">,</span>
                                            <span class="n">signalperiod</span><span class="o">=</span><span class="n">signalperiod</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;MACD&#39;</span><span class="p">:</span> <span class="n">macd</span><span class="p">,</span>
                         <span class="s1">&#39;MACD_SIGNAL&#39;</span><span class="p">:</span> <span class="n">macdsignal</span><span class="p">,</span>
                         <span class="s1">&#39;MACD_HIST&#39;</span><span class="p">:</span> <span class="n">macdhist</span><span class="p">},</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">close</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span>
                  <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">close</span>
                  <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_macd</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">macd_indicators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">,</span> <span class="s1">&#39;MACD_SIGNAL&#39;</span><span class="p">,</span> <span class="s1">&#39;MACD_HIST&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">macd_indicators</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MACD</th>
      <th>MACD_SIGNAL</th>
      <th>MACD_HIST</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MACD</th>
      <td>1.000000</td>
      <td>0.955452</td>
      <td>0.331106</td>
    </tr>
    <tr>
      <th>MACD_SIGNAL</th>
      <td>0.955452</td>
      <td>1.000000</td>
      <td>0.037857</td>
    </tr>
    <tr>
      <th>MACD_HIST</th>
      <td>0.331106</td>
      <td>0.037857</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">.005</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">df_</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">macd_indicators</span><span class="p">]</span>
    <span class="n">df_</span> <span class="o">=</span> <span class="n">df_</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">df_</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> 
                   <span class="n">df_</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">macd_indicators</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df_</span><span class="p">[</span><span class="n">indicator</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9df27f748171d6ec7902876b36a8314b3243f63a8796f046577d7713664d6e00.png" src="../../_images/9df27f748171d6ec7902876b36a8314b3243f63a8796f046577d7713664d6e00.png" />
</div>
</div>
</section>
<section id="chande-momentum-oscillator-cmo">
<h3>Chande Momentum Oscillator (CMO)<a class="headerlink" href="#chande-momentum-oscillator-cmo" title="Link to this heading">#</a></h3>
<p>The Chande Momentum Oscillator (CMO) intends to measure momentum on both up and down days. It is calculated as the difference between the sum of gains and losses over at time period T, divided by the sum of all price movement over the same period. It oscillates between +100 and -100.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CMO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CMO</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">secondary_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CMO&#39;</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/15eb54e4ff61a4be691655b75ebb042632a1e0c381332d9d2cc9707d83c75a21.png" src="../../_images/15eb54e4ff61a4be691655b75ebb042632a1e0c381332d9d2cc9707d83c75a21.png" />
</div>
</div>
<p>Not included due to high correlation with PPO.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data[&#39;CMO&#39;] = (by_ticker</span>
<span class="c1">#                .apply(lambda x: talib.CMO(x.close,</span>
<span class="c1">#                                           timeperiod=14)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.distplot(data.CMO);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="money-flow-index">
<h3>Money Flow Index<a class="headerlink" href="#money-flow-index" title="Link to this heading">#</a></h3>
<p>The Money Flow Index (MFI) incorporates price and volume information to identify overbought or oversold conditions.  The indicator is typically calculated using 14 periods of data. An MFI reading above 80 is considered overbought and an MFI reading below 20 is considered oversold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MFI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MFI</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> 
                      <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> 
                      <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> 
                      <span class="n">df</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> 
                      <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;MFI&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                                           <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                           <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">,</span> <span class="s1">&#39;MFI&#39;</span><span class="p">],</span>
                                           <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ad254f2ed04861ed77610357d3680391e4846dd4b0dc5609b673d5bc42b4314d.png" src="../../_images/ad254f2ed04861ed77610357d3680391e4846dd4b0dc5609b673d5bc42b4314d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MFI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">by_ticker</span>
               <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">MFI</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
                                          <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">MFI</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/156b6804ab8d30cbcd767033fa254ae99296603f58180eecf040c153289972f5.png" src="../../_images/156b6804ab8d30cbcd767033fa254ae99296603f58180eecf040c153289972f5.png" />
</div>
</div>
</section>
<section id="relative-strength-index">
<h3>Relative Strength Index<a class="headerlink" href="#relative-strength-index" title="Link to this heading">#</a></h3>
<p>RSI compares the magnitude of recent price changes across stocks to identify stocks as overbought or oversold. A high RSI (usually above 70) indicates overbought and a low RSI (typically below 30) indicates oversold. It first computes the average price change for a given number (often 14) of prior trading days with rising and falling prices, respectively as <span class="math notranslate nohighlight">\(\text{up}_t\)</span> and <span class="math notranslate nohighlight">\(\text{down}_t\)</span>. Then, the RSI is computed as:
$<span class="math notranslate nohighlight">\(
\text{RSI}_t=100-\frac{100}{1+\frac{\text{up}_t}{\text{down}_t}}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">secondary_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ec2d58fd8dbbcc834f4e6fbd8925834cd8760784946413f2d2f6999f088b9ee8.png" src="../../_images/ec2d58fd8dbbcc834f4e6fbd8925834cd8760784946413f2d2f6999f088b9ee8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">by_ticker</span>
               <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                          <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">RSI</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/93d1f4abf597ae447c47b814e2a39db4348b0fd242b3b1e38262d5767f3e2122.png" src="../../_images/93d1f4abf597ae447c47b814e2a39db4348b0fd242b3b1e38262d5767f3e2122.png" />
</div>
</div>
<section id="stochastic-rsi-stochrsi">
<h4>Stochastic RSI (STOCHRSI)<a class="headerlink" href="#stochastic-rsi-stochrsi" title="Link to this heading">#</a></h4>
<p>The Stochastic Relative Strength Index (STOCHRSI) is based on the RSI just described and intends to identify crossovers as well as overbought and oversold conditions. It compares the distance of the current RSI to the lowest RSI over a given time period T to the maximum range of values the RSI has assumed for this period. It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[
\text{STOCHRSI}_t= \frac{\text{RSI}_t-\text{RSI}_t^L(T)}{\text{RSI}_t^H(T)-\text{RSI}_t^L(T)}
\]</div>
<p>The TA-Lib implementation offers more flexibility than the original “Unsmoothed stochastic RSI” version by Chande and Kroll (1993). To calculate the original indicator, keep the <code class="docutils literal notranslate"><span class="pre">timeperiod</span></code> and <code class="docutils literal notranslate"><span class="pre">fastk_period</span></code> equal.</p>
<p>The return value <code class="docutils literal notranslate"><span class="pre">fastk</span></code> is the unsmoothed RSI. The <code class="docutils literal notranslate"><span class="pre">fastd_period</span></code> is used to compute a smoothed STOCHRSI, which  is returned as <code class="docutils literal notranslate"><span class="pre">fastd</span></code>. If you do not care about STOCHRSI smoothing, just set <code class="docutils literal notranslate"><span class="pre">fastd_period</span></code> to 1 and ignore the <code class="docutils literal notranslate"><span class="pre">fastd</span></code> output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fastk</span><span class="p">,</span> <span class="n">fastd</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">STOCHRSI</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                              <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> 
                              <span class="n">fastk_period</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> 
                              <span class="n">fastd_period</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                              <span class="n">fastd_matype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;fastk&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fastk</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;fastd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fastd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
             <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">secondary_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fastk&#39;</span><span class="p">,</span> <span class="s1">&#39;fastd&#39;</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6243531633b6d2bc619dbb80955da36a34300b7e7caf0de97ffc93e98fc7286b.png" src="../../_images/6243531633b6d2bc619dbb80955da36a34300b7e7caf0de97ffc93e98fc7286b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;STOCHRSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">STOCHRSI</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                                             <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                                                             <span class="n">fastk_period</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                                                             <span class="n">fastd_period</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                             <span class="n">fastd_matype</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="stochastic-stoch">
<h3>Stochastic (STOCH)<a class="headerlink" href="#stochastic-stoch" title="Link to this heading">#</a></h3>
<p>A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time. Stochastic oscillators are based on the idea that closing prices should confirm the trend.</p>
<p>For stochastic (STOCH), there are four different lines: <code class="docutils literal notranslate"><span class="pre">FASTK</span></code>, <code class="docutils literal notranslate"><span class="pre">FASTD</span></code>, <code class="docutils literal notranslate"><span class="pre">SLOWK</span></code> and <code class="docutils literal notranslate"><span class="pre">SLOWD</span></code>. The <code class="docutils literal notranslate"><span class="pre">D</span></code> is the signal line usually drawn over its corresponding <code class="docutils literal notranslate"><span class="pre">K</span></code> function.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
&amp; K^\text{Fast}(T_K) &amp; = &amp;\frac{P_t-P_{T_K}^L}{P_{T_K}^H-P_{T_K}^L}* 100 \\
&amp; D^\text{Fast}(T_{\text{FastD}}) &amp; = &amp; \text{MA}(T_{\text{FastD}})[K^\text{Fast}]\\
&amp; K^\text{Slow}(T_{\text{SlowK}}) &amp; = &amp;\text{MA}(T_{\text{SlowK}})[K^\text{Fast}]\\
&amp; D^\text{Slow}(T_{\text{SlowD}}) &amp; = &amp;\text{MA}(T_{\text{SlowD}})[K^\text{Slow}]
\end{align*}
\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(P_{T_K}^L\)</span>, <span class="math notranslate nohighlight">\(P_{T_K}^H\)</span>, and <span class="math notranslate nohighlight">\(P_{T_K}^L\)</span> are the extreme values among the last <span class="math notranslate nohighlight">\(T_K\)</span> period.
<span class="math notranslate nohighlight">\(K^\text{Slow}\)</span> and <span class="math notranslate nohighlight">\(D^\text{Fast}\)</span> are equivalent when using the same period.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slowk</span><span class="p">,</span> <span class="n">slowd</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">STOCH</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                           <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                           <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                           <span class="n">fastk_period</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                           <span class="n">slowk_period</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                           <span class="n">slowk_matype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                           <span class="n">slowd_period</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                           <span class="n">slowd_matype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;STOCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slowd</span> <span class="o">/</span> <span class="n">slowk</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;STOCH&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                 <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;STOCH&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/159c943a322cf8d679af377f0593ba1c58b12f144f65d28e5eb16bec2adf3bc8.png" src="../../_images/159c943a322cf8d679af377f0593ba1c58b12f144f65d28e5eb16bec2adf3bc8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_stoch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fastk_period</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">slowk_period</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                  <span class="n">slowk_matype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">slowd_period</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">slowd_matype</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">slowk</span><span class="p">,</span> <span class="n">slowd</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">STOCH</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                           <span class="n">fastk_period</span><span class="o">=</span><span class="n">fastk_period</span><span class="p">,</span>
                           <span class="n">slowk_period</span><span class="o">=</span><span class="n">slowk_period</span><span class="p">,</span>
                           <span class="n">slowk_matype</span><span class="o">=</span><span class="n">slowk_matype</span><span class="p">,</span>
                           <span class="n">slowd_period</span><span class="o">=</span><span class="n">slowd_period</span><span class="p">,</span>
                           <span class="n">slowd_matype</span><span class="o">=</span><span class="n">slowd_matype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">slowd</span><span class="o">/</span><span class="n">slowk</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;STOCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_stoch</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">STOCH</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1e5</span><span class="p">,</span> <span class="s1">&#39;STOCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">STOCH</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">STOCH</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                             <span class="n">upper</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">STOCH</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)));</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/56033bf61149e6e69209056f12e90aa00a79e76595ba206bd1f58ebe89096362.png" src="../../_images/56033bf61149e6e69209056f12e90aa00a79e76595ba206bd1f58ebe89096362.png" />
</div>
</div>
</section>
<section id="ultimate-oscillator-ultosc">
<h3>Ultimate Oscillator (ULTOSC)<a class="headerlink" href="#ultimate-oscillator-ultosc" title="Link to this heading">#</a></h3>
<p>The Ultimate Oscillator (ULTOSC), developed by Larry Williams, measures the average difference of the current close to the previous lowest price over three time frames (default: 7, 14, and 28) to avoid overreacting to short-term price changes and incorporat short, medium, and long-term market trends. It first computes the buying pressure, <span class="math notranslate nohighlight">\(\text{BP}_t\)</span>, then sums it over the three periods <span class="math notranslate nohighlight">\(T_1, T_2, T_3\)</span>, normalized by the True Range (<span class="math notranslate nohighlight">\(\text{TR}_t\)</span>.
$<span class="math notranslate nohighlight">\(
\begin{align*}
\text{BP}_t &amp; = P_t^\text{Close}-\min(P_{t-1}^\text{Close}, P_t^\text{Low})\\ 
\text{TR}_t &amp; = \max(P_{t-1}^\text{Close}, P_t^\text{High})-\min(P_{t-1}^\text{Close}, P_t^\text{Low})
\end{align*}
\)</span>$</p>
<p>ULTOSC is then computed as a weighted average over the three periods as follows:
$<span class="math notranslate nohighlight">\(
\begin{align*}
\text{Avg}_t(T) &amp; = \frac{\sum_{i=0}^{T-1} \text{BP}_{t-i}}{\sum_{i=0}^{T-1} \text{TR}_{t-i}}\\
\text{ULTOSC}_t &amp; = 100*\frac{4\text{Avg}_t(7) + 2\text{Avg}_t(14) + \text{Avg}_t(28)}{4+2+1}
\end{align*}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ULTOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ULTOSC</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                            <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                            <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                            <span class="n">timeperiod1</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                            <span class="n">timeperiod2</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                            <span class="n">timeperiod3</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;ULTOSC&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                  <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                  <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;ULTOSC&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d978c9493cd00c7b9968178e376c75f1b3daf95621b6a7e69773932daa3d81e9.png" src="../../_images/d978c9493cd00c7b9968178e376c75f1b3daf95621b6a7e69773932daa3d81e9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_ultosc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">timeperiod1</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">timeperiod2</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">timeperiod3</span><span class="o">=</span><span class="mi">28</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">talib</span><span class="o">.</span><span class="n">ULTOSC</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                        <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                        <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                        <span class="n">timeperiod1</span><span class="o">=</span><span class="n">timeperiod1</span><span class="p">,</span>
                        <span class="n">timeperiod2</span><span class="o">=</span><span class="n">timeperiod2</span><span class="p">,</span>
                        <span class="n">timeperiod3</span><span class="o">=</span><span class="n">timeperiod3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ULTOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_ultosc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ULTOSC</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/97b10ce24f141978c51ab042a1df988233ad888edb5874167d0c91d02d673724.png" src="../../_images/97b10ce24f141978c51ab042a1df988233ad888edb5874167d0c91d02d673724.png" />
</div>
</div>
</section>
<section id="williams-r-willr">
<h3>Williams’ %R (WILLR)<a class="headerlink" href="#williams-r-willr" title="Link to this heading">#</a></h3>
<p>Williams %R, also known as the Williams Percent Range, is a momentum indicator that moves between 0 and -100 and measures overbought and oversold levels to identify entry and exit points. It is similar to the Stochastic oscillator and compares the current closing price <span class="math notranslate nohighlight">\(P_t^\text{Close}\)</span> to the range of highest (<span class="math notranslate nohighlight">\(P_T^\text{High}\)</span>) and lowest (<span class="math notranslate nohighlight">\(P_T^\text{Low}\)</span>) prices over the last T periods (typically 14). The indicators is computed as:</p>
<div class="math notranslate nohighlight">
\[
\text{WILLR}_t = \frac{P_T^\text{High}-P_t^\text{Close}}{P_T^\text{High}-P_T^\text{Low}}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;WILLR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">WILLR</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                          <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                          <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                          <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;WILLR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                 <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;WILLR&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6ce470b7c8576e1e009c00d50902dff140cdfcfb4e492db146ef9c0c8c54f1af.png" src="../../_images/6ce470b7c8576e1e009c00d50902dff140cdfcfb4e492db146ef9c0c8c54f1af.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WILLR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">WILLR</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">WILLR</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/23133ae088e8fbd4fbb7cd9797c14f0cbf54f6ddfcb4b7af93272ee3bf5394e6.png" src="../../_images/23133ae088e8fbd4fbb7cd9797c14f0cbf54f6ddfcb4b7af93272ee3bf5394e6.png" />
</div>
</div>
</section>
</section>
<section id="volume-indicators">
<h2>Volume Indicators<a class="headerlink" href="#volume-indicators" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>AD</p></td>
<td class="text-left"><p>Chaikin A/D Line</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ADOSC</p></td>
<td class="text-left"><p>Chaikin A/D Oscillator</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>OBV</p></td>
<td class="text-left"><p>On Balance Volume</p></td>
</tr>
</tbody>
</table>
</div>
<section id="chaikin-a-d-line">
<h3>Chaikin A/D Line<a class="headerlink" href="#chaikin-a-d-line" title="Link to this heading">#</a></h3>
<p>The Chaikin Advance/Decline or Accumulation/Distribution Line (AD) is a volume-based indicator designed to measure the cumulative flow of money into and out of an asset. The indicator assumes that the degree of buying or selling pressure can be determined by the location of the close, relative to the high and low for the period. There is buying (sellng) pressure when a stock closes in the upper (lower) half of a period’s range. The intention is to signal a change in direction when the indicator diverges from the security price.</p>
<p>The Accumulation/Distribution Line is a running total of each period’s Money Flow Volume. It is calculated as follows:</p>
<ol class="arabic simple">
<li><p>The Money Flow Multiplier (MFI) is the relationship of the close to the high-low range:</p></li>
<li><p>The MFI is multiplied by the period’s volume <span class="math notranslate nohighlight">\(V_t\)</span> to come up with a Money Flow Volume (MFV).</p></li>
<li><p>A running total of the Money Flow Volume forms the Accumulation Distribution Line:
$<span class="math notranslate nohighlight">\(
\begin{align*}
&amp;\text{MFI}_t&amp;=\frac{P_t^\text{Close}-P_t^\text{Low}}{P_t^\text{High}-P_t^\text{Low}}\\
&amp;\text{MFV}_t&amp;=\text{MFI}_t \times V_t\\
&amp;\text{AD}_t&amp;=\text{AD}_{t-1}+\text{MFV}_t
\end{align*}
\)</span>$</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;AD&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                              <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;AD&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f9a3abad00597f82bf93c6076be5a0ab22ecf1177248c9febe5067c317f94e7f.png" src="../../_images/f9a3abad00597f82bf93c6076be5a0ab22ecf1177248c9febe5067c317f94e7f.png" />
</div>
</div>
<p>Divide by average volume to normalize across assets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;AD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">AD</span><span class="o">.</span><span class="n">replace</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    1.255093e+06
mean     3.820196e+01
std      4.457350e+01
min     -1.562873e+02
25%      5.206637e+00
50%      3.226342e+01
75%      6.711474e+01
max      2.413463e+02
Name: AD, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">AD</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">AD</span><span class="o">.</span><span class="n">replace</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">AD</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">AD</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                     <span class="n">upper</span><span class="o">=</span><span class="n">AD</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)));</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b98712b1a469949d96ea897fab9846c3d66d94277eb823f64267971162f6cf5f.png" src="../../_images/b98712b1a469949d96ea897fab9846c3d66d94277eb823f64267971162f6cf5f.png" />
</div>
</div>
</section>
<section id="chaikin-a-d-oscillator-adosc">
<h3>Chaikin A/D Oscillator (ADOSC)<a class="headerlink" href="#chaikin-a-d-oscillator-adosc" title="Link to this heading">#</a></h3>
<p>The Chaikin A/D Oscillator (ADOSC) is the Moving Average Convergence Divergence indicator (MACD) applied to the Chaikin A/D Line. The Chaikin Oscillator intends to predict changes in the Accumulation/Distribution Line.</p>
<p>It is computed as the difference between the 3-day exponential moving average and the 10-day exponential moving average of the Accumulation/Distribution Line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADOSC</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                          <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                          <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                          <span class="n">df</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
                          <span class="n">fastperiod</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                          <span class="n">slowperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;ADOSC&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                 <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;ADOSC&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ea8620817b8086b33abfb611cd8abd11618852927c9cb0cdf7d4787742f05142.png" src="../../_images/ea8620817b8086b33abfb611cd8abd11618852927c9cb0cdf7d4787742f05142.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ADOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADOSC</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                                      <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                                      <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                                      <span class="n">x</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
                                                      <span class="n">fastperiod</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                      <span class="n">slowperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ADOSC</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">ADOSC</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                             <span class="n">upper</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">ADOSC</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ab4ff49722d14881b21a40908c9bd04d2e9f3af6de6e2228d81936960f9ca7c.png" src="../../_images/9ab4ff49722d14881b21a40908c9bd04d2e9f3af6de6e2228d81936960f9ca7c.png" />
</div>
</div>
</section>
<section id="on-balance-volume-obv">
<h3>On Balance Volume (OBV)<a class="headerlink" href="#on-balance-volume-obv" title="Link to this heading">#</a></h3>
<p>The On Balance Volume indicator (OBV) is a cumulative momentum indicator that relates volume to price change. It assumes that OBV changes precede price changes because smart money can be seen flowing into the security by a rising OBV. When the public then moves into the security, both the security and OBV will rise.</p>
<p>The current OBV is computed by adding (subtracting) the current volume to the last OBV if the security closes higher (lower) than the previous close.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\text{OBV}_t = 
\begin{cases}
\text{OBV}_{t-1}+V_t &amp; \text{if }P_t&gt;P_{t-1}\\
\text{OBV}_{t-1}-V_t &amp; \text{if }P_t&lt;P_{t-1}\\
\text{OBV}_{t-1} &amp; \text{otherwise}
\end{cases}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">OBV</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                      <span class="n">df</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;OBV&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                               <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                               <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;OBV&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/186eceba58382ca71605941b51f5e460caa2841585dce0715632b8c56e309797.png" src="../../_images/186eceba58382ca71605941b51f5e460caa2841585dce0715632b8c56e309797.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OBV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">OBV</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                                  <span class="n">x</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.0025</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">OBV</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">OBV</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">),</span>
                               <span class="n">upper</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">OBV</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b26bcc10443403139efd2cfd67d152db7e4c77729e629e2e606dca13545652d3.png" src="../../_images/b26bcc10443403139efd2cfd67d152db7e4c77729e629e2e606dca13545652d3.png" />
</div>
</div>
</section>
</section>
<section id="volatility-indicators">
<h2>Volatility Indicators<a class="headerlink" href="#volatility-indicators" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>TRANGE</p></td>
<td class="text-left"><p>True Range</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ATR</p></td>
<td class="text-left"><p>Average True Range</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>NATR</p></td>
<td class="text-left"><p>Normalized Average True Range</p></td>
</tr>
</tbody>
</table>
</div>
<section id="atr">
<h3>ATR<a class="headerlink" href="#atr" title="Link to this heading">#</a></h3>
<p>The Average True Range indicator (ATR) shows volatility of the market. It was introduced by Welles Wilder (1978)  and has been used as a component of numerous other indicators since. It aims to anticipate changes in trend such that the higher its value, the higher the probability of a trend change; the lower the indicator’s value, the weaker the current trend.</p>
<p>It is computed as the simple moving average for a period T of the True Range (TRANGE), which measures volatility as the absolute value of the largest recent trading range:
$<span class="math notranslate nohighlight">\(
\text{TRANGE}_t = \max\left[P_t^\text{High} - P_t^\text{low}, \left| P_t^\text{High} - P_{t-1}^\text{Close}\right|, \left| P_t^\text{low} - P_{t-1}^\text{Close}\right|\right]
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                      <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                      <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                      <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;ATR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                          <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;ATR&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0dd877f4cc8291136771d82f38b514825e2a9d30742fb5a286fca8b045b6fb29.png" src="../../_images/0dd877f4cc8291136771d82f38b514825e2a9d30742fb5a286fca8b045b6fb29.png" />
</div>
</div>
<section id="compute-normalized-version-of-atr-using-rolling-mean-of-price">
<h4>Compute normalized version of ATR using rolling mean of price<a class="headerlink" href="#compute-normalized-version-of-atr-using-rolling-mean-of-price" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">talib</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                                  <span class="n">x</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                                                  <span class="n">x</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                                                  <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ATR</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">ATR</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a96e072ee45fdda1337d214fc68e4ddaad3ba69f97f1f8fe65ab0495cb54e5f3.png" src="../../_images/a96e072ee45fdda1337d214fc68e4ddaad3ba69f97f1f8fe65ab0495cb54e5f3.png" />
</div>
</div>
</section>
</section>
<section id="natr">
<h3>NATR<a class="headerlink" href="#natr" title="Link to this heading">#</a></h3>
<p>The Normalized Average True Range (NATR) is a normalized version of the ATR computed as follows:</p>
<div class="math notranslate nohighlight">
\[
\text{NATR}_t = \frac{\text{ATR}_t(T)}{P_t^\text{Close}} * 100
\]</div>
<p>Normalization make the ATR function more relevant in the folllowing scenarios:</p>
<ul class="simple">
<li><p>Long term analysis where the price changes drastically.</p></li>
<li><p>Cross-market or cross-security ATR comparison.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">price_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">NATR</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                        <span class="n">df</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
                        <span class="n">df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span>
                        <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;NATR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                           <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                           <span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;NATR&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3e8c02684033414713b1ee0ae1d82a4dcb1840ffd307d82640ef1ffdc4a5718d.png" src="../../_images/3e8c02684033414713b1ee0ae1d82a4dcb1840ffd307d82640ef1ffdc4a5718d.png" />
</div>
</div>
<p>Not included in data due to high correlation with ATR.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data[&#39;NATR&#39;] = by_ticker.apply(lambda x: talib.NATR(x.high,</span>
<span class="c1">#                                                     x.low,</span>
<span class="c1">#                                                     x.close,</span>
<span class="c1">#                                                     timeperiod=14))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># q = 0.001</span>
<span class="c1"># sns.distplot(data.NATR.clip(upper=data.NATR.quantile(1-q)));</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="rolling-factor-betas">
<h2>Rolling Factor Betas<a class="headerlink" href="#rolling-factor-betas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;F-F_Research_Data_5_Factors_2x3_daily&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> 
                              <span class="n">start</span><span class="o">=</span><span class="mi">2005</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">:</span> <span class="s1">&#39;MARKET&#39;</span><span class="p">}))</span>
<span class="n">factor_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factors</span> <span class="o">=</span> <span class="n">factor_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">factors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;MARKET&#39;, &#39;SMB&#39;, &#39;HML&#39;, &#39;RMW&#39;, &#39;CMA&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ret</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ret_</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">02</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">windows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">252</span><span class="p">]</span>
<span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">betas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">model_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">ret</span><span class="p">]]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">factor_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">model_data</span><span class="p">[</span><span class="n">ret</span><span class="p">]</span> <span class="o">-=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">RF</span>

        <span class="n">rolling_ols</span> <span class="o">=</span> <span class="n">RollingOLS</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">model_data</span><span class="p">[</span><span class="n">ret</span><span class="p">],</span> 
                                 <span class="n">exog</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">model_data</span><span class="p">[</span><span class="n">factors</span><span class="p">]),</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>
        <span class="n">factor_model</span> <span class="o">=</span> <span class="n">rolling_ols</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">params_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;const&#39;</span><span class="p">:</span><span class="s1">&#39;ALPHA&#39;</span><span class="p">})</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">factor_model</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ticker</span><span class="o">=</span><span class="n">ticker</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span>
        <span class="n">betas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">betas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">window</span><span class="si">:</span><span class="s1">02</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21
63
252
</pre></div>
</div>
</div>
</div>
</section>
<section id="size-proxy">
<h2>Size proxy<a class="headerlink" href="#size-proxy" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;size_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_ticker</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;size_proxy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">marketcap</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size_factor</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="persist-results">
<h2>Persist results<a class="headerlink" href="#persist-results" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
        <span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;marketcap&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">null_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
MultiIndex: 1255093 entries, (&#39;A&#39;, Timestamp(&#39;2007-01-04 00:00:00&#39;)) to (&#39;ZION&#39;, Timestamp(&#39;2016-12-29 00:00:00&#39;))
Data columns (total 57 columns):
 #   Column       Non-Null Count    Dtype  
---  ------       --------------    -----  
 0   sector       1255093 non-null  float64
 1   ret_01       1254593 non-null  float64
 2   ret_02       1254093 non-null  float64
 3   ret_03       1253593 non-null  float64
 4   ret_04       1253093 non-null  float64
 5   ret_05       1252593 non-null  float64
 6   ret_10       1250093 non-null  float64
 7   ret_21       1244593 non-null  float64
 8   ret_42       1234093 non-null  float64
 9   ret_63       1223593 non-null  float64
 10  ret_126      1192093 non-null  float64
 11  ret_252      1129093 non-null  float64
 12  ret_fwd      1255093 non-null  float64
 13  BB_UP        1245593 non-null  float64
 14  BB_LOW       1245593 non-null  float64
 15  BB_SQUEEZE   1245593 non-null  float64
 16  HT           1223593 non-null  float64
 17  SAR          1254593 non-null  float64
 18  ADX          1241593 non-null  float64
 19  ADXR         1235093 non-null  float64
 20  PPO          1242593 non-null  float64
 21  AARONOSC     1248093 non-null  float64
 22  BOP          1255093 non-null  float64
 23  CCI          1248593 non-null  float64
 24  MACD         1238593 non-null  float64
 25  MACD_SIGNAL  1238593 non-null  float64
 26  MACD_HIST    1238593 non-null  float64
 27  MFI          1248093 non-null  float64
 28  RSI          1248093 non-null  float64
 29  STOCHRSI     1240593 non-null  float64
 30  STOCH        1246586 non-null  float64
 31  ULTOSC       1241093 non-null  float64
 32  WILLR        1248593 non-null  float64
 33  AD           1255093 non-null  float64
 34  ADOSC        1248577 non-null  float64
 35  OBV          1255093 non-null  float64
 36  ATR          1248093 non-null  float64
 37  ALPHA_21     1244593 non-null  float64
 38  MARKET_21    1244593 non-null  float64
 39  SMB_21       1244593 non-null  float64
 40  HML_21       1244593 non-null  float64
 41  RMW_21       1244593 non-null  float64
 42  CMA_21       1244593 non-null  float64
 43  ALPHA_63     1223593 non-null  float64
 44  MARKET_63    1223593 non-null  float64
 45  SMB_63       1223593 non-null  float64
 46  HML_63       1223593 non-null  float64
 47  RMW_63       1223593 non-null  float64
 48  CMA_63       1223593 non-null  float64
 49  ALPHA_252    1129093 non-null  float64
 50  MARKET_252   1129093 non-null  float64
 51  SMB_252      1129093 non-null  float64
 52  HML_252      1129093 non-null  float64
 53  RMW_252      1129093 non-null  float64
 54  CMA_252      1129093 non-null  float64
 55  size_factor  1255093 non-null  float64
 56  size_proxy   1252855 non-null  float64
dtypes: float64(57)
memory usage: 551.4+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">store</span><span class="p">:</span>
    <span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;factors/common&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./0alphas-using qstrader有3sources/计算ipynb_case"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ta-lib-function-groups">TA-Lib: Function Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unstable-periods">Unstable periods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-averages">Moving Averages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-moving-average-sma">Simple Moving Average (SMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-moving-average-ema">Exponential Moving Average (EMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-moving-average-wma">Weighted Moving Average (WMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-exponential-moving-average-dema">Double Exponential Moving Average (DEMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triple-exponential-moving-average-tema">Triple Exponential Moving Average (TEMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triangular-moving-average-trima">Triangular Moving Average (TRIMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kaufman-adaptive-moving-average-kama">Kaufman Adaptive Moving Average (KAMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesa-adaptive-moving-average-mama">MESA Adaptive Moving Average (MAMA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison">Comparison</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-studies">Overlap Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bollinger-bands">Bollinger Bands</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalized-squeeze-mean-reversion-indicators">Normalized squeeze &amp; mean reversion indicators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-distribution">Visualize Distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-outlier-price-series">Plot outlier price series</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hilbert-transform-instantaneous-trendline">Hilbert Transform - Instantaneous Trendline</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-hilbert-based-normalized-indicator">Compute Hilbert-based normalized indicator</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parabolic-sar">Parabolic SAR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalized-sar-indicator">Normalized SAR indicator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#momentum-indicators">Momentum Indicators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#average-directional-movement-index-adx">Average Directional Movement Index (ADX)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plus-minus-directional-movement-plus-dm-minus-dm">Plus/Minus Directional Movement (PLUS_DM/MINUS_DM)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plus-minus-directional-index-plus-di-minus-di">Plus/Minus Directional Index (PLUS_DI/MINUS_DI)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Average directional movement index (ADX)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Visualize distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#average-directional-movement-index-rating">Average Directional Movement Index Rating</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absolute-price-oscillator-apo">Absolute Price Oscillator (APO)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#percentage-price-oscillator-ppo">Percentage Price Oscillator (PPO)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aroon-oscillator">Aroon Oscillator</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aroon-up-down-indicator">Aroon Up/Down Indicator</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Aroon Oscillator</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balance-of-power-bop">Balance Of Power (BOP)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#commodity-channel-index-cci">Commodity Channel Index (CCI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-average-convergence-divergence-macd">Moving Average Convergence/Divergence (MACD)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chande-momentum-oscillator-cmo">Chande Momentum Oscillator (CMO)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#money-flow-index">Money Flow Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-strength-index">Relative Strength Index</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-rsi-stochrsi">Stochastic RSI (STOCHRSI)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-stoch">Stochastic (STOCH)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ultimate-oscillator-ultosc">Ultimate Oscillator (ULTOSC)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#williams-r-willr">Williams’ %R (WILLR)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#volume-indicators">Volume Indicators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaikin-a-d-line">Chaikin A/D Line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaikin-a-d-oscillator-adosc">Chaikin A/D Oscillator (ADOSC)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#on-balance-volume-obv">On Balance Volume (OBV)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#volatility-indicators">Volatility Indicators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atr">ATR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-normalized-version-of-atr-using-rolling-mean-of-price">Compute normalized version of ATR using rolling mean of price</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#natr">NATR</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-factor-betas">Rolling Factor Betas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#size-proxy">Size proxy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#persist-results">Persist results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tom Tang
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>